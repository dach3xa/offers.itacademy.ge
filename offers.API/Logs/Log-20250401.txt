2025-04-01 14:15:10.265 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:15:10.428 +04:00 INF starting web host
2025-04-01 14:15:10.861 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:15:12.263 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:15:12.264 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:15:12.400 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:15:12.658 +04:00 DBG Creating DbConnection.
2025-04-01 14:15:12.754 +04:00 DBG Created DbConnection. (90ms).
2025-04-01 14:15:12.756 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:12.769 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.350 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.358 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:15:13.366 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-04-01 14:15:13.369 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-04-01 14:15:13.376 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:15:13.405 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:15:13.407 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.415 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 14:15:13.416 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.419 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.421 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:15:13.423 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:15:13.423 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:15:13.423 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:15:13.424 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:15:13.455 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:15:13.524 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:15:13.530 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:15:13.531 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:15:13.531 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:15:13.533 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-04-01 14:15:13.533 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:15:13.537 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:15:13.539 +04:00 DBG Committing transaction.
2025-04-01 14:15:13.541 +04:00 DBG Committed transaction.
2025-04-01 14:15:13.543 +04:00 DBG Disposing transaction.
2025-04-01 14:15:13.545 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:15:13.545 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:15:13.546 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:15:13.546 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:15:13.547 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:15:13.547 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:15:13.548 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:15:13.549 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:15:13.549 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:15:13.551 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-04-01 14:15:13.551 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:15:13.553 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:15:13.555 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:15:13.555 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:15:13.555 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:15:13.556 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:15:13.568 +04:00 INF Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:15:13.570 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.572 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:15:13.576 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:15:13.577 +04:00 DBG Committing transaction.
2025-04-01 14:15:13.578 +04:00 DBG Committed transaction.
2025-04-01 14:15:13.578 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:15:13.578 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:15:13.578 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:15:13.578 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:15:13.583 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:15:13.583 +04:00 DBG Disposing transaction.
2025-04-01 14:15:13.583 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.584 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:15:13.667 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:15:13.919 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:15:13.964 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.965 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.965 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:15:13.966 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:15:13.966 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:15:13.966 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:15:13.976 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:15:13.978 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.979 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:15:13.979 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.979 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:15:13.980 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:15:13.983 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:13.984 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 14:15:13.988 +04:00 DBG Hosting starting
2025-04-01 14:15:14.027 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:15:14.046 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:15:14.073 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:15:14.085 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:15:14.091 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:15:14.092 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:15:14.094 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:15:14.096 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:15:14.098 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:15:14.103 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:15:14.105 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:15:14.132 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:15:14.146 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:15:14.207 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:15:14.226 +04:00 DBG Creating DbConnection.
2025-04-01 14:15:14.227 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:15:14.229 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:14.231 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:14.233 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:15:14.234 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:15:14.234 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-04-01 14:15:14.235 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:15:14.259 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:15:14.274 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:14.275 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 15ms reading results.
2025-04-01 14:15:14.277 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:14.278 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:15:14.290 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:15:14.290 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:15:14.291 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:15:14.414 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 14:15:14.414 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 14:15:14.414 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 14:15:14.414 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 14:15:14.529 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger - null null
2025-04-01 14:15:14.698 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 14:15:14.699 +04:00 INF Hosting environment: Development
2025-04-01 14:15:14.699 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 14:15:14.699 +04:00 DBG Hosting started
2025-04-01 14:15:15.324 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 14:15:15.355 +04:00 DBG No candidates found for the request path '/swagger'
2025-04-01 14:15:15.356 +04:00 DBG Request did not match any endpoints
2025-04-01 14:15:15.409 +04:00 DBG Connection ID "18230571301796315137" disconnecting.
2025-04-01 14:15:15.410 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 14:15:15.421 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 14:15:15.421 +04:00 DBG Request did not match any endpoints
2025-04-01 14:15:15.434 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger - 301 null null 920.3597ms
2025-04-01 14:15:15.508 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 14:15:15.510 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 14:15:15.551 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 14:15:15.551 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 14:15:15.552 +04:00 DBG Connection ID "18014398511092596737" disconnecting.
2025-04-01 14:15:15.553 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 143.2726ms
2025-04-01 14:15:15.594 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 14:15:15.602 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 14:15:15.608 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 4.2282ms
2025-04-01 14:15:15.759 +04:00 DBG Connection ID "17942340917054668801" disconnecting.
2025-04-01 14:15:15.762 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 168.2754ms
2025-04-01 14:15:15.996 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 14:15:15.997 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 14:15:15.997 +04:00 DBG Request did not match any endpoints
2025-04-01 14:15:16.034 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 37.16ms
2025-04-01 14:16:57.999 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 14:16:58.075 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 14:16:58.079 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 14:16:58.081 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:16:58.087 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 14:16:58.207 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 14:16:58.209 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:16:58.242 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 14:16:58.243 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 14:16:58.244 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 14:16:58.244 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 14:16:58.244 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 14:16:58.245 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 14:16:58.248 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:16:58.312 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:16:58.313 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:16:58.323 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:16:58.326 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 14:16:58.329 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 14:16:58.357 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 14:16:58.357 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:16:58.357 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:16:58.358 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:16:58.369 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:16:58.370 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:16:58.371 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:16:58.371 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:16:58.371 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:17:05.625 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 14:18:07.650 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 14:18:07.684 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 14:18:07.699 +04:00 DBG Creating DbConnection.
2025-04-01 14:18:07.700 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:18:07.700 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:18:07.700 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:18:07.700 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:18:07.700 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:18:07.704 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (4ms).
2025-04-01 14:18:07.707 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:18:07.768 +04:00 INF Executed DbCommand (63ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:18:07.814 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 14:18:07.837 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:18:07.838 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 69ms reading results.
2025-04-01 14:18:07.838 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:18:07.838 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:18:39.248 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 100992.0951ms
2025-04-01 14:18:39.250 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:18:39.254 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 14:20:08.862 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:20:08.971 +04:00 INF starting web host
2025-04-01 14:20:09.122 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:20:10.286 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:20:10.287 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:20:10.395 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:20:10.589 +04:00 DBG Creating DbConnection.
2025-04-01 14:20:10.656 +04:00 DBG Created DbConnection. (65ms).
2025-04-01 14:20:10.658 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:10.674 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.103 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.107 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:20:11.114 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 14:20:11.115 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-04-01 14:20:11.121 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:20:11.152 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:20:11.154 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.163 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 14:20:11.163 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.164 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.165 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:20:11.168 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:20:11.168 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:20:11.168 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:20:11.169 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:20:11.186 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:20:11.254 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:20:11.259 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:20:11.262 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:20:11.262 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:20:11.264 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-04-01 14:20:11.264 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:20:11.268 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:20:11.270 +04:00 DBG Committing transaction.
2025-04-01 14:20:11.273 +04:00 DBG Committed transaction.
2025-04-01 14:20:11.275 +04:00 DBG Disposing transaction.
2025-04-01 14:20:11.278 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:20:11.279 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:20:11.282 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:20:11.282 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:20:11.282 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:20:11.282 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:20:11.283 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:20:11.283 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:20:11.284 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:20:11.284 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:20:11.284 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:20:11.285 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:20:11.287 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:20:11.287 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:20:11.287 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:20:11.288 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:20:11.291 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:20:11.296 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.298 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 14:20:11.309 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:20:11.310 +04:00 DBG Committing transaction.
2025-04-01 14:20:11.310 +04:00 DBG Committed transaction.
2025-04-01 14:20:11.311 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:20:11.311 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:20:11.311 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:20:11.311 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:20:11.316 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:20:11.316 +04:00 DBG Disposing transaction.
2025-04-01 14:20:11.316 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.317 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:20:11.375 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:20:11.616 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:20:11.659 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.660 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.660 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:20:11.661 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:20:11.661 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:20:11.661 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:20:11.666 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:20:11.668 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.669 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:20:11.669 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.669 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:20:11.671 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:20:11.673 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.674 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 14:20:11.682 +04:00 DBG Hosting starting
2025-04-01 14:20:11.702 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:20:11.719 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:20:11.734 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:20:11.750 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:20:11.753 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:20:11.754 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:20:11.756 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:20:11.757 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:20:11.759 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:20:11.761 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:20:11.762 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:20:11.784 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:20:11.798 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:20:11.852 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:20:11.871 +04:00 DBG Creating DbConnection.
2025-04-01 14:20:11.871 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:20:11.873 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.875 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.876 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:20:11.876 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:20:11.876 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:20:11.876 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:20:11.900 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:20:11.912 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.913 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-04-01 14:20:11.915 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.916 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:20:11.923 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:20:11.923 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:11.923 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:20:12.004 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 14:20:12.004 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 14:20:12.004 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 14:20:12.004 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 14:20:12.056 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 14:20:12.215 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 14:20:12.229 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 14:20:12.229 +04:00 INF Hosting environment: Development
2025-04-01 14:20:12.229 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 14:20:12.229 +04:00 DBG Hosting started
2025-04-01 14:20:12.255 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 14:20:12.256 +04:00 DBG Request did not match any endpoints
2025-04-01 14:20:12.358 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 14:20:12.361 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 14:20:12.435 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 14:20:12.444 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 14:20:12.452 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 407.6637ms
2025-04-01 14:20:12.491 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 14:20:12.498 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 14:20:12.504 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 11.8088ms
2025-04-01 14:20:12.588 +04:00 DBG Connection ID "18086456109425491969" disconnecting.
2025-04-01 14:20:12.588 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 90.0472ms
2025-04-01 14:20:12.657 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 14:20:12.657 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 14:20:12.658 +04:00 DBG Request did not match any endpoints
2025-04-01 14:20:12.698 +04:00 DBG Connection ID "18014398519682531333" disconnecting.
2025-04-01 14:20:12.698 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 41.6579ms
2025-04-01 14:20:37.793 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 14:20:37.833 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 14:20:37.838 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 14:20:37.839 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:20:37.844 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 14:20:37.928 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 14:20:37.932 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:20:37.957 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 14:20:37.958 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 14:20:37.959 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 14:20:37.959 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 14:20:37.960 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 14:20:37.961 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 14:20:37.963 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:20:38.019 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:20:38.021 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:20:38.025 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:20:38.031 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 14:20:38.033 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 14:20:38.058 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 14:20:38.059 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:20:38.059 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:20:38.060 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:20:38.071 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:20:38.072 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:20:38.073 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:20:38.073 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:20:38.073 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:20:38.077 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 14:20:38.084 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 14:20:38.100 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 14:20:38.113 +04:00 DBG Creating DbConnection.
2025-04-01 14:20:38.113 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:20:38.114 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:38.114 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:38.115 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:20:38.115 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:20:38.120 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-04-01 14:20:38.125 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:20:38.159 +04:00 INF Executed DbCommand (38ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:20:38.209 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 14:20:38.237 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:38.238 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 78ms reading results.
2025-04-01 14:20:38.238 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:20:38.238 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:21:13.861 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 35894.2702ms
2025-04-01 14:21:13.863 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:21:13.866 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 14:21:18.197 +04:00 DBG Connection ID "18086456109425491971" disconnecting.
2025-04-01 14:21:20.945 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:21:20.945 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:21:20.946 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:21:21.847 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null null 44051.9346ms
2025-04-01 14:27:55.814 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:27:55.934 +04:00 INF starting web host
2025-04-01 14:27:56.082 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:27:56.823 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:27:56.824 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:27:57.009 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:27:57.187 +04:00 DBG Creating DbConnection.
2025-04-01 14:27:57.226 +04:00 DBG Created DbConnection. (36ms).
2025-04-01 14:27:57.230 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.241 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.509 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.515 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:27:57.521 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 14:27:57.523 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 14:27:57.529 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:27:57.558 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:27:57.565 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.573 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (8ms).
2025-04-01 14:27:57.573 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.574 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.575 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:27:57.580 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:27:57.580 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:27:57.580 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:27:57.581 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:27:57.602 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:27:57.691 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:27:57.701 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:27:57.703 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:27:57.703 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:27:57.705 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 14:27:57.705 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:27:57.714 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:27:57.716 +04:00 DBG Committing transaction.
2025-04-01 14:27:57.719 +04:00 DBG Committed transaction.
2025-04-01 14:27:57.721 +04:00 DBG Disposing transaction.
2025-04-01 14:27:57.724 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:27:57.725 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:27:57.727 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:27:57.727 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:27:57.727 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:27:57.727 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:27:57.728 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:27:57.729 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:27:57.729 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:27:57.729 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:27:57.729 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:27:57.730 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:27:57.733 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:27:57.733 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:27:57.733 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:27:57.734 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:27:57.738 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:27:57.741 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.742 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:27:57.748 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:27:57.749 +04:00 DBG Committing transaction.
2025-04-01 14:27:57.749 +04:00 DBG Committed transaction.
2025-04-01 14:27:57.749 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:27:57.750 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:27:57.750 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:27:57.750 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:27:57.753 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:27:57.754 +04:00 DBG Disposing transaction.
2025-04-01 14:27:57.754 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:57.754 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:27:57.847 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:27:58.129 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:27:58.164 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.164 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.164 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:27:58.165 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:27:58.165 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:27:58.165 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:27:58.168 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:27:58.170 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.170 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:27:58.171 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.171 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:27:58.172 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:27:58.174 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.175 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:27:58.185 +04:00 DBG Hosting starting
2025-04-01 14:27:58.215 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:27:58.252 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:27:58.268 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:27:58.283 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:27:58.290 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:27:58.291 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:27:58.294 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:27:58.298 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:27:58.300 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:27:58.303 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:27:58.304 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:27:58.346 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:27:58.361 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:27:58.424 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:27:58.452 +04:00 DBG Creating DbConnection.
2025-04-01 14:27:58.452 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:27:58.455 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.458 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.459 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:27:58.459 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:27:58.459 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:27:58.460 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:27:58.487 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:27:58.503 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.504 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-04-01 14:27:58.515 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.516 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:27:58.517 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:27:58.517 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:27:58.517 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:27:58.595 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 14:27:58.595 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 14:27:58.595 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 14:27:58.595 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 14:27:58.655 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 14:27:58.806 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 14:27:58.832 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 14:27:58.832 +04:00 INF Hosting environment: Development
2025-04-01 14:27:58.832 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 14:27:58.832 +04:00 DBG Hosting started
2025-04-01 14:27:58.849 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 14:27:58.850 +04:00 DBG Request did not match any endpoints
2025-04-01 14:27:58.956 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 14:27:58.958 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 14:27:59.032 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 14:27:59.032 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 14:27:59.066 +04:00 DBG Connection ID "18014398511092596741" disconnecting.
2025-04-01 14:27:59.071 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 14:27:59.071 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 435.5709ms
2025-04-01 14:27:59.079 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.4381ms
2025-04-01 14:27:59.085 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 14:27:59.188 +04:00 DBG Connection ID "18374686494167138310" disconnecting.
2025-04-01 14:27:59.189 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 103.7859ms
2025-04-01 14:27:59.271 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 14:27:59.271 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 14:27:59.271 +04:00 DBG Request did not match any endpoints
2025-04-01 14:27:59.316 +04:00 DBG Connection ID "18158513703463419913" disconnecting.
2025-04-01 14:27:59.316 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 45.395ms
2025-04-01 14:29:02.444 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 14:29:02.478 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 14:29:02.484 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 14:29:02.500 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:29:02.503 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 14:29:02.619 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 14:29:02.620 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:29:02.670 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 14:29:02.673 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 14:29:02.673 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 14:29:02.675 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 14:29:02.676 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 14:29:02.676 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 14:29:02.679 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:29:02.790 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:29:02.794 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:29:02.805 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:29:02.814 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 14:29:02.817 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 14:29:02.864 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 14:29:02.865 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:29:02.865 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:29:02.866 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:29:02.882 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:29:02.885 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:29:02.886 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:29:02.887 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:29:02.888 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:29:02.894 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 14:29:02.909 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 14:29:02.935 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 14:29:02.950 +04:00 DBG Creating DbConnection.
2025-04-01 14:29:02.951 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:29:02.951 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:29:02.951 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:29:02.951 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:29:02.951 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:29:02.955 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (4ms).
2025-04-01 14:29:02.962 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:29:03.006 +04:00 INF Executed DbCommand (50ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:29:03.083 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 14:29:03.120 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:29:03.120 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 113ms reading results.
2025-04-01 14:29:03.120 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:29:03.121 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:30:40.623 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 97937.926ms
2025-04-01 14:30:40.625 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:30:40.629 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 14:30:49.768 +04:00 DBG Connection ID "18302628900129210372" disconnecting.
2025-04-01 14:30:54.734 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:30:54.734 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:30:54.735 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:30:55.618 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null null 113168.1857ms
2025-04-01 14:35:33.125 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:35:33.300 +04:00 INF starting web host
2025-04-01 14:35:33.475 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:35:34.724 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:35:34.725 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:35:34.832 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:35:35.005 +04:00 DBG Creating DbConnection.
2025-04-01 14:35:35.071 +04:00 DBG Created DbConnection. (62ms).
2025-04-01 14:35:35.073 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.086 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.364 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.371 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:35:35.383 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-04-01 14:35:35.385 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-04-01 14:35:35.392 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:35:35.430 +04:00 INF Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:35:35.433 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.451 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (7ms).
2025-04-01 14:35:35.452 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.453 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.455 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:35:35.460 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:35:35.461 +04:00 DBG Created DbCommand for 'ExecuteScalar' (1ms).
2025-04-01 14:35:35.462 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-04-01 14:35:35.463 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:35:35.491 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:35:35.564 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:35:35.570 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:35:35.571 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:35:35.571 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:35:35.572 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 14:35:35.572 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:35:35.581 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:35:35.583 +04:00 DBG Committing transaction.
2025-04-01 14:35:35.586 +04:00 DBG Committed transaction.
2025-04-01 14:35:35.588 +04:00 DBG Disposing transaction.
2025-04-01 14:35:35.589 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:35:35.590 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:35:35.591 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:35:35.591 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:35:35.591 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:35:35.592 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:35:35.592 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:35:35.593 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:35:35.594 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:35:35.594 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:35:35.595 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:35:35.596 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:35:35.599 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:35:35.599 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:35:35.599 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:35:35.600 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:35:35.603 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:35:35.608 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.610 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 14:35:35.616 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:35:35.616 +04:00 DBG Committing transaction.
2025-04-01 14:35:35.617 +04:00 DBG Committed transaction.
2025-04-01 14:35:35.617 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:35:35.617 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:35:35.617 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:35:35.617 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:35:35.621 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:35:35.622 +04:00 DBG Disposing transaction.
2025-04-01 14:35:35.622 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:35.622 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:35:35.731 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:35:36.034 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:35:36.075 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.075 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.075 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:35:36.075 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:35:36.075 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:35:36.075 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:35:36.079 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:35:36.082 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.082 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:35:36.082 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.082 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:35:36.083 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:35:36.085 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.087 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 14:35:36.091 +04:00 DBG Hosting starting
2025-04-01 14:35:36.128 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:35:36.143 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:35:36.150 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:35:36.158 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:35:36.164 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:35:36.164 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:35:36.166 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:35:36.168 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:35:36.169 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:35:36.170 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:35:36.171 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:35:36.202 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:35:36.218 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:35:36.329 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:35:36.350 +04:00 DBG Creating DbConnection.
2025-04-01 14:35:36.351 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:35:36.353 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.356 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.357 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:35:36.357 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:35:36.357 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:35:36.357 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:35:36.383 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:35:36.397 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.398 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-04-01 14:35:36.400 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.401 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:35:36.401 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:35:36.402 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:35:36.402 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:35:36.490 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 14:35:36.490 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 14:35:36.490 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 14:35:36.490 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 14:35:36.564 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 14:35:36.706 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 14:35:36.730 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 14:35:36.730 +04:00 INF Hosting environment: Development
2025-04-01 14:35:36.730 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 14:35:36.730 +04:00 DBG Hosting started
2025-04-01 14:35:36.744 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 14:35:36.745 +04:00 DBG Request did not match any endpoints
2025-04-01 14:35:36.874 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 14:35:36.877 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 14:35:36.951 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 14:35:36.952 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 14:35:37.007 +04:00 DBG Connection ID "18230571301796315141" disconnecting.
2025-04-01 14:35:37.016 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 14:35:37.023 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 473.3922ms
2025-04-01 14:35:37.031 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 14:35:37.040 +04:00 DBG Connection ID "17942340917054668806" disconnecting.
2025-04-01 14:35:37.040 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 6.626ms
2025-04-01 14:35:37.163 +04:00 DBG Connection ID "18014398515387564037" disconnecting.
2025-04-01 14:35:37.167 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 150.7169ms
2025-04-01 14:35:37.253 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 14:35:37.254 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 14:35:37.254 +04:00 DBG Request did not match any endpoints
2025-04-01 14:35:37.296 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.9987ms
2025-04-01 14:35:37.296 +04:00 DBG Connection ID "17942340917054668808" disconnecting.
2025-04-01 14:36:05.229 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 14:36:05.261 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 14:36:05.267 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 14:36:05.268 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:36:05.272 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 14:36:05.348 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 14:36:05.351 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:36:05.378 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 14:36:05.381 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 14:36:05.382 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 14:36:05.382 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 14:36:05.383 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 14:36:05.383 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 14:36:05.385 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:36:05.456 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:36:05.459 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:36:05.466 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:36:05.469 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 14:36:05.472 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 14:36:05.516 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 14:36:05.517 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:36:05.517 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:36:05.517 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:36:05.527 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:36:05.530 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:36:05.532 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:36:05.532 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:36:05.533 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:36:05.537 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 14:36:05.543 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 14:36:05.555 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 14:36:05.566 +04:00 DBG Creating DbConnection.
2025-04-01 14:36:05.566 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:36:05.567 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:36:05.567 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:36:05.567 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:36:05.567 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:36:05.571 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (3ms).
2025-04-01 14:36:05.573 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:36:05.601 +04:00 INF Executed DbCommand (30ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:36:05.642 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 14:36:05.664 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:36:05.664 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 63ms reading results.
2025-04-01 14:36:05.665 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:36:05.665 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:36:11.614 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 6228.2144ms
2025-04-01 14:36:11.615 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:36:11.619 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 14:36:17.171 +04:00 DBG Connection ID "18230571301796315146" disconnecting.
2025-04-01 14:36:18.821 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:36:18.821 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:36:18.821 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:36:19.471 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null null 14242.391ms
2025-04-01 14:38:07.359 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:38:07.544 +04:00 INF starting web host
2025-04-01 14:38:07.699 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:38:08.622 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:38:08.623 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:38:08.711 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:38:08.874 +04:00 DBG Creating DbConnection.
2025-04-01 14:38:08.919 +04:00 DBG Created DbConnection. (42ms).
2025-04-01 14:38:08.922 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:08.933 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.233 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.241 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:38:09.246 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-04-01 14:38:09.248 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (11ms).
2025-04-01 14:38:09.255 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:38:09.278 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:38:09.280 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.290 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 14:38:09.290 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.291 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.292 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:38:09.295 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:38:09.295 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:38:09.295 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:38:09.296 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:38:09.316 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:38:09.383 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:38:09.391 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:38:09.392 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:38:09.392 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:38:09.393 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 14:38:09.394 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:38:09.395 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:38:09.397 +04:00 DBG Committing transaction.
2025-04-01 14:38:09.400 +04:00 DBG Committed transaction.
2025-04-01 14:38:09.402 +04:00 DBG Disposing transaction.
2025-04-01 14:38:09.404 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:38:09.405 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:38:09.407 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:38:09.407 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:38:09.407 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:38:09.407 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:38:09.408 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:38:09.408 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:38:09.409 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:38:09.409 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:38:09.409 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:38:09.410 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:38:09.412 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:38:09.413 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:38:09.413 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:38:09.413 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:38:09.417 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:38:09.422 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.425 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-04-01 14:38:09.431 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:38:09.432 +04:00 DBG Committing transaction.
2025-04-01 14:38:09.432 +04:00 DBG Committed transaction.
2025-04-01 14:38:09.432 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:38:09.433 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:38:09.433 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:38:09.433 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:38:09.434 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:38:09.435 +04:00 DBG Disposing transaction.
2025-04-01 14:38:09.435 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.435 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:38:09.495 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:38:09.734 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:38:09.783 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.783 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.783 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:38:09.783 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:38:09.784 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:38:09.784 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:38:09.789 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:38:09.792 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.792 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:38:09.792 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.792 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:38:09.794 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:38:09.797 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:09.798 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 14:38:09.804 +04:00 DBG Hosting starting
2025-04-01 14:38:09.829 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:38:09.856 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:38:09.865 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:38:09.882 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:38:09.886 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:38:09.887 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:38:09.890 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:38:09.891 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:38:09.893 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:38:09.894 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:38:09.895 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:38:09.918 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:38:09.933 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:38:09.992 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:38:10.008 +04:00 DBG Creating DbConnection.
2025-04-01 14:38:10.009 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:38:10.010 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:10.012 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:10.013 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:38:10.013 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:38:10.013 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:38:10.014 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:38:10.033 +04:00 INF Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:38:10.050 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:10.051 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 17ms reading results.
2025-04-01 14:38:10.060 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:10.061 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:38:10.062 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:38:10.062 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:10.062 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:38:10.134 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 14:38:10.134 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 14:38:10.135 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 14:38:10.135 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 14:38:10.185 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 14:38:10.325 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 14:38:10.339 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 14:38:10.339 +04:00 INF Hosting environment: Development
2025-04-01 14:38:10.339 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 14:38:10.339 +04:00 DBG Hosting started
2025-04-01 14:38:10.359 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 14:38:10.359 +04:00 DBG Request did not match any endpoints
2025-04-01 14:38:10.467 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 14:38:10.470 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 14:38:10.543 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 14:38:10.544 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 14:38:10.613 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 14:38:10.617 +04:00 DBG Connection ID "18014398511092596745" disconnecting.
2025-04-01 14:38:10.617 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 14:38:10.626 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 456.0631ms
2025-04-01 14:38:10.636 +04:00 DBG Connection ID "18014398511092596747" disconnecting.
2025-04-01 14:38:10.634 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 15.7978ms
2025-04-01 14:38:10.700 +04:00 DBG Connection ID "18158513703463419919" disconnecting.
2025-04-01 14:38:10.709 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 96.6265ms
2025-04-01 14:38:10.782 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 14:38:10.782 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 14:38:10.782 +04:00 DBG Request did not match any endpoints
2025-04-01 14:38:10.813 +04:00 DBG Connection ID "18374686489872171030" disconnecting.
2025-04-01 14:38:10.814 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 32.3069ms
2025-04-01 14:38:20.848 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 47
2025-04-01 14:38:20.880 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 14:38:20.884 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 14:38:20.887 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:38:20.891 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 14:38:20.949 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 14:38:20.953 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:38:20.978 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 14:38:20.979 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 14:38:20.980 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 14:38:20.980 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 14:38:20.981 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 14:38:20.981 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 14:38:20.983 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:38:21.063 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:38:21.065 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:38:21.070 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:38:21.077 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 14:38:21.079 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 14:38:21.119 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 14:38:21.120 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:38:21.121 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:38:21.121 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:38:21.132 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:38:21.134 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:38:21.135 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:38:21.135 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:38:21.136 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:38:21.140 +04:00 INF Login attempt for string
2025-04-01 14:38:21.148 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 14:38:21.167 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 14:38:21.181 +04:00 DBG Creating DbConnection.
2025-04-01 14:38:21.182 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:38:21.182 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:21.182 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:21.182 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:38:21.183 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:38:21.189 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-04-01 14:38:21.194 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:38:21.242 +04:00 INF Executed DbCommand (53ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 14:38:21.245 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:21.246 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 14:38:21.246 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:21.247 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:38:21.437 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 450.3585ms
2025-04-01 14:38:21.439 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:38:21.447 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 74
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 14:38:21.491 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:38:21.491 +04:00 DBG Connection ID "17942340917054668813" disconnecting.
2025-04-01 14:38:21.491 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:38:21.491 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:38:21.494 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null null 645.5406ms
2025-04-01 14:39:53.840 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:39:53.978 +04:00 INF starting web host
2025-04-01 14:39:54.143 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:39:55.112 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:39:55.113 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:39:55.228 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:39:55.398 +04:00 DBG Creating DbConnection.
2025-04-01 14:39:55.460 +04:00 DBG Created DbConnection. (59ms).
2025-04-01 14:39:55.461 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:55.475 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:55.797 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:55.801 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:39:55.807 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 14:39:55.808 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 14:39:55.817 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:39:55.852 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:39:55.856 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:55.873 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (9ms).
2025-04-01 14:39:55.873 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:55.875 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:55.877 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:39:55.882 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:39:55.882 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:39:55.882 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:39:55.885 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:39:55.911 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:39:56.023 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:39:56.030 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:39:56.034 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:39:56.035 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:39:56.037 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-04-01 14:39:56.037 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:39:56.039 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:39:56.041 +04:00 DBG Committing transaction.
2025-04-01 14:39:56.043 +04:00 DBG Committed transaction.
2025-04-01 14:39:56.045 +04:00 DBG Disposing transaction.
2025-04-01 14:39:56.046 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:39:56.047 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:39:56.050 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:39:56.050 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:39:56.051 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:39:56.051 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:39:56.051 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:39:56.052 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:39:56.052 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:39:56.052 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:39:56.052 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:39:56.053 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:39:56.056 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:39:56.056 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:39:56.056 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:39:56.057 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:39:56.060 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:39:56.065 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.067 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 14:39:56.074 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:39:56.074 +04:00 DBG Committing transaction.
2025-04-01 14:39:56.074 +04:00 DBG Committed transaction.
2025-04-01 14:39:56.075 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:39:56.075 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:39:56.075 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:39:56.075 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:39:56.077 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:39:56.077 +04:00 DBG Disposing transaction.
2025-04-01 14:39:56.077 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.078 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:39:56.147 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:39:56.467 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:39:56.527 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.527 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.527 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:39:56.527 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:39:56.527 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:39:56.528 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:39:56.531 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:39:56.534 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.535 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 14:39:56.535 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.535 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:39:56.537 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:39:56.540 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.541 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 14:39:56.548 +04:00 DBG Hosting starting
2025-04-01 14:39:56.576 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:39:56.594 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:39:56.603 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:39:56.612 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:39:56.618 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:39:56.619 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:39:56.621 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:39:56.622 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:39:56.623 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:39:56.625 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:39:56.626 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:39:56.653 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:39:56.668 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:39:56.758 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:39:56.779 +04:00 DBG Creating DbConnection.
2025-04-01 14:39:56.780 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:39:56.784 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.787 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.787 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:39:56.787 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:39:56.787 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:39:56.788 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:39:56.807 +04:00 INF Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:39:56.822 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.824 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-04-01 14:39:56.826 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.827 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:39:56.828 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:39:56.828 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:39:56.828 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:39:56.907 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 14:39:56.908 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 14:39:56.908 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 14:39:56.908 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 14:39:56.975 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 14:39:57.137 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 14:39:57.175 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 14:39:57.175 +04:00 INF Hosting environment: Development
2025-04-01 14:39:57.175 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 14:39:57.176 +04:00 DBG Hosting started
2025-04-01 14:39:57.179 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 14:39:57.179 +04:00 DBG Request did not match any endpoints
2025-04-01 14:39:57.326 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 14:39:57.329 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 14:39:57.396 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 14:39:57.398 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 14:39:57.416 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 457.9329ms
2025-04-01 14:39:57.460 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 14:39:57.460 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 14:39:57.469 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 4.6203ms
2025-04-01 14:39:57.526 +04:00 DBG Connection ID "17942340917054668817" disconnecting.
2025-04-01 14:39:57.529 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 69.7339ms
2025-04-01 14:39:57.658 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 14:39:57.658 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 14:39:57.658 +04:00 DBG Request did not match any endpoints
2025-04-01 14:39:57.697 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.0621ms
2025-04-01 14:40:14.458 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 47
2025-04-01 14:40:14.471 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 14:40:14.475 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 14:40:14.476 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:40:14.480 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 14:40:14.561 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 14:40:14.566 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:40:14.598 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 14:40:14.601 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 14:40:14.601 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 14:40:14.602 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 14:40:14.602 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 14:40:14.602 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 14:40:14.605 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:40:14.687 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:40:14.689 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:40:14.695 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:40:14.701 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 14:40:14.703 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 14:40:14.740 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 14:40:14.742 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:40:14.742 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:40:14.743 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:40:14.756 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:40:14.757 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:40:14.758 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:40:14.758 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:40:14.759 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:40:14.761 +04:00 INF Login attempt for string
2025-04-01 14:40:14.872 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 265.2365ms
2025-04-01 14:40:14.873 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:40:14.875 +04:00 ERR An unhandled exception has occurred while executing the request.System.Exception: some exception
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 14:40:14.901 +04:00 DBG Connection ID "18374686485577203726" disconnecting.
2025-04-01 14:40:14.901 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:40:14.904 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null null 446.1106ms
2025-04-01 14:40:38.149 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 14:40:38.152 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 14:40:38.152 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 14:40:38.152 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:40:38.153 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 14:40:38.161 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 14:40:38.162 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:40:38.162 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 14:40:38.164 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 14:40:38.164 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 14:40:38.164 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 14:40:38.164 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 14:40:38.164 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 14:40:38.165 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:40:38.167 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:40:38.167 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 14:40:38.168 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:40:38.168 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 14:40:38.168 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 14:40:38.169 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 14:40:38.169 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:40:38.169 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:40:38.169 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 14:40:38.170 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 14:40:38.170 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:40:38.170 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:40:38.170 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 14:40:38.170 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 14:40:38.170 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 14:40:38.207 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 41.8664ms
2025-04-01 14:40:38.207 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 14:40:38.208 +04:00 ERR An unhandled exception has occurred while executing the request.System.Exception: some exception
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 14:40:38.210 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:40:38.210 +04:00 DBG Connection ID "18086456118015426561" disconnecting.
2025-04-01 14:40:38.211 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null null 61.9209ms
2025-04-01 14:43:38.082 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:43:38.209 +04:00 INF starting web host
2025-04-01 14:43:38.378 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:43:39.312 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:43:39.313 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:43:39.388 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:43:39.550 +04:00 DBG Creating DbConnection.
2025-04-01 14:43:39.595 +04:00 DBG Created DbConnection. (42ms).
2025-04-01 14:43:39.597 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:39.610 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:39.966 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:39.973 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:43:39.979 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 14:43:39.981 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 14:43:39.988 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:43:40.027 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:43:40.030 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.042 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-04-01 14:43:40.042 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.043 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.045 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:43:40.047 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:43:40.047 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:43:40.048 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:43:40.048 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:43:40.078 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:43:40.193 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:43:40.199 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:43:40.200 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:43:40.200 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:43:40.201 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 14:43:40.201 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:43:40.204 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:43:40.206 +04:00 DBG Committing transaction.
2025-04-01 14:43:40.209 +04:00 DBG Committed transaction.
2025-04-01 14:43:40.211 +04:00 DBG Disposing transaction.
2025-04-01 14:43:40.212 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:43:40.213 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:43:40.214 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:43:40.214 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:43:40.214 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:43:40.214 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:43:40.215 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:43:40.215 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:43:40.215 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:43:40.215 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:43:40.216 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:43:40.216 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:43:40.218 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:43:40.218 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:43:40.218 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:43:40.219 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:43:40.224 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:43:40.227 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.228 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:43:40.233 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:43:40.233 +04:00 DBG Committing transaction.
2025-04-01 14:43:40.233 +04:00 DBG Committed transaction.
2025-04-01 14:43:40.234 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:43:40.234 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:43:40.234 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:43:40.234 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:43:40.238 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:43:40.238 +04:00 DBG Disposing transaction.
2025-04-01 14:43:40.238 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.239 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:43:40.294 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:43:40.534 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:43:40.601 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.601 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.602 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:43:40.602 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:43:40.602 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:43:40.602 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:43:40.610 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:43:40.614 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.614 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 14:43:40.614 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.614 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:43:40.617 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:43:40.624 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.625 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-04-01 14:43:40.631 +04:00 DBG Hosting starting
2025-04-01 14:43:40.660 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:43:40.694 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:43:40.701 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:43:40.712 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:43:40.715 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:43:40.716 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:43:40.718 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:43:40.719 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:43:40.721 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:43:40.722 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:43:40.723 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:43:40.745 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:43:40.761 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:43:40.847 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:43:40.865 +04:00 DBG Creating DbConnection.
2025-04-01 14:43:40.866 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:43:40.868 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.874 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.874 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:43:40.874 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:43:40.874 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:43:40.875 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:43:40.905 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:43:40.921 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.922 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-04-01 14:43:40.932 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.933 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:43:40.934 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:43:40.934 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:43:40.934 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:43:40.983 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 14:43:40.992 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 14:43:41.051 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 14:43:41.076 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 14:43:41.073 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 94

2025-04-01 14:53:57.412 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:53:57.586 +04:00 INF starting web host
2025-04-01 14:53:57.763 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:53:58.686 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:53:58.690 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:53:58.789 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:53:58.959 +04:00 DBG Creating DbConnection.
2025-04-01 14:53:59.010 +04:00 DBG Created DbConnection. (48ms).
2025-04-01 14:53:59.013 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.030 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.330 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.336 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:53:59.346 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 14:53:59.348 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-04-01 14:53:59.359 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:53:59.395 +04:00 INF Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:53:59.397 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.407 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-04-01 14:53:59.408 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.409 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.411 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:53:59.414 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:53:59.414 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:53:59.415 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:53:59.415 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:53:59.435 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:53:59.501 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:53:59.510 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:53:59.511 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:53:59.511 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:53:59.512 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 14:53:59.512 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:53:59.514 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:53:59.516 +04:00 DBG Committing transaction.
2025-04-01 14:53:59.520 +04:00 DBG Committed transaction.
2025-04-01 14:53:59.523 +04:00 DBG Disposing transaction.
2025-04-01 14:53:59.525 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:53:59.525 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:53:59.528 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:53:59.528 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:53:59.529 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:53:59.529 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:53:59.530 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:53:59.530 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:53:59.530 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:53:59.530 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:53:59.531 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:53:59.532 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:53:59.534 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:53:59.534 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:53:59.534 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:53:59.535 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:53:59.539 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:53:59.543 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.545 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 14:53:59.551 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:53:59.551 +04:00 DBG Committing transaction.
2025-04-01 14:53:59.552 +04:00 DBG Committed transaction.
2025-04-01 14:53:59.552 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:53:59.552 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:53:59.553 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:53:59.553 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:53:59.557 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:53:59.557 +04:00 DBG Disposing transaction.
2025-04-01 14:53:59.557 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:53:59.558 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:53:59.675 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:53:59.964 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:54:00.019 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.019 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.024 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:54:00.024 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:54:00.024 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:54:00.024 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:54:00.049 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:54:00.052 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.052 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 14:54:00.053 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.053 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:54:00.056 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:54:00.060 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.061 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 14:54:00.066 +04:00 DBG Hosting starting
2025-04-01 14:54:00.094 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:54:00.124 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:54:00.134 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:54:00.156 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:54:00.162 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:54:00.163 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:54:00.165 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:54:00.168 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:54:00.172 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:54:00.176 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:54:00.177 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:54:00.214 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:54:00.251 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:54:00.322 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:54:00.341 +04:00 DBG Creating DbConnection.
2025-04-01 14:54:00.342 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:54:00.344 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.347 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.347 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:54:00.347 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:54:00.348 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:54:00.348 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:54:00.381 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:54:00.394 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.396 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-04-01 14:54:00.398 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.399 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:54:00.399 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:54:00.400 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:54:00.400 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:54:00.471 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 14:54:00.477 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 14:54:00.525 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 14:54:00.551 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 14:54:00.546 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 88

2025-04-01 14:56:58.624 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:56:58.838 +04:00 INF starting web host
2025-04-01 14:56:58.984 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:57:00.199 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:57:00.200 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:57:00.301 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:57:00.520 +04:00 DBG Creating DbConnection.
2025-04-01 14:57:00.563 +04:00 DBG Created DbConnection. (40ms).
2025-04-01 14:57:00.565 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:00.576 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:00.866 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:00.871 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:57:00.882 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 14:57:00.885 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-04-01 14:57:00.894 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:57:00.935 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:57:00.937 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:00.952 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (7ms).
2025-04-01 14:57:00.952 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:00.954 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:00.955 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:57:00.958 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:57:00.959 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:57:00.959 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-04-01 14:57:00.962 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:57:00.982 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:57:01.070 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:57:01.080 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:57:01.081 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:57:01.081 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:57:01.082 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 14:57:01.083 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:57:01.085 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:57:01.086 +04:00 DBG Committing transaction.
2025-04-01 14:57:01.089 +04:00 DBG Committed transaction.
2025-04-01 14:57:01.091 +04:00 DBG Disposing transaction.
2025-04-01 14:57:01.095 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:57:01.096 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:57:01.099 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:57:01.099 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:57:01.099 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:57:01.099 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:57:01.100 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:57:01.101 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:57:01.101 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:57:01.101 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:57:01.101 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:57:01.102 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:57:01.106 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:57:01.106 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:57:01.106 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:57:01.107 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:57:01.111 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:57:01.114 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:01.116 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 14:57:01.127 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:57:01.128 +04:00 DBG Committing transaction.
2025-04-01 14:57:01.128 +04:00 DBG Committed transaction.
2025-04-01 14:57:01.129 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:57:01.129 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:57:01.129 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:57:01.129 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:57:01.132 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:57:01.132 +04:00 DBG Disposing transaction.
2025-04-01 14:57:01.132 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:01.133 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:57:01.227 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:57:01.556 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:57:01.593 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:01.594 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:01.594 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:57:01.594 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:57:01.595 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:57:01.595 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:57:01.598 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:57:01.600 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:01.601 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:57:01.601 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:01.601 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:57:01.602 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:57:01.604 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:01.605 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:57:04.799 +04:00 DBG Hosting starting
2025-04-01 14:57:04.828 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:57:09.670 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:57:09.682 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:57:09.694 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:57:09.697 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:57:09.698 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:57:09.700 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:57:09.702 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:57:09.703 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:57:09.708 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:57:09.709 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:57:19.595 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:57:40.867 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 14:57:40.976 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 14:57:40.997 +04:00 DBG Creating DbConnection.
2025-04-01 14:57:40.998 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 14:57:41.000 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:41.002 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:41.003 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:57:41.003 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:57:41.003 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:57:41.004 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:57:41.059 +04:00 INF Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 14:57:41.078 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:41.079 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 19ms reading results.
2025-04-01 14:57:41.081 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:41.081 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:57:46.054 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:57:46.055 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:57:46.055 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 14:57:48.377 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 14:57:48.385 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 14:57:49.885 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 14:57:49.891 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 14:57:49.884 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 86

2025-04-01 14:58:52.992 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 14:58:53.130 +04:00 INF starting web host
2025-04-01 14:58:53.329 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 14:58:54.381 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:58:54.382 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 14:58:54.457 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 14:58:54.653 +04:00 DBG Creating DbConnection.
2025-04-01 14:58:54.698 +04:00 DBG Created DbConnection. (44ms).
2025-04-01 14:58:54.700 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:54.714 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.098 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.105 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:58:55.116 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 14:58:55.122 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-04-01 14:58:55.129 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:58:55.156 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:58:55.158 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.166 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 14:58:55.166 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.167 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.169 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 14:58:55.171 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:58:55.171 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:58:55.171 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:58:55.172 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:58:55.195 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 14:58:55.298 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:58:55.306 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:58:55.308 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:58:55.308 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:58:55.309 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 14:58:55.310 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:58:55.316 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 14:58:55.318 +04:00 DBG Committing transaction.
2025-04-01 14:58:55.324 +04:00 DBG Committed transaction.
2025-04-01 14:58:55.327 +04:00 DBG Disposing transaction.
2025-04-01 14:58:55.330 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 14:58:55.331 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 14:58:55.334 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 14:58:55.334 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:58:55.334 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 14:58:55.334 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:58:55.338 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 14:58:55.338 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:58:55.338 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:58:55.338 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:58:55.339 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:58:55.340 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 14:58:55.342 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:58:55.342 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:58:55.343 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:58:55.343 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:58:55.349 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 14:58:55.353 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.355 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 14:58:55.362 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 14:58:55.362 +04:00 DBG Committing transaction.
2025-04-01 14:58:55.363 +04:00 DBG Committed transaction.
2025-04-01 14:58:55.363 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 14:58:55.363 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:58:55.364 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 14:58:55.364 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:58:55.368 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 14:58:55.368 +04:00 DBG Disposing transaction.
2025-04-01 14:58:55.368 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.369 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:58:55.443 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 14:58:55.754 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 14:58:55.819 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.820 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.820 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 14:58:55.820 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:58:55.820 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 14:58:55.821 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:58:55.829 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 14:58:55.832 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.832 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 14:58:55.832 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.832 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 14:58:55.834 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 14:58:55.838 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 14:58:55.839 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 14:58:58.603 +04:00 DBG Hosting starting
2025-04-01 14:58:58.638 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 14:59:02.407 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 14:59:02.419 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 14:59:02.438 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 14:59:02.443 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:59:02.444 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 14:59:02.447 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 14:59:02.449 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 14:59:02.452 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 14:59:02.455 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 14:59:02.456 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 14:59:18.156 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:00:08.821 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:00:08.887 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:00:08.904 +04:00 DBG Creating DbConnection.
2025-04-01 15:00:08.905 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:00:08.906 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:00:08.909 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:00:08.909 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:00:08.909 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:00:08.910 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:00:08.910 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:00:08.960 +04:00 INF Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:00:08.977 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:00:08.978 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 17ms reading results.
2025-04-01 15:00:08.980 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:00:08.981 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:00:18.565 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:00:18.566 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:00:18.566 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:00:34.400 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 15:00:34.407 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 15:02:30.065 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:02:30.258 +04:00 INF starting web host
2025-04-01 15:02:30.410 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:02:31.385 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:02:31.387 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:02:31.479 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:02:31.620 +04:00 DBG Creating DbConnection.
2025-04-01 15:02:31.674 +04:00 DBG Created DbConnection. (48ms).
2025-04-01 15:02:31.677 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:31.691 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.053 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.059 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:02:32.064 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:02:32.066 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 15:02:32.075 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:02:32.112 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:02:32.114 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.125 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:02:32.125 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.127 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.128 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:02:32.131 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:02:32.131 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:02:32.131 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:02:32.132 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:02:32.158 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:02:32.260 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:02:32.267 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:02:32.269 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:02:32.269 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:02:32.271 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-04-01 15:02:32.272 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:02:32.276 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:02:32.278 +04:00 DBG Committing transaction.
2025-04-01 15:02:32.281 +04:00 DBG Committed transaction.
2025-04-01 15:02:32.284 +04:00 DBG Disposing transaction.
2025-04-01 15:02:32.286 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:02:32.287 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:02:32.290 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:02:32.290 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:02:32.290 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:02:32.290 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:02:32.291 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:02:32.292 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:02:32.292 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:02:32.292 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:02:32.292 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:02:32.293 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:02:32.295 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:02:32.295 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:02:32.295 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:02:32.295 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:02:32.298 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:02:32.301 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.302 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:02:32.312 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:02:32.313 +04:00 DBG Committing transaction.
2025-04-01 15:02:32.313 +04:00 DBG Committed transaction.
2025-04-01 15:02:32.313 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:02:32.314 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:02:32.314 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:02:32.314 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:02:32.318 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:02:32.319 +04:00 DBG Disposing transaction.
2025-04-01 15:02:32.319 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.320 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:02:32.382 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:02:32.699 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:02:32.761 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.761 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.761 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:02:32.762 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:02:32.762 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:02:32.762 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:02:32.768 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:02:32.775 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.776 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-04-01 15:02:32.776 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.776 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:02:32.778 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:02:32.780 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:32.781 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:02:34.814 +04:00 DBG Hosting starting
2025-04-01 15:02:34.844 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:02:36.571 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:02:36.578 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:02:36.591 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:02:36.594 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:02:36.595 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:02:36.597 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:02:36.599 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:02:36.601 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:02:36.604 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:02:36.605 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:02:38.513 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:02:43.580 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:02:43.649 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:02:43.671 +04:00 DBG Creating DbConnection.
2025-04-01 15:02:43.672 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:02:43.674 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:43.676 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:43.677 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:02:43.677 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:02:43.677 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:02:43.678 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:02:43.702 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:02:43.745 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:43.746 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 42ms reading results.
2025-04-01 15:02:43.748 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:43.749 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:02:48.378 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:02:48.378 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:02:48.378 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:02:49.755 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 15:02:49.755 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 15:02:49.755 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 15:02:49.755 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 15:02:49.840 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 15:02:50.003 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 15:02:50.003 +04:00 INF Hosting environment: Development
2025-04-01 15:02:50.003 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 15:02:50.003 +04:00 DBG Hosting started
2025-04-01 15:02:50.012 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 15:02:50.046 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 15:02:50.047 +04:00 DBG Request did not match any endpoints
2025-04-01 15:02:50.126 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 15:02:50.129 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 15:02:50.231 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 15:02:50.232 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 15:02:50.241 +04:00 DBG Connection ID "18374686489872171043" disconnecting.
2025-04-01 15:02:50.245 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 414.7946ms
2025-04-01 15:02:50.526 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 15:02:50.532 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 15:02:50.542 +04:00 DBG Connection ID "18230571297501347852" disconnecting.
2025-04-01 15:02:50.547 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 8.1624ms
2025-04-01 15:02:50.678 +04:00 DBG Connection ID "18374686489872171045" disconnecting.
2025-04-01 15:02:50.698 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 172.3192ms
2025-04-01 15:02:50.791 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 15:02:50.791 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 15:02:50.791 +04:00 DBG Request did not match any endpoints
2025-04-01 15:02:50.846 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 55.2008ms
2025-04-01 15:07:48.629 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:07:48.861 +04:00 INF starting web host
2025-04-01 15:07:49.028 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:07:50.110 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:07:50.111 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:07:50.196 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:07:50.336 +04:00 DBG Creating DbConnection.
2025-04-01 15:07:50.391 +04:00 DBG Created DbConnection. (54ms).
2025-04-01 15:07:50.393 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.406 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.707 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.711 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:07:50.717 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:07:50.720 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 15:07:50.726 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:07:50.754 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:07:50.757 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.773 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-04-01 15:07:50.774 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.777 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.778 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:07:50.780 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:07:50.780 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:07:50.781 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:07:50.781 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:07:50.806 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:07:50.874 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:07:50.879 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:07:50.881 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:07:50.881 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:07:50.883 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-04-01 15:07:50.885 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:07:50.890 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:07:50.892 +04:00 DBG Committing transaction.
2025-04-01 15:07:50.895 +04:00 DBG Committed transaction.
2025-04-01 15:07:50.896 +04:00 DBG Disposing transaction.
2025-04-01 15:07:50.898 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:07:50.898 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:07:50.902 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:07:50.902 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:07:50.902 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:07:50.902 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:07:50.903 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:07:50.903 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:07:50.904 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:07:50.904 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:07:50.904 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:07:50.905 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:07:50.906 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:07:50.906 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:07:50.906 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:07:50.907 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:07:50.910 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:07:50.912 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.914 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:07:50.920 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:07:50.920 +04:00 DBG Committing transaction.
2025-04-01 15:07:50.920 +04:00 DBG Committed transaction.
2025-04-01 15:07:50.921 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:07:50.921 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:07:50.921 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:07:50.921 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:07:50.925 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:07:50.925 +04:00 DBG Disposing transaction.
2025-04-01 15:07:50.926 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:50.926 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:07:50.992 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:07:51.229 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:07:51.276 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.277 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.277 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:07:51.277 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:07:51.277 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:07:51.277 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:07:51.282 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:07:51.288 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.288 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-04-01 15:07:51.288 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.288 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:07:51.290 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:07:51.291 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.292 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:07:51.297 +04:00 DBG Hosting starting
2025-04-01 15:07:51.321 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:07:51.337 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:07:51.343 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:07:51.356 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:07:51.359 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:07:51.360 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:07:51.362 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:07:51.363 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:07:51.364 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:07:51.368 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:07:51.369 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:07:51.390 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:07:51.408 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:07:51.479 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:07:51.501 +04:00 DBG Creating DbConnection.
2025-04-01 15:07:51.502 +04:00 DBG Created DbConnection. (1ms).
2025-04-01 15:07:51.504 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.508 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.509 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:07:51.509 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:07:51.509 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:07:51.509 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:07:51.539 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:07:51.557 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.558 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 18ms reading results.
2025-04-01 15:07:51.560 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.561 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:07:51.572 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:07:51.573 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:07:51.573 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:07:51.644 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 15:07:51.652 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 15:07:51.701 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:07:51.722 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:07:51.717 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 95

2025-04-01 15:16:48.100 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:16:48.231 +04:00 INF starting web host
2025-04-01 15:16:48.376 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:16:49.222 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:16:49.224 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:16:49.318 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:16:49.454 +04:00 DBG Creating DbConnection.
2025-04-01 15:16:49.511 +04:00 DBG Created DbConnection. (55ms).
2025-04-01 15:16:49.513 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:49.528 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:49.833 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:49.837 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:16:49.842 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:16:49.844 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 15:16:49.852 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:16:49.875 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:16:49.877 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:49.890 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (9ms).
2025-04-01 15:16:49.890 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:49.891 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:49.892 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:16:49.894 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:16:49.894 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:16:49.895 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:16:49.896 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:16:49.917 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:16:49.999 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:16:50.004 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:16:50.005 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:16:50.005 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:16:50.006 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:16:50.006 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:16:50.011 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:16:50.015 +04:00 DBG Committing transaction.
2025-04-01 15:16:50.020 +04:00 DBG Committed transaction.
2025-04-01 15:16:50.021 +04:00 DBG Disposing transaction.
2025-04-01 15:16:50.022 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:16:50.023 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:16:50.024 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:16:50.024 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:16:50.025 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:16:50.025 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:16:50.025 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:16:50.026 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:16:50.026 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:16:50.026 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:16:50.026 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:16:50.027 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:16:50.030 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:16:50.031 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:16:50.031 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:16:50.031 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:16:50.034 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:16:50.037 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.038 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:16:50.043 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:16:50.043 +04:00 DBG Committing transaction.
2025-04-01 15:16:50.044 +04:00 DBG Committed transaction.
2025-04-01 15:16:50.044 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:16:50.044 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:16:50.044 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:16:50.044 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:16:50.049 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:16:50.049 +04:00 DBG Disposing transaction.
2025-04-01 15:16:50.049 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.050 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:16:50.110 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:16:50.340 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:16:50.394 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.394 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.395 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:16:50.395 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:16:50.396 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:16:50.396 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:16:50.402 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:16:50.405 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.405 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:16:50.405 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.405 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:16:50.407 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:16:50.409 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.410 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:16:50.420 +04:00 DBG Hosting starting
2025-04-01 15:16:50.447 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:16:50.465 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:16:50.471 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:16:50.483 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:16:50.486 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:16:50.487 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:16:50.489 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:16:50.490 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:16:50.491 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:16:50.493 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:16:50.494 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:16:50.521 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:16:50.553 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:16:50.647 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:16:50.665 +04:00 DBG Creating DbConnection.
2025-04-01 15:16:50.665 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:16:50.667 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.669 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.669 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:16:50.669 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:16:50.669 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:16:50.670 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:16:50.688 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:16:50.700 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.701 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 12ms reading results.
2025-04-01 15:16:50.703 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.704 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:16:50.704 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:16:50.705 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:16:50.705 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:16:50.753 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 15:16:50.760 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 15:16:50.808 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:16:50.840 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:16:50.837 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 95

2025-04-01 15:19:52.448 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:19:52.604 +04:00 INF starting web host
2025-04-01 15:19:52.764 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:19:53.548 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:19:53.552 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:19:53.657 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:19:53.795 +04:00 DBG Creating DbConnection.
2025-04-01 15:19:53.848 +04:00 DBG Created DbConnection. (50ms).
2025-04-01 15:19:53.850 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:53.860 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.138 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.142 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:19:54.147 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:19:54.153 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 15:19:54.158 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:19:54.182 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:19:54.184 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.192 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:19:54.192 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.193 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.195 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:19:54.197 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:19:54.197 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:19:54.197 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:19:54.198 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:19:54.223 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:19:54.303 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:19:54.308 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:19:54.310 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:19:54.310 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:19:54.311 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:19:54.311 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:19:54.316 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:19:54.317 +04:00 DBG Committing transaction.
2025-04-01 15:19:54.320 +04:00 DBG Committed transaction.
2025-04-01 15:19:54.322 +04:00 DBG Disposing transaction.
2025-04-01 15:19:54.324 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:19:54.324 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:19:54.326 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:19:54.326 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:19:54.326 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:19:54.326 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:19:54.327 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:19:54.327 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:19:54.327 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:19:54.327 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:19:54.328 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:19:54.328 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:19:54.330 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:19:54.330 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:19:54.330 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:19:54.331 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:19:54.337 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:19:54.340 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.341 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 15:19:54.347 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:19:54.347 +04:00 DBG Committing transaction.
2025-04-01 15:19:54.348 +04:00 DBG Committed transaction.
2025-04-01 15:19:54.348 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:19:54.349 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:19:54.350 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-04-01 15:19:54.351 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:19:54.356 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:19:54.356 +04:00 DBG Disposing transaction.
2025-04-01 15:19:54.356 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.357 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:19:54.424 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:19:54.664 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:19:54.713 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.714 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.714 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:19:54.714 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:19:54.714 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:19:54.714 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:19:54.719 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:19:54.721 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.722 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:19:54.722 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.722 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:19:54.723 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:19:54.725 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.726 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:19:54.730 +04:00 DBG Hosting starting
2025-04-01 15:19:54.755 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:19:54.770 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:19:54.776 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:19:54.785 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:19:54.788 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:19:54.789 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:19:54.791 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:19:54.792 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:19:54.793 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:19:54.795 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:19:54.796 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:19:54.828 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:19:54.842 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:19:54.909 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:19:54.925 +04:00 DBG Creating DbConnection.
2025-04-01 15:19:54.925 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:19:54.927 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.929 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.930 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:19:54.930 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:19:54.930 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:19:54.930 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:19:54.956 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:19:54.972 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.973 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-04-01 15:19:54.981 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.982 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-04-01 15:19:54.983 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:19:54.983 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:19:54.984 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:19:55.032 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 15:19:55.040 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 15:19:55.102 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:19:55.132 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:19:55.127 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 97

2025-04-01 15:22:36.980 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:22:37.093 +04:00 INF starting web host
2025-04-01 15:22:37.269 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:22:38.178 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:22:38.179 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:22:38.261 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:22:38.412 +04:00 DBG Creating DbConnection.
2025-04-01 15:22:38.456 +04:00 DBG Created DbConnection. (39ms).
2025-04-01 15:22:38.458 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:38.470 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:38.795 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:38.799 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:22:38.805 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:22:38.807 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 15:22:38.812 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:22:38.837 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:22:38.842 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:38.849 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:22:38.849 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:38.850 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:38.851 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:22:38.856 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:22:38.856 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:22:38.857 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:22:38.858 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:22:38.877 +04:00 INF Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:22:38.945 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:22:38.954 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:22:38.957 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:22:38.958 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:22:38.959 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:22:38.960 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:22:38.965 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:22:38.967 +04:00 DBG Committing transaction.
2025-04-01 15:22:38.972 +04:00 DBG Committed transaction.
2025-04-01 15:22:38.975 +04:00 DBG Disposing transaction.
2025-04-01 15:22:38.976 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:22:38.977 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:22:38.978 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:22:38.978 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:22:38.978 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:22:38.978 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:22:38.979 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:22:38.980 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:22:38.980 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:22:38.980 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:22:38.980 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:22:38.981 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:22:38.983 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:22:38.983 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:22:38.983 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:22:38.984 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:22:38.987 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:22:38.991 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:38.993 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:22:38.997 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:22:38.998 +04:00 DBG Committing transaction.
2025-04-01 15:22:38.998 +04:00 DBG Committed transaction.
2025-04-01 15:22:38.998 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:22:38.998 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:22:38.999 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:22:38.999 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:22:39.004 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:22:39.004 +04:00 DBG Disposing transaction.
2025-04-01 15:22:39.004 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.005 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:22:39.077 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:22:39.402 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:22:39.443 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.443 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.443 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:22:39.443 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:22:39.443 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:22:39.444 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:22:39.448 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:22:39.451 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.451 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:22:39.451 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.451 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:22:39.453 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:22:39.457 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.458 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:22:39.462 +04:00 DBG Hosting starting
2025-04-01 15:22:39.485 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:22:39.507 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:22:39.515 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:22:39.535 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:22:39.540 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:22:39.540 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:22:39.543 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:22:39.544 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:22:39.546 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:22:39.548 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:22:39.549 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:22:39.590 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:22:39.624 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:22:39.695 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:22:39.714 +04:00 DBG Creating DbConnection.
2025-04-01 15:22:39.714 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:22:39.716 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.718 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.718 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:22:39.718 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:22:39.718 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:22:39.719 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:22:39.746 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:22:39.762 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.763 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-04-01 15:22:39.765 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.766 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:22:39.777 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:22:39.778 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:22:39.778 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:22:39.839 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 15:22:39.849 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 15:22:39.906 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:22:39.929 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:22:39.926 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 96

2025-04-01 15:24:48.239 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:24:48.400 +04:00 INF starting web host
2025-04-01 15:24:48.542 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:24:49.368 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:24:49.369 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:24:49.459 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:24:49.599 +04:00 DBG Creating DbConnection.
2025-04-01 15:24:49.655 +04:00 DBG Created DbConnection. (53ms).
2025-04-01 15:24:49.657 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:49.673 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:49.990 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:49.994 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:24:50.004 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 15:24:50.006 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-04-01 15:24:50.013 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:24:50.035 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:24:50.037 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.047 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:24:50.047 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.048 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.049 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:24:50.051 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:24:50.051 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:24:50.052 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:24:50.052 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:24:50.075 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:24:50.151 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:24:50.157 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:24:50.158 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:24:50.158 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:24:50.159 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:24:50.159 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:24:50.164 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:24:50.166 +04:00 DBG Committing transaction.
2025-04-01 15:24:50.169 +04:00 DBG Committed transaction.
2025-04-01 15:24:50.170 +04:00 DBG Disposing transaction.
2025-04-01 15:24:50.172 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:24:50.173 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:24:50.174 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:24:50.174 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:24:50.174 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:24:50.174 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:24:50.175 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:24:50.176 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:24:50.176 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:24:50.176 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:24:50.176 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:24:50.177 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:24:50.180 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:24:50.181 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:24:50.181 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:24:50.181 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:24:50.184 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:24:50.186 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.188 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:24:50.192 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:24:50.192 +04:00 DBG Committing transaction.
2025-04-01 15:24:50.193 +04:00 DBG Committed transaction.
2025-04-01 15:24:50.194 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:24:50.194 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:24:50.194 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:24:50.194 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:24:50.202 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:24:50.202 +04:00 DBG Disposing transaction.
2025-04-01 15:24:50.202 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.203 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:24:50.254 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:24:50.522 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:24:50.561 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.561 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.562 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:24:50.562 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:24:50.562 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:24:50.562 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:24:50.567 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:24:50.570 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.570 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:24:50.570 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.570 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:24:50.572 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:24:50.574 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.575 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:24:50.581 +04:00 DBG Hosting starting
2025-04-01 15:24:50.606 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:24:50.622 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:24:50.629 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:24:50.638 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:24:50.641 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:24:50.642 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:24:50.645 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:24:50.647 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:24:50.648 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:24:50.650 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:24:50.651 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:24:50.674 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:24:50.687 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:24:50.753 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:24:50.769 +04:00 DBG Creating DbConnection.
2025-04-01 15:24:50.769 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:24:50.771 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.773 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.774 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:24:50.774 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:24:50.774 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:24:50.774 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:24:50.792 +04:00 INF Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:24:50.805 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.806 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-04-01 15:24:50.808 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.809 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:24:50.810 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:24:50.810 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:24:50.811 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:24:50.860 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 15:24:50.870 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 15:24:50.921 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:24:50.950 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:24:50.944 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 96

2025-04-01 15:27:26.032 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:27:26.230 +04:00 INF starting web host
2025-04-01 15:27:26.389 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:27:27.357 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:27:27.358 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:27:27.436 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:27:27.724 +04:00 DBG Creating DbConnection.
2025-04-01 15:27:27.767 +04:00 DBG Created DbConnection. (38ms).
2025-04-01 15:27:27.770 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:27.781 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.068 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.072 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:27:28.078 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:27:28.079 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 15:27:28.086 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:27:28.110 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:27:28.111 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.125 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-04-01 15:27:28.125 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.126 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.128 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:27:28.134 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:27:28.135 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:27:28.135 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:27:28.136 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:27:28.160 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:27:28.270 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:27:28.277 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:27:28.278 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:27:28.278 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:27:28.279 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:27:28.279 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:27:28.281 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:27:28.283 +04:00 DBG Committing transaction.
2025-04-01 15:27:28.287 +04:00 DBG Committed transaction.
2025-04-01 15:27:28.288 +04:00 DBG Disposing transaction.
2025-04-01 15:27:28.290 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:27:28.290 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:27:28.292 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:27:28.292 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:27:28.292 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:27:28.292 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:27:28.293 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:27:28.293 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:27:28.293 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:27:28.293 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:27:28.293 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:27:28.294 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:27:28.296 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:27:28.296 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:27:28.296 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:27:28.297 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:27:28.300 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:27:28.303 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.305 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 15:27:28.309 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:27:28.310 +04:00 DBG Committing transaction.
2025-04-01 15:27:28.310 +04:00 DBG Committed transaction.
2025-04-01 15:27:28.310 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:27:28.310 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:27:28.310 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:27:28.310 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:27:28.312 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:27:28.312 +04:00 DBG Disposing transaction.
2025-04-01 15:27:28.312 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.313 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:27:28.410 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:27:28.744 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:27:28.812 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.812 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.813 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:27:28.813 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:27:28.813 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:27:28.813 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:27:28.817 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:27:28.820 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.820 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:27:28.820 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.820 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:27:28.822 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:27:28.824 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:28.825 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:27:28.829 +04:00 DBG Hosting starting
2025-04-01 15:27:28.855 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:27:28.871 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:27:28.878 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:27:28.888 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:27:28.892 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:27:28.893 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:27:28.894 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:27:28.896 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:27:28.897 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:27:28.904 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:27:28.906 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:27:28.930 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:27:28.945 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:27:29.060 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:27:29.098 +04:00 DBG Creating DbConnection.
2025-04-01 15:27:29.103 +04:00 DBG Created DbConnection. (3ms).
2025-04-01 15:27:29.105 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:29.109 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:29.109 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:27:29.110 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:27:29.110 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:27:29.111 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:27:29.140 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:27:29.153 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:29.154 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 13ms reading results.
2025-04-01 15:27:29.156 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:29.157 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:27:29.158 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:27:29.158 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:27:29.158 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:27:29.216 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-04-01 15:27:29.231 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-04-01 15:27:29.293 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:27:29.321 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-04-01 15:27:29.314 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Builder.ExceptionHandlerExtensions.<>c__DisplayClass5_0.<SetExceptionHandlerMiddleware>b__0(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 96

2025-04-01 15:35:33.398 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:35:33.577 +04:00 INF starting web host
2025-04-01 15:35:33.817 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:35:35.065 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:35:35.066 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:35:35.157 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:35:35.297 +04:00 DBG Creating DbConnection.
2025-04-01 15:35:35.348 +04:00 DBG Created DbConnection. (45ms).
2025-04-01 15:35:35.352 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.366 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.702 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.707 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:35:35.717 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:35:35.720 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-04-01 15:35:35.732 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:35:35.769 +04:00 INF Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:35:35.772 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.792 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (12ms).
2025-04-01 15:35:35.792 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.794 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.797 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:35:35.799 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:35:35.799 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:35:35.799 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:35:35.800 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:35:35.820 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:35:35.904 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:35:35.916 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:35:35.918 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:35:35.918 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:35:35.919 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:35:35.919 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:35:35.923 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:35:35.925 +04:00 DBG Committing transaction.
2025-04-01 15:35:35.931 +04:00 DBG Committed transaction.
2025-04-01 15:35:35.932 +04:00 DBG Disposing transaction.
2025-04-01 15:35:35.934 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:35:35.935 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:35:35.937 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:35:35.937 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:35:35.938 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:35:35.938 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:35:35.938 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:35:35.939 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:35:35.939 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:35:35.939 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:35:35.939 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:35:35.940 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:35:35.942 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:35:35.942 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:35:35.942 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:35:35.943 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:35:35.947 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:35:35.950 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.952 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:35:35.958 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:35:35.958 +04:00 DBG Committing transaction.
2025-04-01 15:35:35.958 +04:00 DBG Committed transaction.
2025-04-01 15:35:35.959 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:35:35.959 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:35:35.959 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:35:35.959 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:35:35.965 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:35:35.965 +04:00 DBG Disposing transaction.
2025-04-01 15:35:35.965 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:35.966 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:35:36.064 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:35:36.358 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:35:36.397 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.398 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.398 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:35:36.398 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:35:36.398 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:35:36.398 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:35:36.405 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:35:36.408 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.408 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:35:36.408 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.408 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:35:36.410 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:35:36.413 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.414 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:35:36.422 +04:00 DBG Hosting starting
2025-04-01 15:35:36.459 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:35:36.480 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:35:36.488 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:35:36.502 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:35:36.506 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:35:36.507 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:35:36.509 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:35:36.511 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:35:36.515 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:35:36.518 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:35:36.519 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:35:36.558 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:35:36.576 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:35:36.653 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:35:36.671 +04:00 DBG Creating DbConnection.
2025-04-01 15:35:36.672 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:35:36.673 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.676 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.676 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:35:36.676 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:35:36.676 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:35:36.677 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:35:36.704 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:35:36.721 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.722 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 17ms reading results.
2025-04-01 15:35:36.733 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.734 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:35:36.735 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:35:36.735 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:35:36.735 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:35:36.848 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 15:35:36.848 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 15:35:36.848 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 15:35:36.848 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 15:35:36.924 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 15:35:37.098 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 15:35:37.098 +04:00 INF Hosting environment: Development
2025-04-01 15:35:37.098 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 15:35:37.098 +04:00 DBG Hosting started
2025-04-01 15:35:37.127 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 15:35:37.157 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 15:35:37.158 +04:00 DBG Request did not match any endpoints
2025-04-01 15:35:37.259 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 15:35:37.264 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 15:35:37.342 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 15:35:37.343 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 15:35:37.410 +04:00 DBG Connection ID "18374686485577203735" disconnecting.
2025-04-01 15:35:37.411 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 477.5342ms
2025-04-01 15:35:37.416 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 15:35:37.418 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 15:35:37.422 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.3234ms
2025-04-01 15:35:37.509 +04:00 DBG Connection ID "18374686494167138323" disconnecting.
2025-04-01 15:35:37.521 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 102.5381ms
2025-04-01 15:35:37.597 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 15:35:37.598 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 15:35:37.599 +04:00 DBG Request did not match any endpoints
2025-04-01 15:35:37.635 +04:00 DBG Connection ID "18374686494167138325" disconnecting.
2025-04-01 15:35:37.635 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.4735ms
2025-04-01 15:40:41.508 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:40:41.668 +04:00 INF starting web host
2025-04-01 15:40:41.913 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:40:42.808 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:40:42.810 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:40:42.916 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:40:43.080 +04:00 DBG Creating DbConnection.
2025-04-01 15:40:43.162 +04:00 DBG Created DbConnection. (79ms).
2025-04-01 15:40:43.163 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.192 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.614 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.618 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:40:43.626 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 15:40:43.628 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-04-01 15:40:43.634 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:40:43.663 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:40:43.665 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.678 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:40:43.678 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.679 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.681 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:40:43.684 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:40:43.684 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:40:43.684 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:40:43.685 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:40:43.717 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:40:43.839 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:40:43.848 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:40:43.849 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:40:43.849 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:40:43.851 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:40:43.851 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:40:43.860 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:40:43.862 +04:00 DBG Committing transaction.
2025-04-01 15:40:43.867 +04:00 DBG Committed transaction.
2025-04-01 15:40:43.869 +04:00 DBG Disposing transaction.
2025-04-01 15:40:43.873 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:40:43.874 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:40:43.875 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:40:43.876 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:40:43.876 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:40:43.876 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:40:43.877 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:40:43.877 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:40:43.878 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:40:43.878 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:40:43.878 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:40:43.879 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:40:43.882 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:40:43.882 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:40:43.882 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:40:43.883 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:40:43.889 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:40:43.892 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.894 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 15:40:43.903 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:40:43.904 +04:00 DBG Committing transaction.
2025-04-01 15:40:43.907 +04:00 DBG Committed transaction.
2025-04-01 15:40:43.908 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:40:43.908 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:40:43.908 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:40:43.908 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:40:43.916 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:40:43.916 +04:00 DBG Disposing transaction.
2025-04-01 15:40:43.916 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:43.917 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:40:43.983 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:40:44.302 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:40:44.374 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.374 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.374 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:40:44.375 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:40:44.375 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:40:44.375 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:40:44.380 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:40:44.384 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.384 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 15:40:44.384 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.384 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:40:44.387 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:40:44.390 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.392 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:40:44.399 +04:00 DBG Hosting starting
2025-04-01 15:40:44.440 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:40:44.459 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:40:44.470 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:40:44.482 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:40:44.486 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:40:44.486 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:40:44.491 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:40:44.493 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:40:44.494 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:40:44.496 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:40:44.497 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:40:44.530 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:40:44.545 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:40:44.650 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:40:44.669 +04:00 DBG Creating DbConnection.
2025-04-01 15:40:44.669 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:40:44.673 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.675 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.676 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:40:44.676 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:40:44.676 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:40:44.677 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:40:44.697 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:40:44.710 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.711 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 13ms reading results.
2025-04-01 15:40:44.713 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.714 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:40:44.715 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:40:44.715 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:40:44.715 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:40:44.840 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 15:40:44.840 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 15:40:44.840 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 15:40:44.840 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 15:40:44.930 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 15:40:45.132 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 15:40:45.132 +04:00 INF Hosting environment: Development
2025-04-01 15:40:45.132 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 15:40:45.132 +04:00 DBG Hosting started
2025-04-01 15:40:45.183 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 15:40:45.244 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 15:40:45.244 +04:00 DBG Request did not match any endpoints
2025-04-01 15:40:45.526 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 15:40:45.529 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 15:40:45.647 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 15:40:45.648 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 15:40:45.821 +04:00 DBG Connection ID "18374686494167138327" disconnecting.
2025-04-01 15:40:45.850 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 15:40:45.851 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 924.1973ms
2025-04-01 15:40:45.852 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 15:40:45.861 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 9.571ms
2025-04-01 15:40:45.986 +04:00 DBG Connection ID "18230571297501347856" disconnecting.
2025-04-01 15:40:45.995 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 143.5641ms
2025-04-01 15:40:46.230 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 15:40:46.230 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 15:40:46.231 +04:00 DBG Request did not match any endpoints
2025-04-01 15:40:46.315 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 95.2956ms
2025-04-01 15:41:13.606 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 15:41:13.667 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 15:41:13.673 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 15:41:13.674 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:41:13.681 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:41:13.758 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:41:13.761 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:41:13.791 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 15:41:13.793 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 15:41:13.793 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 15:41:13.793 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 15:41:13.794 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 15:41:13.794 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 15:41:13.796 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:41:13.882 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:41:13.884 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:41:13.893 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:41:13.896 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 15:41:13.900 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 15:41:13.926 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 15:41:13.926 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:41:13.927 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:41:13.927 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:41:13.935 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:41:13.938 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:41:13.940 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:41:13.940 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:41:13.941 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:41:13.944 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 15:41:13.950 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 15:41:13.980 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 15:41:13.996 +04:00 DBG Creating DbConnection.
2025-04-01 15:41:13.996 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:41:13.996 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:41:13.997 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:41:13.997 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:41:13.997 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:41:14.004 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (7ms).
2025-04-01 15:41:14.010 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:41:14.059 +04:00 INF Executed DbCommand (54ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:41:14.132 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 15:41:14.157 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:41:14.157 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 97ms reading results.
2025-04-01 15:41:14.157 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:41:14.158 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:41:18.364 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 4567.0704ms
2025-04-01 15:41:18.366 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:41:18.371 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 74
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 15:41:42.330 +04:00 ERR Handled exception: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 74
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 15:41:43.484 +04:00 DBG Connection ID "18374686489872171053" disconnecting.
2025-04-01 15:41:44.827 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:41:44.828 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:41:44.828 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:41:45.688 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null application/json 32081.1502ms
2025-04-01 15:44:00.852 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:44:00.989 +04:00 INF starting web host
2025-04-01 15:44:01.182 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:44:02.131 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:44:02.132 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:44:02.277 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:44:02.442 +04:00 DBG Creating DbConnection.
2025-04-01 15:44:02.484 +04:00 DBG Created DbConnection. (40ms).
2025-04-01 15:44:02.486 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:02.497 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:02.840 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:02.845 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:44:02.853 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-04-01 15:44:02.858 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (11ms).
2025-04-01 15:44:02.865 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:44:02.892 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:44:02.894 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:02.902 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:44:02.902 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:02.903 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:02.904 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:44:02.908 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:44:02.908 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:44:02.909 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:44:02.909 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:44:02.935 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:44:03.013 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:44:03.027 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:44:03.029 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:44:03.029 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:44:03.031 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-04-01 15:44:03.032 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:44:03.038 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:44:03.042 +04:00 DBG Committing transaction.
2025-04-01 15:44:03.046 +04:00 DBG Committed transaction.
2025-04-01 15:44:03.047 +04:00 DBG Disposing transaction.
2025-04-01 15:44:03.049 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:44:03.050 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:44:03.052 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:44:03.052 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:44:03.052 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:44:03.053 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:44:03.053 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:44:03.054 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:44:03.054 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:44:03.054 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:44:03.055 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:44:03.058 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:44:03.061 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:44:03.061 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:44:03.061 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:44:03.062 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:44:03.066 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:44:03.068 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.070 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:44:03.078 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:44:03.078 +04:00 DBG Committing transaction.
2025-04-01 15:44:03.079 +04:00 DBG Committed transaction.
2025-04-01 15:44:03.079 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:44:03.079 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:44:03.079 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:44:03.079 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:44:03.084 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:44:03.084 +04:00 DBG Disposing transaction.
2025-04-01 15:44:03.084 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.085 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:44:03.165 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:44:03.437 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:44:03.509 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.510 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.510 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:44:03.510 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:44:03.510 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:44:03.511 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:44:03.519 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:44:03.524 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.524 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-04-01 15:44:03.524 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.525 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:44:03.528 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:44:03.532 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.533 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:44:03.542 +04:00 DBG Hosting starting
2025-04-01 15:44:03.571 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:44:03.597 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:44:03.607 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:44:03.620 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:44:03.624 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:44:03.625 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:44:03.627 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:44:03.629 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:44:03.631 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:44:03.634 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:44:03.635 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:44:03.680 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:44:03.690 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:44:03.746 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:44:03.764 +04:00 DBG Creating DbConnection.
2025-04-01 15:44:03.765 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:44:03.768 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.771 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.773 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:44:03.773 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:44:03.773 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:44:03.775 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:44:03.802 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:44:03.823 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.828 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 25ms reading results.
2025-04-01 15:44:03.830 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.831 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:44:03.832 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:44:03.833 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:03.833 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:44:03.929 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 15:44:03.929 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 15:44:03.929 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 15:44:03.930 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 15:44:03.980 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 15:44:04.176 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 15:44:04.177 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 15:44:04.178 +04:00 INF Hosting environment: Development
2025-04-01 15:44:04.178 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 15:44:04.178 +04:00 DBG Hosting started
2025-04-01 15:44:04.220 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 15:44:04.221 +04:00 DBG Request did not match any endpoints
2025-04-01 15:44:04.360 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 15:44:04.364 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 15:44:04.443 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 15:44:04.444 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 15:44:04.456 +04:00 DBG Connection ID "17942340917054668834" disconnecting.
2025-04-01 15:44:04.460 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 492.3148ms
2025-04-01 15:44:04.467 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 15:44:04.497 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 15:44:04.500 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 32.6411ms
2025-04-01 15:44:04.510 +04:00 DBG Connection ID "17942340917054668836" disconnecting.
2025-04-01 15:44:04.576 +04:00 DBG Connection ID "18014398511092596761" disconnecting.
2025-04-01 15:44:04.583 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 86.3531ms
2025-04-01 15:44:04.670 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 15:44:04.670 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 15:44:04.671 +04:00 DBG Request did not match any endpoints
2025-04-01 15:44:04.711 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 41.1146ms
2025-04-01 15:44:27.935 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 15:44:27.963 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 15:44:27.967 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 15:44:27.969 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:44:27.974 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:44:28.061 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:44:28.064 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:44:28.090 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 15:44:28.091 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 15:44:28.092 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 15:44:28.092 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 15:44:28.092 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 15:44:28.093 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 15:44:28.094 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:44:28.161 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:44:28.163 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:44:28.168 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:44:28.174 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 15:44:28.177 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 15:44:28.224 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 15:44:28.224 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:44:28.225 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:44:28.225 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:44:28.243 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:44:28.245 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:44:28.245 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:44:28.246 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:44:28.246 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:44:28.249 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 15:44:28.261 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 15:44:28.282 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 15:44:28.295 +04:00 DBG Creating DbConnection.
2025-04-01 15:44:28.295 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:44:28.295 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:28.296 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:28.296 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:44:28.296 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:44:28.301 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-04-01 15:44:28.306 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:44:28.332 +04:00 INF Executed DbCommand (31ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:44:28.390 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 15:44:28.424 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:28.424 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 91ms reading results.
2025-04-01 15:44:28.425 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:44:28.425 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:47:22.831 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:47:22.968 +04:00 INF starting web host
2025-04-01 15:47:23.121 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:47:24.054 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:47:24.057 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:47:24.251 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:47:24.583 +04:00 DBG Creating DbConnection.
2025-04-01 15:47:24.635 +04:00 DBG Created DbConnection. (50ms).
2025-04-01 15:47:24.637 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:24.648 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:24.979 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:24.983 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:47:24.991 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:47:24.993 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-04-01 15:47:24.998 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:47:25.034 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:47:25.036 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.046 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-04-01 15:47:25.046 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.047 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.048 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:47:25.050 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:47:25.051 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:47:25.051 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:47:25.051 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:47:25.074 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:47:25.159 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:47:25.168 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:47:25.169 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:47:25.169 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:47:25.171 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:47:25.172 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:47:25.176 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:47:25.178 +04:00 DBG Committing transaction.
2025-04-01 15:47:25.182 +04:00 DBG Committed transaction.
2025-04-01 15:47:25.183 +04:00 DBG Disposing transaction.
2025-04-01 15:47:25.185 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:47:25.186 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:47:25.188 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:47:25.188 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:47:25.188 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:47:25.189 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:47:25.193 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:47:25.193 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:47:25.194 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:47:25.194 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:47:25.194 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:47:25.195 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:47:25.197 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:47:25.197 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:47:25.197 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:47:25.198 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:47:25.202 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:47:25.208 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.211 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-04-01 15:47:25.217 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:47:25.218 +04:00 DBG Committing transaction.
2025-04-01 15:47:25.218 +04:00 DBG Committed transaction.
2025-04-01 15:47:25.219 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:47:25.219 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:47:25.219 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:47:25.219 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:47:25.226 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:47:25.226 +04:00 DBG Disposing transaction.
2025-04-01 15:47:25.226 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.227 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:47:25.333 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:47:25.642 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:47:25.681 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.682 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.682 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:47:25.682 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:47:25.682 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:47:25.682 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:47:25.685 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:47:25.688 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.688 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:47:25.688 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.688 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:47:25.692 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:47:25.694 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.695 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:47:25.700 +04:00 DBG Hosting starting
2025-04-01 15:47:25.720 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:47:25.736 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:47:25.747 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:47:25.757 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:47:25.761 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:47:25.761 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:47:25.763 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:47:25.765 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:47:25.766 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:47:25.768 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:47:25.769 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:47:25.832 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:47:25.853 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:47:25.958 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:47:25.975 +04:00 DBG Creating DbConnection.
2025-04-01 15:47:25.975 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:47:25.977 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.980 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:25.980 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:47:25.980 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:47:25.980 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:47:25.981 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:47:26.017 +04:00 INF Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:47:26.032 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:26.033 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 15ms reading results.
2025-04-01 15:47:26.044 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:26.045 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (8ms).
2025-04-01 15:47:26.046 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:47:26.046 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:47:26.046 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:47:26.133 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 15:47:26.134 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 15:47:26.134 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 15:47:26.134 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 15:47:26.200 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 15:47:26.412 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 15:47:26.428 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 15:47:26.428 +04:00 INF Hosting environment: Development
2025-04-01 15:47:26.428 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 15:47:26.428 +04:00 DBG Hosting started
2025-04-01 15:47:26.465 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 15:47:26.466 +04:00 DBG Request did not match any endpoints
2025-04-01 15:47:26.614 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 15:47:26.616 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 15:47:26.698 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 15:47:26.699 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 15:47:26.798 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 15:47:26.803 +04:00 DBG Connection ID "17942340917054668838" disconnecting.
2025-04-01 15:47:26.804 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 595.2526ms
2025-04-01 15:47:26.811 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 15:47:26.821 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 8.3036ms
2025-04-01 15:47:26.828 +04:00 DBG Connection ID "17942340925644603395" disconnecting.
2025-04-01 15:47:27.079 +04:00 DBG Connection ID "17798225737568747521" disconnecting.
2025-04-01 15:47:27.092 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 293.9458ms
2025-04-01 15:47:27.200 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 15:47:27.201 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 15:47:27.201 +04:00 DBG Request did not match any endpoints
2025-04-01 15:47:27.267 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 66.8495ms
2025-04-01 15:48:03.167 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 15:48:03.229 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 15:48:03.234 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 15:48:03.235 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:48:03.240 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:48:03.329 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:48:03.333 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:48:03.381 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 15:48:03.383 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 15:48:03.383 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 15:48:03.384 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 15:48:03.385 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 15:48:03.387 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 15:48:03.390 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:48:03.460 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:48:03.462 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:48:03.467 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:48:03.474 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 15:48:03.477 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 15:48:03.501 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 15:48:03.502 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:48:03.503 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:48:03.504 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:48:03.515 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:48:03.517 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:48:03.518 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:48:03.520 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:48:03.522 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:48:03.526 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 15:48:03.532 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 15:48:03.549 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 15:48:03.563 +04:00 DBG Creating DbConnection.
2025-04-01 15:48:03.563 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:48:03.564 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:48:03.564 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:48:03.564 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:48:03.565 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:48:03.574 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (9ms).
2025-04-01 15:48:03.578 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:48:03.617 +04:00 INF Executed DbCommand (42ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:48:03.670 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 15:48:03.698 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:48:03.698 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 80ms reading results.
2025-04-01 15:48:03.698 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:48:03.698 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:48:14.551 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 15:48:14.554 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 15:48:14.554 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 15:48:14.554 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 15:48:14.556 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 15:48:14.557 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 15:48:14.635 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 11244.2619ms
2025-04-01 15:48:14.635 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:48:14.638 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:48:14.638 +04:00 DBG Connection ID "18302628900129210388" disconnecting.
2025-04-01 15:48:14.638 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:48:14.638 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:48:14.640 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 11472.7522ms
2025-04-01 15:50:23.754 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 21
2025-04-01 15:50:23.781 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 15:50:23.782 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 15:50:23.783 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 15:50:23.783 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:50:23.795 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:50:23.803 +04:00 DBG Policy authentication schemes  did not succeed
2025-04-01 15:50:23.811 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:50:23.817 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-04-01 15:50:23.818 +04:00 DBG Connection ID "18158513712053354513" disconnecting.
2025-04-01 15:50:23.818 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 401 null null 68.2763ms
2025-04-01 15:52:26.065 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:52:26.086 +04:00 DBG Creating DbConnection.
2025-04-01 15:52:26.086 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:52:26.086 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:52:26.086 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:52:26.086 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:52:26.087 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:52:26.087 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:52:26.087 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:52:26.095 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:52:26.096 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:52:26.096 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 15:52:26.097 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:52:26.097 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:52:26.097 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:52:26.098 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:52:26.099 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:52:41.557 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 21
2025-04-01 15:52:41.588 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 15:52:41.589 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 15:52:41.589 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 15:52:41.589 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:52:41.594 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:52:41.599 +04:00 DBG Policy authentication schemes  did not succeed
2025-04-01 15:52:41.600 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:52:41.600 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-04-01 15:52:41.602 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 401 null null 45.1222ms
2025-04-01 15:52:42.770 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 21
2025-04-01 15:52:42.770 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 15:52:42.770 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 15:52:42.771 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 15:52:42.771 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:52:42.771 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:52:42.773 +04:00 DBG Policy authentication schemes  did not succeed
2025-04-01 15:52:42.773 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:52:42.774 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-04-01 15:52:42.775 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 401 null null 5.4243ms
2025-04-01 15:52:43.444 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 21
2025-04-01 15:52:43.444 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 15:52:43.444 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 15:52:43.444 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 15:52:43.445 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:52:43.445 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:52:43.445 +04:00 DBG Policy authentication schemes  did not succeed
2025-04-01 15:52:43.446 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:52:43.446 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-04-01 15:52:43.446 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 401 null null 2.2474ms
2025-04-01 15:53:26.730 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:53:26.901 +04:00 INF starting web host
2025-04-01 15:53:27.083 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:53:27.924 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:53:27.926 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:53:28.005 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:53:28.208 +04:00 DBG Creating DbConnection.
2025-04-01 15:53:28.253 +04:00 DBG Created DbConnection. (42ms).
2025-04-01 15:53:28.254 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:28.271 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:28.723 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:28.727 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:53:28.733 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 15:53:28.735 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 15:53:28.740 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:53:28.768 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:53:28.770 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:28.779 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:53:28.779 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:28.780 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:28.781 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:53:28.783 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:53:28.784 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:53:28.784 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:53:28.784 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:53:28.810 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:53:28.942 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:53:28.953 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:53:28.955 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:53:28.955 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:53:28.956 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:53:28.956 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:53:28.965 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:53:28.967 +04:00 DBG Committing transaction.
2025-04-01 15:53:28.972 +04:00 DBG Committed transaction.
2025-04-01 15:53:28.974 +04:00 DBG Disposing transaction.
2025-04-01 15:53:28.978 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:53:28.978 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:53:28.980 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:53:28.980 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:53:28.981 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:53:28.981 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:53:28.981 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:53:28.982 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:53:28.982 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:53:28.982 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:53:28.982 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:53:28.983 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:53:28.985 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:53:28.985 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:53:28.986 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:53:28.986 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:53:28.990 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:53:28.993 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:28.994 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:53:28.999 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:53:28.999 +04:00 DBG Committing transaction.
2025-04-01 15:53:28.999 +04:00 DBG Committed transaction.
2025-04-01 15:53:29.000 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:53:29.000 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:53:29.000 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:53:29.000 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:53:29.003 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:53:29.003 +04:00 DBG Disposing transaction.
2025-04-01 15:53:29.003 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.004 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:53:29.065 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:53:29.397 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:53:29.474 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.475 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.475 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:53:29.475 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:53:29.476 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:53:29.476 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:53:29.482 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:53:29.485 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.485 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 15:53:29.485 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.486 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:53:29.487 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:53:29.491 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.492 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:53:29.499 +04:00 DBG Hosting starting
2025-04-01 15:53:29.520 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:53:29.541 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:53:29.553 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:53:29.565 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:53:29.569 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:53:29.570 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:53:29.571 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:53:29.573 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:53:29.574 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:53:29.578 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:53:29.579 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:53:29.615 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:53:29.633 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:53:29.726 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:53:29.743 +04:00 DBG Creating DbConnection.
2025-04-01 15:53:29.744 +04:00 DBG Created DbConnection. (1ms).
2025-04-01 15:53:29.748 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.751 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.751 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:53:29.752 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:53:29.752 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:53:29.753 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:53:29.784 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:53:29.796 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.797 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 12ms reading results.
2025-04-01 15:53:29.799 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.802 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:53:29.806 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:53:29.806 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:53:29.806 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:53:29.883 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 15:53:29.883 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 15:53:29.883 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 15:53:29.884 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 15:53:29.950 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 15:53:30.173 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 15:53:30.173 +04:00 INF Hosting environment: Development
2025-04-01 15:53:30.174 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 15:53:30.174 +04:00 DBG Hosting started
2025-04-01 15:53:30.177 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 15:53:30.239 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 15:53:30.240 +04:00 DBG Request did not match any endpoints
2025-04-01 15:53:30.348 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 15:53:30.351 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 15:53:30.442 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 15:53:30.444 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 15:53:30.533 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 522.3977ms
2025-04-01 15:53:30.572 +04:00 DBG Connection ID "18374686485577203745" disconnecting.
2025-04-01 15:53:30.580 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 15:53:30.588 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 8.6722ms
2025-04-01 15:53:30.590 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 15:53:30.702 +04:00 DBG Connection ID "18158513703463419942" disconnecting.
2025-04-01 15:53:30.703 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 113.4611ms
2025-04-01 15:53:30.798 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 15:53:30.798 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 15:53:30.799 +04:00 DBG Request did not match any endpoints
2025-04-01 15:53:30.862 +04:00 DBG Connection ID "17798225728978812929" disconnecting.
2025-04-01 15:53:30.862 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 64.0528ms
2025-04-01 15:54:38.028 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 15:54:38.091 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 15:54:38.098 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 15:54:38.100 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:54:38.108 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:54:38.188 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 15:54:38.191 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:54:38.217 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 15:54:38.218 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 15:54:38.219 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 15:54:38.221 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 15:54:38.222 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 15:54:38.222 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 15:54:38.225 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:54:38.295 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:54:38.297 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 15:54:38.301 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:54:38.306 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 15:54:38.310 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 15:54:38.347 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 15:54:38.348 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:54:38.348 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:54:38.348 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 15:54:38.360 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 15:54:38.362 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:54:38.362 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:54:38.362 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 15:54:38.363 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 15:54:38.368 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 15:54:38.376 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 15:54:38.391 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 15:54:38.401 +04:00 DBG Creating DbConnection.
2025-04-01 15:54:38.402 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:54:38.402 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:54:38.402 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:54:38.403 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:54:38.403 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:54:38.408 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-04-01 15:54:38.411 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:54:38.446 +04:00 INF Executed DbCommand (37ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 15:54:38.490 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 15:54:38.512 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:54:38.512 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 66ms reading results.
2025-04-01 15:54:38.513 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:54:38.513 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:54:57.707 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 15:54:57.709 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 15:54:57.709 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 15:54:57.709 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 15:54:57.710 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 15:54:57.711 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 15:54:57.822 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 19594.7329ms
2025-04-01 15:54:57.823 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 15:54:57.827 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:54:57.827 +04:00 DBG Connection ID "18230571306091282449" disconnecting.
2025-04-01 15:54:57.827 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:54:57.827 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:54:57.829 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 19800.9879ms
2025-04-01 15:56:51.199 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 19
2025-04-01 15:56:51.201 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 15:56:51.202 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 15:56:51.202 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 15:56:51.203 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:56:51.271 +04:00 DBG Successfully validated the token.
2025-04-01 15:56:51.273 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 15:56:51.281 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:56:51.284 +04:00 INF AuthenticationScheme: Bearer was forbidden.
2025-04-01 15:56:51.286 +04:00 DBG Connection ID "17870283323016740870" disconnecting.
2025-04-01 15:56:51.286 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 403 null null 87.1598ms
2025-04-01 15:57:33.908 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 15:57:33.909 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 15:57:33.910 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 15:57:33.911 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 15:57:33.912 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:57:33.916 +04:00 DBG Successfully validated the token.
2025-04-01 15:57:33.916 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 15:57:33.929 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:57:33.931 +04:00 INF AuthenticationScheme: Bearer was forbidden.
2025-04-01 15:57:33.934 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 403 null null 25.9932ms
2025-04-01 15:57:33.934 +04:00 DBG Connection ID "17870283323016740872" disconnecting.
2025-04-01 15:58:29.838 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:58:29.859 +04:00 DBG Creating DbConnection.
2025-04-01 15:58:29.860 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:58:29.860 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:58:29.860 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:58:29.860 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:58:29.860 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:58:29.860 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:58:29.861 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:58:29.875 +04:00 INF Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:58:29.875 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:58:29.876 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 15:58:29.876 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:58:29.876 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:58:29.876 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:58:29.876 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:58:29.876 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:58:38.908 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 19
2025-04-01 15:58:38.909 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 15:58:38.910 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 15:58:38.910 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 15:58:38.910 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:58:38.911 +04:00 DBG Successfully validated the token.
2025-04-01 15:58:38.911 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 15:58:38.914 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:58:38.914 +04:00 INF AuthenticationScheme: Bearer was forbidden.
2025-04-01 15:58:38.917 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 403 null null 9.2172ms
2025-04-01 15:58:45.603 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 15:58:45.603 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 15:58:45.603 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 15:58:45.603 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 15:58:45.603 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 15:58:45.604 +04:00 DBG Successfully validated the token.
2025-04-01 15:58:45.604 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 15:58:45.604 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 15:58:45.604 +04:00 INF AuthenticationScheme: Bearer was forbidden.
2025-04-01 15:58:45.605 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 403 null null 2.4238ms
2025-04-01 15:59:44.168 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 15:59:44.309 +04:00 INF starting web host
2025-04-01 15:59:44.508 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 15:59:45.776 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:59:45.781 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 15:59:45.858 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:59:46.009 +04:00 DBG Creating DbConnection.
2025-04-01 15:59:46.060 +04:00 DBG Created DbConnection. (47ms).
2025-04-01 15:59:46.067 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.086 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.428 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.433 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:59:46.442 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-04-01 15:59:46.445 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-04-01 15:59:46.454 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:59:46.489 +04:00 INF Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:59:46.491 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.499 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 15:59:46.499 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.501 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.502 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 15:59:46.505 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:59:46.505 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:59:46.505 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:59:46.506 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:59:46.526 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 15:59:46.593 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:59:46.602 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:59:46.603 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:59:46.603 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:59:46.604 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 15:59:46.605 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:59:46.613 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 15:59:46.615 +04:00 DBG Committing transaction.
2025-04-01 15:59:46.620 +04:00 DBG Committed transaction.
2025-04-01 15:59:46.621 +04:00 DBG Disposing transaction.
2025-04-01 15:59:46.625 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 15:59:46.625 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 15:59:46.628 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 15:59:46.629 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:59:46.629 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 15:59:46.629 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:59:46.630 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 15:59:46.631 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:59:46.631 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:59:46.631 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:59:46.631 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:59:46.633 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 15:59:46.636 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:59:46.636 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:59:46.637 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:59:46.638 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:59:46.646 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 15:59:46.650 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.651 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 15:59:46.664 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 15:59:46.666 +04:00 DBG Committing transaction.
2025-04-01 15:59:46.666 +04:00 DBG Committed transaction.
2025-04-01 15:59:46.667 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 15:59:46.667 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:59:46.667 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 15:59:46.667 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:59:46.670 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 15:59:46.671 +04:00 DBG Disposing transaction.
2025-04-01 15:59:46.671 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:46.672 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:59:46.774 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 15:59:47.050 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 15:59:47.108 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.109 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.109 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:59:47.109 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:59:47.109 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:59:47.109 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:59:47.117 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 15:59:47.120 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.120 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 15:59:47.120 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.120 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:59:47.122 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:59:47.125 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.127 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 15:59:47.136 +04:00 DBG Hosting starting
2025-04-01 15:59:47.171 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 15:59:47.204 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 15:59:47.216 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 15:59:47.226 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 15:59:47.232 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:59:47.233 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 15:59:47.236 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 15:59:47.238 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 15:59:47.240 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 15:59:47.242 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 15:59:47.244 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 15:59:47.280 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 15:59:47.300 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 15:59:47.387 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 15:59:47.407 +04:00 DBG Creating DbConnection.
2025-04-01 15:59:47.408 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 15:59:47.410 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.415 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.415 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 15:59:47.416 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:59:47.416 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 15:59:47.416 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:59:47.441 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 15:59:47.455 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.456 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-04-01 15:59:47.458 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.459 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 15:59:47.460 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 15:59:47.460 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 15:59:47.460 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 15:59:47.576 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 15:59:47.576 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 15:59:47.576 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 15:59:47.576 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 15:59:47.640 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 15:59:47.857 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 15:59:47.859 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 15:59:47.860 +04:00 INF Hosting environment: Development
2025-04-01 15:59:47.860 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 15:59:47.860 +04:00 DBG Hosting started
2025-04-01 15:59:47.894 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 15:59:47.895 +04:00 DBG Request did not match any endpoints
2025-04-01 15:59:48.030 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 15:59:48.033 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 15:59:48.100 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 15:59:48.100 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 15:59:48.113 +04:00 DBG Connection ID "18158513703463419947" disconnecting.
2025-04-01 15:59:48.117 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 490.5265ms
2025-04-01 15:59:48.152 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 15:59:48.167 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 14.4219ms
2025-04-01 15:59:48.168 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 15:59:48.276 +04:00 DBG Connection ID "18374686485577203751" disconnecting.
2025-04-01 15:59:48.278 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 109.1732ms
2025-04-01 15:59:48.369 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 15:59:48.369 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 15:59:48.370 +04:00 DBG Request did not match any endpoints
2025-04-01 15:59:48.408 +04:00 DBG Connection ID "17870283323016740874" disconnecting.
2025-04-01 15:59:48.408 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.4419ms
2025-04-01 16:00:18.743 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 16:00:18.779 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 16:00:18.783 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 16:00:18.784 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:00:18.787 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:00:18.852 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 16:00:18.854 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:00:18.883 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 16:00:18.885 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:00:18.886 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:00:18.886 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:00:18.887 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:00:18.887 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:00:18.889 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:00:18.976 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:00:18.978 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:00:18.983 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:00:18.986 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 16:00:18.989 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 16:00:19.015 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 16:00:19.015 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:00:19.016 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:00:19.016 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:00:19.023 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:00:19.026 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:00:19.027 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:00:19.027 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:00:19.027 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:00:19.031 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 16:00:19.037 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 16:00:19.052 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 16:00:19.066 +04:00 DBG Creating DbConnection.
2025-04-01 16:00:19.066 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:00:19.066 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:00:19.067 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:00:19.067 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:00:19.067 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:00:19.070 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (3ms).
2025-04-01 16:00:19.073 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:00:19.102 +04:00 INF Executed DbCommand (32ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:00:19.183 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:00:19.221 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:00:19.221 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 118ms reading results.
2025-04-01 16:00:19.222 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:00:19.222 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:00:24.219 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 16:00:24.221 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 16:00:24.221 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 16:00:24.222 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 16:00:24.223 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 16:00:24.224 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 16:00:24.328 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 5435.0935ms
2025-04-01 16:00:24.329 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:00:24.333 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:00:24.334 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:00:24.334 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:00:24.335 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 5592.9876ms
2025-04-01 16:00:58.277 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:00:58.280 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:00:58.280 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:00:58.280 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:00:58.280 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:00:58.359 +04:00 DBG Successfully validated the token.
2025-04-01 16:00:58.361 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:00:58.375 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 16:00:58.379 +04:00 INF AuthenticationScheme: Bearer was forbidden.
2025-04-01 16:00:58.381 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 403 null null 103.5043ms
2025-04-01 16:00:58.381 +04:00 DBG Connection ID "18374686489872171059" disconnecting.
2025-04-01 16:07:08.098 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 16:07:08.270 +04:00 INF starting web host
2025-04-01 16:07:08.550 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 16:07:09.420 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:07:09.421 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:07:09.512 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:07:09.701 +04:00 DBG Creating DbConnection.
2025-04-01 16:07:09.762 +04:00 DBG Created DbConnection. (55ms).
2025-04-01 16:07:09.764 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:09.780 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.134 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.137 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:07:10.145 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 16:07:10.147 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-04-01 16:07:10.152 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:07:10.185 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:07:10.188 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.206 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (13ms).
2025-04-01 16:07:10.206 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.209 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.210 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 16:07:10.213 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:07:10.213 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:07:10.213 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:07:10.214 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:07:10.240 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:07:10.377 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:07:10.387 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:07:10.389 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:07:10.389 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:07:10.393 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (4ms).
2025-04-01 16:07:10.394 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:07:10.400 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:07:10.403 +04:00 DBG Committing transaction.
2025-04-01 16:07:10.407 +04:00 DBG Committed transaction.
2025-04-01 16:07:10.410 +04:00 DBG Disposing transaction.
2025-04-01 16:07:10.413 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:07:10.414 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:07:10.415 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:07:10.416 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:07:10.416 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:07:10.416 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:07:10.417 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:07:10.417 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:07:10.417 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:07:10.418 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:07:10.418 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:07:10.419 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:07:10.421 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:07:10.421 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:07:10.421 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:07:10.422 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:07:10.428 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:07:10.431 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.432 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:07:10.437 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 16:07:10.438 +04:00 DBG Committing transaction.
2025-04-01 16:07:10.438 +04:00 DBG Committed transaction.
2025-04-01 16:07:10.439 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:07:10.439 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:07:10.439 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:07:10.439 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:07:10.447 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:07:10.447 +04:00 DBG Disposing transaction.
2025-04-01 16:07:10.447 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.448 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:07:10.534 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 16:07:10.888 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 16:07:10.932 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.932 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.932 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:07:10.932 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:07:10.932 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:07:10.933 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:07:10.937 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:07:10.940 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.940 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:07:10.940 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.940 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:07:10.943 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:07:10.945 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:10.946 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 16:07:10.950 +04:00 DBG Hosting starting
2025-04-01 16:07:10.970 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 16:07:10.987 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 16:07:10.998 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 16:07:11.007 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 16:07:11.012 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:07:11.013 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 16:07:11.016 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:07:11.017 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 16:07:11.019 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 16:07:11.020 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 16:07:11.022 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 16:07:11.073 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:07:11.093 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 16:07:11.187 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 16:07:11.217 +04:00 DBG Creating DbConnection.
2025-04-01 16:07:11.217 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:07:11.220 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:11.224 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:11.225 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:07:11.225 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:07:11.225 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:07:11.226 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:07:11.262 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:07:11.285 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:11.287 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 24ms reading results.
2025-04-01 16:07:11.300 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:11.301 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:07:11.302 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:07:11.302 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:11.302 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:07:11.387 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 16:07:11.387 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 16:07:11.387 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 16:07:11.387 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 16:07:11.465 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 16:07:11.629 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 16:07:11.649 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 16:07:11.649 +04:00 INF Hosting environment: Development
2025-04-01 16:07:11.649 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 16:07:11.650 +04:00 DBG Hosting started
2025-04-01 16:07:11.681 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 16:07:11.682 +04:00 DBG Request did not match any endpoints
2025-04-01 16:07:11.830 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 16:07:11.832 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 16:07:11.917 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 16:07:11.918 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 16:07:11.935 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 491.4277ms
2025-04-01 16:07:12.000 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 16:07:12.034 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 16:07:12.059 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 20.2445ms
2025-04-01 16:07:12.143 +04:00 DBG Connection ID "18158513703463419955" disconnecting.
2025-04-01 16:07:12.145 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 144.8672ms
2025-04-01 16:07:12.231 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 16:07:12.232 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 16:07:12.232 +04:00 DBG Request did not match any endpoints
2025-04-01 16:07:12.268 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 37.0599ms
2025-04-01 16:07:34.464 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 16:07:34.498 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 16:07:34.502 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 16:07:34.503 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:07:34.509 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:07:34.603 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 16:07:34.608 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:07:34.646 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 16:07:34.648 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:07:34.649 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:07:34.650 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:07:34.650 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:07:34.650 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:07:34.653 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:07:34.745 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:07:34.746 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:07:34.751 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:07:34.755 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 16:07:34.760 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 16:07:34.786 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 16:07:34.786 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:07:34.787 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:07:34.787 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:07:34.798 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:07:34.799 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:07:34.800 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:07:34.800 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:07:34.800 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:07:34.803 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 16:07:34.812 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 16:07:34.826 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 16:07:34.837 +04:00 DBG Creating DbConnection.
2025-04-01 16:07:34.837 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:07:34.837 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:34.838 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:34.838 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:07:34.838 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:07:34.844 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (6ms).
2025-04-01 16:07:34.846 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:07:34.871 +04:00 INF Executed DbCommand (26ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:07:34.945 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:07:34.997 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:34.997 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 125ms reading results.
2025-04-01 16:07:34.998 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:34.998 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:07:35.143 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 16:07:35.145 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 16:07:35.145 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 16:07:35.146 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 16:07:35.147 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 16:07:35.147 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 16:07:35.167 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 510.3033ms
2025-04-01 16:07:35.168 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:07:35.173 +04:00 DBG Connection ID "17798225737568747528" disconnecting.
2025-04-01 16:07:35.173 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:07:35.174 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:07:35.174 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:07:35.176 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 712.2177ms
2025-04-01 16:08:08.141 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:08:08.144 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:08:08.144 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:08:08.145 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:08:08.146 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:08:08.216 +04:00 DBG Successfully validated the token.
2025-04-01 16:08:08.219 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:08:08.226 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 16:08:08.229 +04:00 INF AuthenticationScheme: Bearer was forbidden.
2025-04-01 16:08:08.231 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 403 null null 90.1569ms
2025-04-01 16:12:13.013 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 16:12:13.150 +04:00 INF starting web host
2025-04-01 16:12:13.307 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 16:12:14.166 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:12:14.169 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:12:14.310 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:12:14.467 +04:00 DBG Creating DbConnection.
2025-04-01 16:12:14.508 +04:00 DBG Created DbConnection. (38ms).
2025-04-01 16:12:14.510 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:14.525 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:14.826 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:14.831 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:12:14.839 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-04-01 16:12:14.841 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (11ms).
2025-04-01 16:12:14.848 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:12:14.890 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:12:14.893 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:14.906 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-04-01 16:12:14.906 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:14.907 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:14.909 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 16:12:14.911 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:12:14.911 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:12:14.912 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:12:14.912 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:12:14.940 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:12:15.013 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:12:15.019 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:12:15.021 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:12:15.021 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:12:15.022 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 16:12:15.022 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:12:15.025 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:12:15.027 +04:00 DBG Committing transaction.
2025-04-01 16:12:15.030 +04:00 DBG Committed transaction.
2025-04-01 16:12:15.034 +04:00 DBG Disposing transaction.
2025-04-01 16:12:15.035 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:12:15.036 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:12:15.037 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:12:15.037 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:12:15.037 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:12:15.037 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:12:15.038 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:12:15.038 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:12:15.039 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:12:15.039 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:12:15.039 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:12:15.039 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:12:15.041 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:12:15.041 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:12:15.041 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:12:15.042 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:12:15.045 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:12:15.051 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.053 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-04-01 16:12:15.057 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 16:12:15.058 +04:00 DBG Committing transaction.
2025-04-01 16:12:15.058 +04:00 DBG Committed transaction.
2025-04-01 16:12:15.058 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:12:15.058 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:12:15.059 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:12:15.059 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:12:15.062 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:12:15.062 +04:00 DBG Disposing transaction.
2025-04-01 16:12:15.062 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.063 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:12:15.137 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 16:12:15.371 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 16:12:15.411 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.411 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.411 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:12:15.411 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:12:15.411 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:12:15.412 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:12:15.417 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:12:15.420 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.420 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:12:15.420 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.420 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:12:15.422 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:12:15.424 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.425 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 16:12:15.429 +04:00 DBG Hosting starting
2025-04-01 16:12:15.454 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 16:12:15.470 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 16:12:15.476 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 16:12:15.485 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 16:12:15.489 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:12:15.490 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 16:12:15.492 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:12:15.493 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 16:12:15.494 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 16:12:15.497 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 16:12:15.500 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 16:12:15.548 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:12:15.560 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 16:12:15.622 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 16:12:15.642 +04:00 DBG Creating DbConnection.
2025-04-01 16:12:15.643 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:12:15.644 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.648 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.650 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:12:15.651 +04:00 DBG Created DbCommand for 'ExecuteReader' (1ms).
2025-04-01 16:12:15.653 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-04-01 16:12:15.654 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:12:15.670 +04:00 INF Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:12:15.681 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.682 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-04-01 16:12:15.684 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.684 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:12:15.685 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:12:15.685 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:12:15.686 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:12:15.772 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 16:12:15.773 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 16:12:15.773 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 16:12:15.773 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 16:12:15.827 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 16:12:15.990 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 16:12:16.022 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 16:12:16.023 +04:00 DBG Request did not match any endpoints
2025-04-01 16:12:16.129 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 16:12:16.134 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 16:12:16.196 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 16:12:16.196 +04:00 INF Hosting environment: Development
2025-04-01 16:12:16.196 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 16:12:16.197 +04:00 DBG Hosting started
2025-04-01 16:12:16.205 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 16:12:16.206 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 16:12:16.227 +04:00 DBG Connection ID "18374686489872171062" disconnecting.
2025-04-01 16:12:16.227 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 397.4412ms
2025-04-01 16:12:16.255 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 16:12:16.269 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 12.1796ms
2025-04-01 16:12:16.272 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 16:12:16.375 +04:00 DBG Connection ID "17942340917054668854" disconnecting.
2025-04-01 16:12:16.386 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 114.5251ms
2025-04-01 16:12:16.462 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 16:12:16.462 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 16:12:16.462 +04:00 DBG Request did not match any endpoints
2025-04-01 16:12:16.510 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 48.0314ms
2025-04-01 16:12:52.651 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:12:52.676 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:12:52.684 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:12:52.686 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:12:52.691 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:12:52.840 +04:00 DBG Successfully validated the token.
2025-04-01 16:12:52.842 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:12:52.851 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 16:12:52.853 +04:00 INF AuthenticationScheme: Bearer was forbidden.
2025-04-01 16:12:52.855 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 403 null null 203.3769ms
2025-04-01 16:12:52.859 +04:00 DBG Connection ID "17942340925644603407" disconnecting.
2025-04-01 16:15:02.741 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 16:15:02.860 +04:00 INF starting web host
2025-04-01 16:15:03.090 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 16:15:04.021 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:15:04.022 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:15:04.103 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:15:04.320 +04:00 DBG Creating DbConnection.
2025-04-01 16:15:04.363 +04:00 DBG Created DbConnection. (42ms).
2025-04-01 16:15:04.365 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.376 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.704 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.709 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:15:04.715 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 16:15:04.718 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 16:15:04.724 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:15:04.757 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:15:04.759 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.769 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-04-01 16:15:04.769 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.771 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.772 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 16:15:04.775 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:15:04.775 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:15:04.775 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:15:04.776 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:15:04.805 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:15:04.912 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:15:04.922 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:15:04.923 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:15:04.923 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:15:04.924 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 16:15:04.924 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:15:04.928 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:15:04.930 +04:00 DBG Committing transaction.
2025-04-01 16:15:04.938 +04:00 DBG Committed transaction.
2025-04-01 16:15:04.940 +04:00 DBG Disposing transaction.
2025-04-01 16:15:04.942 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:15:04.943 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:15:04.945 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:15:04.945 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:15:04.945 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:15:04.945 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:15:04.946 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:15:04.946 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:15:04.947 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:15:04.947 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:15:04.947 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:15:04.948 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:15:04.952 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:15:04.952 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:15:04.952 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:15:04.953 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:15:04.958 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:15:04.961 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.962 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:15:04.969 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 16:15:04.970 +04:00 DBG Committing transaction.
2025-04-01 16:15:04.970 +04:00 DBG Committed transaction.
2025-04-01 16:15:04.971 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:15:04.971 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:15:04.971 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:15:04.971 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:15:04.974 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:15:04.975 +04:00 DBG Disposing transaction.
2025-04-01 16:15:04.975 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:04.975 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:15:05.061 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 16:15:05.365 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 16:15:05.428 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.428 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.428 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:15:05.428 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:15:05.428 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:15:05.429 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:15:05.434 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:15:05.437 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.437 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:15:05.437 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.437 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:15:05.439 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:15:05.440 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.441 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:15:05.445 +04:00 DBG Hosting starting
2025-04-01 16:15:05.471 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 16:15:05.488 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 16:15:05.497 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 16:15:05.514 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 16:15:05.520 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:15:05.521 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 16:15:05.523 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:15:05.525 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 16:15:05.526 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 16:15:05.528 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 16:15:05.529 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 16:15:05.584 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:15:05.598 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 16:15:05.698 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 16:15:05.717 +04:00 DBG Creating DbConnection.
2025-04-01 16:15:05.719 +04:00 DBG Created DbConnection. (1ms).
2025-04-01 16:15:05.722 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.725 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.725 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:15:05.726 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:15:05.726 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:15:05.726 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:15:05.756 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:15:05.767 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.768 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-04-01 16:15:05.775 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.776 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-04-01 16:15:05.777 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:15:05.777 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:15:05.777 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:15:05.854 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 16:15:05.857 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 16:15:05.857 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 16:15:05.858 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 16:15:05.929 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 16:15:06.100 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 16:15:06.112 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 16:15:06.112 +04:00 INF Hosting environment: Development
2025-04-01 16:15:06.112 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 16:15:06.112 +04:00 DBG Hosting started
2025-04-01 16:15:06.138 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 16:15:06.139 +04:00 DBG Request did not match any endpoints
2025-04-01 16:15:06.277 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 16:15:06.280 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 16:15:06.356 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 16:15:06.356 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 16:15:06.390 +04:00 DBG Connection ID "18158513712053354519" disconnecting.
2025-04-01 16:15:06.393 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 480.4282ms
2025-04-01 16:15:06.405 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 16:15:06.412 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 16:15:06.413 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 7.526ms
2025-04-01 16:15:06.532 +04:00 DBG Connection ID "18158513703463419961" disconnecting.
2025-04-01 16:15:06.545 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 132.6263ms
2025-04-01 16:15:06.613 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 16:15:06.614 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 16:15:06.614 +04:00 DBG Request did not match any endpoints
2025-04-01 16:15:06.643 +04:00 DBG Connection ID "18230571306091282451" disconnecting.
2025-04-01 16:15:06.644 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.2088ms
2025-04-01 16:18:05.496 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 16:18:05.641 +04:00 INF starting web host
2025-04-01 16:18:05.794 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 16:18:06.835 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:18:06.837 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:18:06.913 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:18:07.149 +04:00 DBG Creating DbConnection.
2025-04-01 16:18:07.204 +04:00 DBG Created DbConnection. (50ms).
2025-04-01 16:18:07.206 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.216 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.529 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.535 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:18:07.546 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 16:18:07.548 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-04-01 16:18:07.554 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:18:07.578 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:18:07.580 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.596 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (9ms).
2025-04-01 16:18:07.596 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.598 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.599 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 16:18:07.606 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:18:07.606 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:18:07.606 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:18:07.607 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:18:07.632 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:18:07.747 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:18:07.757 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:18:07.758 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:18:07.759 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:18:07.760 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 16:18:07.761 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:18:07.768 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:18:07.772 +04:00 DBG Committing transaction.
2025-04-01 16:18:07.777 +04:00 DBG Committed transaction.
2025-04-01 16:18:07.779 +04:00 DBG Disposing transaction.
2025-04-01 16:18:07.781 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:18:07.781 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:18:07.784 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:18:07.784 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:18:07.785 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 16:18:07.786 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:18:07.789 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:18:07.789 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:18:07.789 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:18:07.790 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:18:07.790 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:18:07.791 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:18:07.793 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:18:07.793 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:18:07.793 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:18:07.793 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:18:07.797 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:18:07.800 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.803 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:18:07.809 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 16:18:07.809 +04:00 DBG Committing transaction.
2025-04-01 16:18:07.810 +04:00 DBG Committed transaction.
2025-04-01 16:18:07.810 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:18:07.810 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:18:07.810 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:18:07.810 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:18:07.815 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:18:07.815 +04:00 DBG Disposing transaction.
2025-04-01 16:18:07.815 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:07.816 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:18:07.896 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 16:18:08.279 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 16:18:08.344 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.344 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.344 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:18:08.344 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:18:08.345 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:18:08.345 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:18:08.351 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:18:08.354 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.354 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:18:08.354 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.355 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:18:08.356 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:18:08.359 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.360 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 16:18:08.365 +04:00 DBG Hosting starting
2025-04-01 16:18:08.391 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 16:18:08.407 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 16:18:08.417 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 16:18:08.427 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 16:18:08.432 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:18:08.434 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 16:18:08.436 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:18:08.438 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 16:18:08.440 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 16:18:08.442 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 16:18:08.444 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 16:18:08.485 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:18:08.506 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 16:18:08.597 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 16:18:08.624 +04:00 DBG Creating DbConnection.
2025-04-01 16:18:08.625 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:18:08.627 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.631 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.632 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:18:08.632 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:18:08.632 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:18:08.633 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:18:08.661 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:18:08.673 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.674 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 12ms reading results.
2025-04-01 16:18:08.677 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.678 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:18:08.686 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:18:08.686 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:18:08.687 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:18:08.756 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 16:18:08.756 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 16:18:08.756 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 16:18:08.756 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 16:18:08.829 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 16:18:09.005 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 16:18:09.028 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 16:18:09.028 +04:00 INF Hosting environment: Development
2025-04-01 16:18:09.028 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 16:18:09.028 +04:00 DBG Hosting started
2025-04-01 16:18:09.047 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 16:18:09.048 +04:00 DBG Request did not match any endpoints
2025-04-01 16:18:09.205 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 16:18:09.208 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 16:18:09.276 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 16:18:09.277 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 16:18:09.290 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 475.873ms
2025-04-01 16:18:09.337 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 16:18:09.342 +04:00 DBG Connection ID "18158513703463419963" disconnecting.
2025-04-01 16:18:09.345 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 16:18:09.360 +04:00 DBG Connection ID "18374686489872171066" disconnecting.
2025-04-01 16:18:09.360 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 11.1592ms
2025-04-01 16:18:09.457 +04:00 DBG Connection ID "17798225728978812935" disconnecting.
2025-04-01 16:18:09.463 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 126.0627ms
2025-04-01 16:18:09.526 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 16:18:09.527 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 16:18:09.527 +04:00 DBG Request did not match any endpoints
2025-04-01 16:18:09.562 +04:00 DBG Connection ID "18374686489872171068" disconnecting.
2025-04-01 16:18:09.563 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 36.4925ms
2025-04-01 16:19:17.681 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 16:19:17.719 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 16:19:17.724 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 16:19:17.726 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:19:17.733 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:19:17.837 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 16:19:17.841 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:19:17.870 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 16:19:17.872 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:19:17.872 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:19:17.873 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:19:17.873 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:19:17.873 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:19:17.876 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:19:17.941 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:19:17.943 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:19:17.954 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:19:17.958 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 16:19:17.964 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 16:19:17.998 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 16:19:17.999 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:19:18.000 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:19:18.000 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:19:18.020 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:19:18.023 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:19:18.024 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:19:18.024 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:19:18.025 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:19:18.035 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 16:19:18.043 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 16:19:18.068 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 16:19:18.082 +04:00 DBG Creating DbConnection.
2025-04-01 16:19:18.082 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:19:18.083 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:19:18.083 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:19:18.083 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:19:18.083 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:19:18.090 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (6ms).
2025-04-01 16:19:18.093 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:19:18.125 +04:00 INF Executed DbCommand (35ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:19:18.176 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:19:18.225 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:19:18.225 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 99ms reading results.
2025-04-01 16:19:18.226 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:19:18.226 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:19:18.388 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 16:19:18.390 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 16:19:18.390 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 16:19:18.390 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 16:19:18.392 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 16:19:18.392 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 16:19:18.408 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 531.5559ms
2025-04-01 16:19:18.409 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:19:18.412 +04:00 DBG Connection ID "18086456118015426577" disconnecting.
2025-04-01 16:19:18.412 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:19:18.414 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:19:18.414 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:19:18.416 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 735.2879ms
2025-04-01 16:19:45.404 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:19:45.411 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:19:45.412 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:19:45.413 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:19:45.413 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:19:45.487 +04:00 DBG Successfully validated the token.
2025-04-01 16:19:45.490 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:19:45.500 +04:00 DBG Authorization was successful.
2025-04-01 16:19:45.501 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:19:45.508 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 16:19:45.509 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:19:45.509 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:19:45.510 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:19:45.511 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:19:45.511 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:19:45.512 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:19:45.514 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:24:55.985 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 16:24:56.227 +04:00 INF starting web host
2025-04-01 16:24:56.407 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 16:24:57.225 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:24:57.226 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:24:57.337 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:24:57.505 +04:00 DBG Creating DbConnection.
2025-04-01 16:24:57.562 +04:00 DBG Created DbConnection. (55ms).
2025-04-01 16:24:57.564 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:57.578 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.014 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.023 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:24:58.029 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 16:24:58.030 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 16:24:58.041 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:24:58.071 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:24:58.073 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.080 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 16:24:58.081 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.084 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.087 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 16:24:58.089 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:24:58.090 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:24:58.090 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:24:58.090 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:24:58.112 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:24:58.204 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:24:58.210 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:24:58.211 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:24:58.211 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:24:58.212 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 16:24:58.212 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:24:58.221 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:24:58.223 +04:00 DBG Committing transaction.
2025-04-01 16:24:58.227 +04:00 DBG Committed transaction.
2025-04-01 16:24:58.229 +04:00 DBG Disposing transaction.
2025-04-01 16:24:58.234 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:24:58.234 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:24:58.236 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:24:58.236 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:24:58.236 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:24:58.236 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:24:58.237 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:24:58.238 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:24:58.238 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:24:58.238 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:24:58.238 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:24:58.239 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:24:58.242 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:24:58.242 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:24:58.242 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:24:58.243 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:24:58.251 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:24:58.255 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.257 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 16:24:58.263 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 16:24:58.264 +04:00 DBG Committing transaction.
2025-04-01 16:24:58.265 +04:00 DBG Committed transaction.
2025-04-01 16:24:58.265 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:24:58.266 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:24:58.267 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-04-01 16:24:58.267 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:24:58.274 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:24:58.275 +04:00 DBG Disposing transaction.
2025-04-01 16:24:58.275 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.276 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:24:58.374 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 16:24:58.701 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 16:24:58.743 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.744 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.744 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:24:58.744 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:24:58.744 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:24:58.744 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:24:58.754 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:24:58.757 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.758 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 16:24:58.758 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.758 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:24:58.760 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:24:58.762 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:58.764 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 16:24:58.771 +04:00 DBG Hosting starting
2025-04-01 16:24:58.810 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 16:24:58.836 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 16:24:58.850 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 16:24:58.863 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 16:24:58.871 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:24:58.872 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 16:24:58.874 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:24:58.875 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 16:24:58.877 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 16:24:58.879 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 16:24:58.880 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 16:24:58.909 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:24:58.919 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 16:24:58.990 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 16:24:59.020 +04:00 DBG Creating DbConnection.
2025-04-01 16:24:59.021 +04:00 DBG Created DbConnection. (1ms).
2025-04-01 16:24:59.024 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:59.029 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:59.030 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:24:59.031 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:24:59.031 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:24:59.033 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:24:59.084 +04:00 INF Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:24:59.115 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:59.118 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 33ms reading results.
2025-04-01 16:24:59.122 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:59.123 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:24:59.124 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:24:59.124 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:24:59.125 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:24:59.242 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 16:24:59.242 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 16:24:59.242 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 16:24:59.242 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 16:24:59.329 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 16:24:59.559 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 16:24:59.567 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 16:24:59.567 +04:00 INF Hosting environment: Development
2025-04-01 16:24:59.568 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 16:24:59.568 +04:00 DBG Hosting started
2025-04-01 16:24:59.604 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 16:24:59.605 +04:00 DBG Request did not match any endpoints
2025-04-01 16:24:59.712 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 16:24:59.714 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 16:24:59.810 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 16:24:59.811 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 16:25:00.073 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 16:25:00.073 +04:00 DBG Connection ID "17798225728978812941" disconnecting.
2025-04-01 16:25:00.073 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 16:25:00.074 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 760.1166ms
2025-04-01 16:25:00.080 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 10.4134ms
2025-04-01 16:25:00.163 +04:00 DBG Connection ID "18230571301796315157" disconnecting.
2025-04-01 16:25:00.167 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 93.4386ms
2025-04-01 16:25:00.254 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 16:25:00.254 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 16:25:00.255 +04:00 DBG Request did not match any endpoints
2025-04-01 16:25:00.284 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.1729ms
2025-04-01 16:25:17.705 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:25:17.711 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:25:17.720 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:25:17.721 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:25:17.728 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:25:17.938 +04:00 INF Failed to validate the token.Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '4/1/2025 12:18:03 PM', Current time (UTC): '4/1/2025 12:25:17 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)

2025-04-01 16:25:17.948 +04:00 INF Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '4/1/2025 12:18:03 PM', Current time (UTC): '4/1/2025 12:25:17 PM'.
2025-04-01 16:25:17.955 +04:00 DBG Policy authentication schemes  did not succeed
2025-04-01 16:25:17.958 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 16:25:17.965 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-04-01 16:25:17.968 +04:00 DBG Connection ID "18302628900129210393" disconnecting.
2025-04-01 16:25:17.968 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 401 null null 263.443ms
2025-04-01 16:26:13.348 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 16:26:13.352 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 16:26:13.362 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 16:26:13.363 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:26:13.363 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:26:13.366 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 16:26:13.368 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:26:13.395 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 16:26:13.397 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:26:13.397 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:26:13.398 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:26:13.398 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:26:13.399 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:26:13.400 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:26:13.453 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:26:13.455 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:26:13.462 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:26:13.470 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 16:26:13.478 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 16:26:13.502 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 16:26:13.503 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:26:13.503 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:26:13.503 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:26:13.513 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:26:13.514 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:26:13.515 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:26:13.515 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:26:13.516 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:26:13.519 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 16:26:13.525 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 16:26:13.537 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 16:26:13.553 +04:00 DBG Creating DbConnection.
2025-04-01 16:26:13.554 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:26:13.554 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:26:13.554 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:26:13.554 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:26:13.555 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:26:13.560 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-04-01 16:26:13.563 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:26:13.599 +04:00 INF Executed DbCommand (39ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:26:13.693 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:26:13.723 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:26:13.723 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 94ms reading results.
2025-04-01 16:26:13.724 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:26:13.725 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:26:13.836 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 16:26:13.838 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 16:26:13.838 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 16:26:13.839 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 16:26:13.841 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 16:26:13.843 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 16:26:13.866 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 461.745ms
2025-04-01 16:26:13.867 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:26:13.869 +04:00 DBG Connection ID "17870283323016740876" disconnecting.
2025-04-01 16:26:13.870 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:26:13.871 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:26:13.871 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:26:13.873 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 524.8672ms
2025-04-01 16:27:05.219 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:27:05.246 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:27:05.246 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:27:05.246 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:27:05.246 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:27:05.262 +04:00 DBG Successfully validated the token.
2025-04-01 16:27:05.264 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:27:05.310 +04:00 DBG Authorization was successful.
2025-04-01 16:27:05.310 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:27:05.321 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 16:27:05.321 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:27:05.321 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:27:05.322 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:27:05.322 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:27:05.323 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:27:05.323 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:27:05.326 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:31:17.108 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 16:31:17.262 +04:00 INF starting web host
2025-04-01 16:31:17.454 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 16:31:18.373 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:31:18.374 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:31:18.463 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:31:18.659 +04:00 DBG Creating DbConnection.
2025-04-01 16:31:18.708 +04:00 DBG Created DbConnection. (40ms).
2025-04-01 16:31:18.710 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:18.729 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.067 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.071 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:31:19.077 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 16:31:19.079 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 16:31:19.087 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:31:19.117 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:31:19.119 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.128 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 16:31:19.128 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.130 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.132 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 16:31:19.137 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:31:19.138 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:31:19.138 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:31:19.139 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:31:19.185 +04:00 INF Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:31:19.313 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:31:19.322 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:31:19.324 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:31:19.324 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:31:19.325 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 16:31:19.326 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:31:19.331 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:31:19.333 +04:00 DBG Committing transaction.
2025-04-01 16:31:19.337 +04:00 DBG Committed transaction.
2025-04-01 16:31:19.338 +04:00 DBG Disposing transaction.
2025-04-01 16:31:19.341 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:31:19.341 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:31:19.343 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:31:19.343 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:31:19.343 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:31:19.343 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:31:19.344 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:31:19.345 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:31:19.345 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:31:19.345 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:31:19.345 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:31:19.346 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:31:19.350 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:31:19.351 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:31:19.351 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-04-01 16:31:19.352 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:31:19.357 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:31:19.360 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.361 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:31:19.372 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 16:31:19.372 +04:00 DBG Committing transaction.
2025-04-01 16:31:19.373 +04:00 DBG Committed transaction.
2025-04-01 16:31:19.373 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:31:19.373 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:31:19.373 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:31:19.373 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:31:19.376 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:31:19.376 +04:00 DBG Disposing transaction.
2025-04-01 16:31:19.376 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.377 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:31:19.491 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 16:31:19.796 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 16:31:19.834 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.834 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.835 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:31:19.835 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:31:19.836 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-04-01 16:31:19.836 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:31:19.842 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:31:19.846 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.846 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 16:31:19.846 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.846 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:31:19.850 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:31:19.853 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:19.855 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 16:31:19.860 +04:00 DBG Hosting starting
2025-04-01 16:31:19.881 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 16:31:19.903 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 16:31:19.910 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 16:31:19.920 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 16:31:19.923 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:31:19.924 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 16:31:19.926 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:31:19.927 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 16:31:19.928 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 16:31:19.930 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 16:31:19.932 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 16:31:19.958 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:31:19.975 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 16:31:20.070 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 16:31:20.092 +04:00 DBG Creating DbConnection.
2025-04-01 16:31:20.093 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:31:20.096 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:20.102 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:20.103 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:31:20.104 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:31:20.104 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:31:20.105 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:31:20.135 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:31:20.149 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:20.151 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 15ms reading results.
2025-04-01 16:31:20.153 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:20.154 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:31:20.155 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:31:20.155 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:20.155 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:31:20.250 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 16:31:20.250 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 16:31:20.250 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 16:31:20.250 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 16:31:20.330 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 16:31:20.529 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 16:31:20.543 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 16:31:20.543 +04:00 INF Hosting environment: Development
2025-04-01 16:31:20.543 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 16:31:20.543 +04:00 DBG Hosting started
2025-04-01 16:31:20.578 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 16:31:20.579 +04:00 DBG Request did not match any endpoints
2025-04-01 16:31:20.717 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 16:31:20.720 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 16:31:20.818 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 16:31:20.819 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 16:31:20.890 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 16:31:20.895 +04:00 DBG Connection ID "18014398511092596779" disconnecting.
2025-04-01 16:31:20.895 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 523.1875ms
2025-04-01 16:31:20.921 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 16:31:20.936 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 35.153ms
2025-04-01 16:31:21.019 +04:00 DBG Connection ID "17942340917054668862" disconnecting.
2025-04-01 16:31:21.024 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 133.9414ms
2025-04-01 16:31:21.130 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 16:31:21.130 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 16:31:21.130 +04:00 DBG Request did not match any endpoints
2025-04-01 16:31:21.184 +04:00 DBG Connection ID "18230571297501347875" disconnecting.
2025-04-01 16:31:21.184 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 54.4507ms
2025-04-01 16:31:54.913 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 16:31:54.950 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 16:31:54.954 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 16:31:54.955 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:31:54.958 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:31:55.036 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 16:31:55.038 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:31:55.060 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 16:31:55.065 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:31:55.065 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:31:55.066 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:31:55.067 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:31:55.067 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:31:55.070 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:31:55.138 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:31:55.140 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:31:55.148 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:31:55.152 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 16:31:55.154 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 16:31:55.189 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 16:31:55.190 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:31:55.190 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:31:55.191 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:31:55.213 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:31:55.215 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:31:55.217 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:31:55.218 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:31:55.219 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:31:55.225 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 16:31:55.235 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 16:31:55.256 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 16:31:55.273 +04:00 DBG Creating DbConnection.
2025-04-01 16:31:55.273 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:31:55.274 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:55.274 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:55.275 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:31:55.275 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:31:55.284 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (9ms).
2025-04-01 16:31:55.289 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:31:55.318 +04:00 INF Executed DbCommand (33ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:31:55.364 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:31:55.389 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:55.390 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 71ms reading results.
2025-04-01 16:31:55.390 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:55.390 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:31:55.507 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 16:31:55.511 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 16:31:55.512 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 16:31:55.512 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 16:31:55.514 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 16:31:55.515 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 16:31:55.533 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 459.6642ms
2025-04-01 16:31:55.534 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:31:55.537 +04:00 DBG Connection ID "18374686489872171072" disconnecting.
2025-04-01 16:31:55.537 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:31:55.538 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:31:55.538 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:31:55.541 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 627.898ms
2025-04-01 16:32:29.279 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:32:29.283 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:32:29.285 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:32:29.285 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:32:29.286 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:32:29.362 +04:00 DBG Successfully validated the token.
2025-04-01 16:32:29.364 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:32:29.371 +04:00 DBG Authorization was successful.
2025-04-01 16:32:29.372 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:32:29.383 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 16:32:29.383 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:32:29.383 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:32:29.384 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:32:29.384 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:32:29.384 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:32:29.384 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:32:29.389 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:32:29.391 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:32:29.393 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:32:29.394 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 16:32:29.395 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:32:29.395 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 16:34:34.614 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 16:34:34.748 +04:00 INF starting web host
2025-04-01 16:34:34.977 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 16:34:35.858 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:34:35.859 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 16:34:35.956 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:34:36.184 +04:00 DBG Creating DbConnection.
2025-04-01 16:34:36.246 +04:00 DBG Created DbConnection. (60ms).
2025-04-01 16:34:36.251 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.268 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.622 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.627 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:34:36.635 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 16:34:36.637 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-04-01 16:34:36.642 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:34:36.670 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:34:36.672 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.679 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 16:34:36.679 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.681 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.682 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 16:34:36.685 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:34:36.685 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:34:36.686 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:34:36.686 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:34:36.722 +04:00 INF Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 16:34:36.817 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:34:36.828 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:34:36.829 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:34:36.829 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:34:36.831 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-04-01 16:34:36.832 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:34:36.844 +04:00 INF Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 16:34:36.847 +04:00 DBG Committing transaction.
2025-04-01 16:34:36.854 +04:00 DBG Committed transaction.
2025-04-01 16:34:36.856 +04:00 DBG Disposing transaction.
2025-04-01 16:34:36.858 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:34:36.859 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:34:36.860 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 16:34:36.860 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:34:36.860 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 16:34:36.861 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:34:36.861 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 16:34:36.862 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:34:36.862 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:34:36.862 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:34:36.862 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:34:36.863 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 16:34:36.867 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:34:36.867 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:34:36.867 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:34:36.868 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:34:36.872 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 16:34:36.876 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.877 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 16:34:36.883 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 16:34:36.884 +04:00 DBG Committing transaction.
2025-04-01 16:34:36.884 +04:00 DBG Committed transaction.
2025-04-01 16:34:36.885 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 16:34:36.885 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:34:36.885 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 16:34:36.885 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:34:36.892 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 16:34:36.893 +04:00 DBG Disposing transaction.
2025-04-01 16:34:36.893 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:36.893 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:34:36.974 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 16:34:37.282 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 16:34:37.330 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.330 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.330 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:34:37.330 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:34:37.331 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:34:37.333 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:34:37.339 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 16:34:37.343 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.343 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 16:34:37.344 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.344 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:34:37.345 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:34:37.348 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.349 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 16:34:37.353 +04:00 DBG Hosting starting
2025-04-01 16:34:37.374 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 16:34:37.393 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 16:34:37.401 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 16:34:37.409 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 16:34:37.413 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:34:37.414 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 16:34:37.416 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 16:34:37.418 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 16:34:37.420 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 16:34:37.422 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 16:34:37.423 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 16:34:37.493 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:34:37.511 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 16:34:37.612 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 16:34:37.627 +04:00 DBG Creating DbConnection.
2025-04-01 16:34:37.628 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:34:37.630 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.634 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.635 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:34:37.635 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:34:37.635 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:34:37.636 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:34:37.659 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 16:34:37.673 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.674 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-04-01 16:34:37.676 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.679 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:34:37.686 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:34:37.687 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:34:37.687 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:34:37.796 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 16:34:37.796 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 16:34:37.796 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 16:34:37.796 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 16:34:37.870 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 16:34:38.038 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 16:34:38.062 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 16:34:38.062 +04:00 INF Hosting environment: Development
2025-04-01 16:34:38.062 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 16:34:38.063 +04:00 DBG Hosting started
2025-04-01 16:34:38.087 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 16:34:38.088 +04:00 DBG Request did not match any endpoints
2025-04-01 16:34:38.215 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 16:34:38.217 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 16:34:38.290 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 16:34:38.291 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 16:34:38.345 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 488.5597ms
2025-04-01 16:34:38.346 +04:00 DBG Connection ID "17942340917054668866" disconnecting.
2025-04-01 16:34:38.370 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 16:34:38.371 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 16:34:38.377 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 6.2133ms
2025-04-01 16:34:38.459 +04:00 DBG Connection ID "17942340917054668868" disconnecting.
2025-04-01 16:34:38.468 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 96.9481ms
2025-04-01 16:34:38.557 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 16:34:38.557 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 16:34:38.558 +04:00 DBG Request did not match any endpoints
2025-04-01 16:34:38.608 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 50.9925ms
2025-04-01 16:35:08.029 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 16:35:08.099 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 16:35:08.104 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 16:35:08.105 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:35:08.109 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:35:08.182 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 16:35:08.185 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:35:08.207 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 16:35:08.209 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:35:08.209 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:35:08.210 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:35:08.210 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:35:08.211 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:35:08.214 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:35:08.290 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:35:08.291 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 16:35:08.299 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:35:08.302 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 16:35:08.304 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 16:35:08.327 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 16:35:08.328 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:35:08.329 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:35:08.329 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 16:35:08.339 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 16:35:08.341 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:35:08.342 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:35:08.342 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:35:08.342 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 16:35:08.347 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 16:35:08.354 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 16:35:08.368 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 16:35:08.385 +04:00 DBG Creating DbConnection.
2025-04-01 16:35:08.386 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:35:08.386 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:08.386 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:08.386 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:35:08.387 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:35:08.390 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (3ms).
2025-04-01 16:35:08.392 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:35:08.425 +04:00 INF Executed DbCommand (35ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 16:35:08.508 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:35:08.557 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:08.557 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 132ms reading results.
2025-04-01 16:35:08.558 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:08.558 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:35:08.689 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 16:35:08.692 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 16:35:08.692 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 16:35:08.693 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 16:35:08.699 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 16:35:08.700 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 16:35:08.722 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 507.5229ms
2025-04-01 16:35:08.723 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 16:35:08.727 +04:00 DBG Connection ID "18230571301796315166" disconnecting.
2025-04-01 16:35:08.729 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:35:08.729 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:08.729 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:35:08.731 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 703.0986ms
2025-04-01 16:35:39.329 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 16:35:39.331 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 16:35:39.331 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 16:35:39.332 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:35:39.333 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:35:39.453 +04:00 DBG Successfully validated the token.
2025-04-01 16:35:39.455 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:35:39.468 +04:00 DBG Authorization was successful.
2025-04-01 16:35:39.469 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:35:39.477 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 16:35:39.477 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:35:39.477 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:35:39.478 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:35:39.478 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:35:39.479 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:35:39.479 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:35:39.482 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:35:39.485 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:35:39.495 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:35:39.496 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 16:35:39.496 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:35:39.496 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 16:35:39.505 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .FirstOrDefault(acc => acc.Id == __id_0)'
2025-04-01 16:35:39.530 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 16:35:39.532 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 16:35:39.599 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 16:35:39.616 +04:00 DBG Creating DbConnection.
2025-04-01 16:35:39.616 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:35:39.616 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:39.616 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:39.617 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:35:39.617 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:35:39.617 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:35:39.618 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 16:35:39.643 +04:00 INF Executed DbCommand (25ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 16:35:39.646 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:35:39.666 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:35:39.668 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:35:39.677 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:39.677 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 34ms reading results.
2025-04-01 16:35:39.677 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:39.678 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:35:39.678 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 16:35:39.679 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 16:35:39.679 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 16:35:39.679 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 16:35:39.679 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 16:35:39.679 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.AccountResponseModel'.
2025-04-01 16:35:39.682 +04:00 INF Executed action offers.API.Controllers.UserController.GetCurrentUser (offers.API) in 202.8813ms
2025-04-01 16:35:39.682 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 16:35:39.683 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:35:39.683 +04:00 DBG Connection ID "18230571301796315168" disconnecting.
2025-04-01 16:35:39.683 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:35:39.684 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:35:39.684 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 200 null application/json; charset=utf-8 355.7921ms
2025-04-01 16:36:21.977 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 21
2025-04-01 16:36:21.978 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 16:36:21.978 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 16:36:21.978 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 16:36:21.979 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 16:36:21.993 +04:00 DBG Successfully validated the token.
2025-04-01 16:36:21.993 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 16:36:21.996 +04:00 DBG Authorization was successful.
2025-04-01 16:36:21.997 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 16:36:22.008 +04:00 INF Route matched with {action = "Deposit", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Deposit(offers.API.Models.DepositRequestDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 16:36:22.009 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 16:36:22.009 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 16:36:22.009 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 16:36:22.009 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 16:36:22.009 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 16:36:22.009 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:36:22.011 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 16:36:22.014 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 16:36:22.014 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 16:36:22.015 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' using the name '' in request data ...
2025-04-01 16:36:22.015 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 16:36:22.026 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.DepositRequestDTO'
2025-04-01 16:36:22.026 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 16:36:22.027 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 16:36:22.027 +04:00 DBG Attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 16:36:22.028 +04:00 DBG Done attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 16:36:22.028 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:36:22.029 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 16:36:22.029 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 16:36:22.029 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 16:36:22.030 +04:00 INF attempt to make a Deposit
2025-04-01 16:36:22.038 +04:00 DBG Creating DbConnection.
2025-04-01 16:36:22.038 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 16:36:22.039 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.040 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.040 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 16:36:22.040 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:36:22.041 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 16:36:22.041 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 16:36:22.049 +04:00 INF Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 16:36:22.050 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:36:22.051 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:36:22.051 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 16:36:22.052 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.052 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 16:36:22.052 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.052 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:36:22.067 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.067 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.068 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 16:36:22.069 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 16:36:22.165 +04:00 DBG Rolling back transaction.
2025-04-01 16:36:22.167 +04:00 DBG Rolled back transaction.
2025-04-01 16:36:22.169 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.169 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 16:36:22.170 +04:00 DBG Disposing transaction.
2025-04-01 16:36:22.306 +04:00 INF Executed action offers.API.Controllers.UserController.Deposit (offers.API) in 296.0838ms
2025-04-01 16:36:22.307 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 16:36:22.312 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountCouldNotDepositException: Deposit to account ID 2 failed the expected ammount could not be deposited because of an unknown issue
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 173
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 180
   at offers.API.Controllers.UserController.Deposit(DepositRequestDTO depositDTO, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\UserController.cs:line 70
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 16:36:22.652 +04:00 ERR Handled exception: Deposit to account ID 2 failed the expected ammount could not be deposited because of an unknown issueoffers.Application.Exceptions.Account.AccountCouldNotDepositException: Deposit to account ID 2 failed the expected ammount could not be deposited because of an unknown issue
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 173
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 180
   at offers.API.Controllers.UserController.Deposit(DepositRequestDTO depositDTO, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\UserController.cs:line 70
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 16:36:22.658 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 16:36:22.658 +04:00 DBG Connection ID "18230571301796315170" disconnecting.
2025-04-01 16:36:22.658 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 16:36:22.658 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 16:36:22.659 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 500 null application/json 682.5911ms
2025-04-01 17:00:28.465 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 17:00:28.603 +04:00 INF starting web host
2025-04-01 17:00:28.813 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 17:00:29.654 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 17:00:29.655 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 17:00:29.740 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 17:00:29.952 +04:00 DBG Creating DbConnection.
2025-04-01 17:00:30.025 +04:00 DBG Created DbConnection. (71ms).
2025-04-01 17:00:30.030 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.044 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.440 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.446 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 17:00:30.453 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-04-01 17:00:30.454 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-04-01 17:00:30.460 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 17:00:30.485 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 17:00:30.488 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.499 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 17:00:30.499 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.500 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.501 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 17:00:30.504 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 17:00:30.504 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 17:00:30.504 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 17:00:30.504 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 17:00:30.527 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 17:00:30.596 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 17:00:30.603 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 17:00:30.605 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 17:00:30.605 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 17:00:30.606 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 17:00:30.607 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 17:00:30.615 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 17:00:30.617 +04:00 DBG Committing transaction.
2025-04-01 17:00:30.620 +04:00 DBG Committed transaction.
2025-04-01 17:00:30.622 +04:00 DBG Disposing transaction.
2025-04-01 17:00:30.624 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 17:00:30.624 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 17:00:30.629 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 17:00:30.629 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 17:00:30.630 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 17:00:30.630 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 17:00:30.632 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 17:00:30.632 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 17:00:30.632 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 17:00:30.632 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 17:00:30.633 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 17:00:30.634 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 17:00:30.636 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 17:00:30.636 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:00:30.636 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:00:30.637 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 17:00:30.645 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 17:00:30.649 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.650 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 17:00:30.657 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 17:00:30.658 +04:00 DBG Committing transaction.
2025-04-01 17:00:30.659 +04:00 DBG Committed transaction.
2025-04-01 17:00:30.660 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 17:00:30.660 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 17:00:30.660 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 17:00:30.660 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 17:00:30.665 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 17:00:30.665 +04:00 DBG Disposing transaction.
2025-04-01 17:00:30.665 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:30.666 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 17:00:30.780 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 17:00:31.082 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 17:00:31.132 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.132 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.132 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 17:00:31.132 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:00:31.132 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:00:31.133 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 17:00:31.136 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 17:00:31.138 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.139 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 17:00:31.139 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.139 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 17:00:31.141 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 17:00:31.144 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.147 +04:00 DBG Disposed connection to database '' on server '' (3ms).
2025-04-01 17:00:31.152 +04:00 DBG Hosting starting
2025-04-01 17:00:31.181 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 17:00:31.197 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 17:00:31.209 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 17:00:31.224 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 17:00:31.232 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 17:00:31.232 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 17:00:31.234 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 17:00:31.235 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 17:00:31.236 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 17:00:31.238 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 17:00:31.239 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 17:00:31.272 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 17:00:31.300 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 17:00:31.413 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 17:00:31.434 +04:00 DBG Creating DbConnection.
2025-04-01 17:00:31.434 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 17:00:31.436 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.438 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.439 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 17:00:31.439 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:00:31.439 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:00:31.439 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 17:00:31.457 +04:00 INF Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 17:00:31.468 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.469 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 12ms reading results.
2025-04-01 17:00:31.471 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.472 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 17:00:31.473 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 17:00:31.473 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:00:31.473 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 17:00:31.601 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 17:00:31.601 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 17:00:31.601 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 17:00:31.601 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 17:00:31.685 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 17:00:31.865 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 17:00:31.866 +04:00 INF Hosting environment: Development
2025-04-01 17:00:31.866 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 17:00:31.866 +04:00 DBG Hosting started
2025-04-01 17:00:31.881 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 17:00:31.917 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 17:00:31.918 +04:00 DBG Request did not match any endpoints
2025-04-01 17:00:32.068 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 17:00:32.074 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 17:00:32.271 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 17:00:32.272 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 17:00:32.286 +04:00 DBG Connection ID "18158513712053354536" disconnecting.
2025-04-01 17:00:32.289 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 618.0172ms
2025-04-01 17:00:32.387 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 17:00:32.407 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 17:00:33.268 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 860.4032ms
2025-04-01 17:00:33.339 +04:00 DBG Connection ID "18374686489872171074" disconnecting.
2025-04-01 17:00:33.343 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 956.2226ms
2025-04-01 17:00:33.429 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 17:00:33.430 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 17:00:33.430 +04:00 DBG Request did not match any endpoints
2025-04-01 17:00:33.486 +04:00 DBG Connection ID "17870283331606675465" disconnecting.
2025-04-01 17:00:33.486 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 56.9924ms
2025-04-01 17:00:56.830 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 17:00:56.844 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 17:00:56.848 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 17:00:56.849 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 17:00:56.852 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 17:00:57.003 +04:00 INF Failed to validate the token.Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '4/1/2025 12:18:03 PM', Current time (UTC): '4/1/2025 1:00:56 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)

2025-04-01 17:00:57.014 +04:00 INF Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '4/1/2025 12:18:03 PM', Current time (UTC): '4/1/2025 1:00:56 PM'.
2025-04-01 17:00:57.018 +04:00 DBG Policy authentication schemes  did not succeed
2025-04-01 17:00:57.021 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-04-01 17:00:57.029 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-04-01 17:00:57.030 +04:00 DBG Connection ID "17726168134940884993" disconnecting.
2025-04-01 17:00:57.030 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 401 null null 200.5228ms
2025-04-01 17:01:28.706 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 17:01:28.708 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 17:01:28.708 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 17:01:28.709 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 17:01:28.709 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 17:01:28.727 +04:00 DBG Successfully validated the token.
2025-04-01 17:01:28.730 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 17:01:28.732 +04:00 DBG Authorization was successful.
2025-04-01 17:01:28.733 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 17:01:28.762 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 17:01:28.764 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 17:01:28.764 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 17:01:28.765 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 17:01:28.765 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 17:01:28.765 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 17:01:28.767 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 17:01:28.858 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 17:01:28.861 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 17:01:28.868 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 17:01:28.874 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 17:01:28.874 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 17:01:28.876 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 17:01:28.894 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .FirstOrDefault(acc => acc.Id == __id_0)'
2025-04-01 17:01:28.918 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 17:01:28.922 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 17:01:29.027 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 17:01:29.059 +04:00 DBG Creating DbConnection.
2025-04-01 17:01:29.059 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 17:01:29.059 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:01:29.060 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:01:29.060 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 17:01:29.060 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:01:29.066 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-04-01 17:01:29.073 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 17:01:29.161 +04:00 INF Executed DbCommand (63ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 17:01:29.231 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 17:01:29.317 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 17:01:29.319 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 17:01:29.332 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:01:29.333 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 171ms reading results.
2025-04-01 17:01:29.333 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:01:29.333 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 17:01:29.429 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 17:01:29.433 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 17:01:29.433 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 17:01:29.434 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 17:01:29.436 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 17:01:29.437 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.UserResponseModel'.
2025-04-01 17:01:29.467 +04:00 INF Executed action offers.API.Controllers.UserController.GetCurrentUser (offers.API) in 698.2976ms
2025-04-01 17:01:29.468 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 17:01:29.473 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 17:01:29.473 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:01:29.473 +04:00 DBG Connection ID "17870283323016740879" disconnecting.
2025-04-01 17:01:29.473 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 17:01:29.475 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 200 null application/json; charset=utf-8 769.0027ms
2025-04-01 17:01:51.659 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 21
2025-04-01 17:01:51.661 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 17:01:51.661 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 17:01:51.661 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 17:01:51.661 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 17:01:51.662 +04:00 DBG Successfully validated the token.
2025-04-01 17:01:51.662 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 17:01:51.664 +04:00 DBG Authorization was successful.
2025-04-01 17:01:51.664 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 17:01:51.675 +04:00 INF Route matched with {action = "Deposit", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Deposit(offers.API.Models.DepositRequestDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 17:01:51.675 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 17:01:51.675 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 17:01:51.675 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 17:01:51.675 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 17:01:51.675 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 17:01:51.676 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 17:01:51.677 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 17:01:51.679 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 17:01:51.680 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 17:01:51.681 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' using the name '' in request data ...
2025-04-01 17:01:51.682 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 17:01:51.708 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.DepositRequestDTO'
2025-04-01 17:01:51.708 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 17:01:51.709 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 17:01:51.709 +04:00 DBG Attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 17:01:51.720 +04:00 DBG Done attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 17:01:51.720 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 17:01:51.721 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 17:01:51.721 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 17:01:51.721 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 17:02:00.527 +04:00 INF attempt to make a Deposit
2025-04-01 17:02:24.637 +04:00 DBG Creating DbConnection.
2025-04-01 17:02:24.638 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 17:02:24.638 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:02:24.638 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:02:24.638 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 17:02:24.638 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:02:24.639 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 17:02:24.639 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 17:02:24.672 +04:00 INF Executed DbCommand (32ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 17:02:24.709 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 17:02:24.711 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 17:02:24.711 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 17:02:24.712 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:02:24.712 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 36ms reading results.
2025-04-01 17:02:24.712 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:02:24.713 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 17:02:29.044 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:02:29.045 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:02:29.045 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 17:02:29.047 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 17:03:13.417 +04:00 DBG Rolling back transaction.
2025-04-01 17:03:13.420 +04:00 DBG Rolled back transaction.
2025-04-01 17:03:13.422 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:03:13.422 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 17:03:13.423 +04:00 DBG Disposing transaction.
2025-04-01 17:03:13.502 +04:00 INF Executed action offers.API.Controllers.UserController.Deposit (offers.API) in 81826.3821ms
2025-04-01 17:03:13.506 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 17:03:13.509 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountCouldNotDepositException: Deposit to account ID 2 failed the expected ammount could not be deposited because of an unknown issue
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 173
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 180
   at offers.API.Controllers.UserController.Deposit(DepositRequestDTO depositDTO, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\UserController.cs:line 70
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 17:03:13.808 +04:00 ERR Handled exception: Deposit to account ID 2 failed the expected ammount could not be deposited because of an unknown issueoffers.Application.Exceptions.Account.AccountCouldNotDepositException: Deposit to account ID 2 failed the expected ammount could not be deposited because of an unknown issue
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 173
   at offers.Application.Services.Accounts.AccountService.DepositAsync(Int32 accountId, Decimal amount, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 180
   at offers.API.Controllers.UserController.Deposit(DepositRequestDTO depositDTO, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\UserController.cs:line 70
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 17:03:13.814 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 17:03:13.814 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 17:03:13.814 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 17:03:13.815 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 500 null application/json 82157.0409ms
2025-04-01 18:09:19.476 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 18:09:19.622 +04:00 INF starting web host
2025-04-01 18:09:19.873 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 18:09:20.613 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:09:20.615 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:09:20.711 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:09:20.860 +04:00 DBG Creating DbConnection.
2025-04-01 18:09:20.950 +04:00 DBG Created DbConnection. (86ms).
2025-04-01 18:09:20.955 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:20.972 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:21.393 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:21.397 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:09:21.407 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 18:09:21.409 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-04-01 18:09:21.415 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:09:21.444 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:09:21.446 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:21.454 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-04-01 18:09:21.454 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:21.455 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:21.456 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 18:09:21.459 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:09:21.459 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:09:21.460 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:09:21.460 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:09:21.495 +04:00 INF Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:09:21.603 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:09:21.611 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:09:21.612 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:09:21.612 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:09:21.614 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 18:09:21.614 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:09:21.622 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:09:21.624 +04:00 DBG Committing transaction.
2025-04-01 18:09:21.627 +04:00 DBG Committed transaction.
2025-04-01 18:09:21.628 +04:00 DBG Disposing transaction.
2025-04-01 18:09:21.630 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:09:21.630 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:09:21.634 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:09:21.634 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:09:21.634 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:09:21.634 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:09:21.635 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:09:21.635 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:09:21.635 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:09:21.635 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:09:21.636 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:09:21.636 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:09:21.638 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:09:21.638 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:09:21.638 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:09:21.639 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:09:21.647 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:09:21.650 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:21.652 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 18:09:21.656 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 18:09:21.657 +04:00 DBG Committing transaction.
2025-04-01 18:09:21.657 +04:00 DBG Committed transaction.
2025-04-01 18:09:21.657 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:09:21.657 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:09:21.658 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:09:21.658 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:09:21.661 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:09:21.661 +04:00 DBG Disposing transaction.
2025-04-01 18:09:21.661 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:21.662 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:09:21.723 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 18:09:21.961 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 18:09:22.011 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.011 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.012 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:09:22.012 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:09:22.012 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:09:22.012 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:09:22.018 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:09:22.022 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.022 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 18:09:22.022 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.022 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:09:22.023 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:09:22.025 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.026 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:09:22.030 +04:00 DBG Hosting starting
2025-04-01 18:09:22.059 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 18:09:22.076 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 18:09:22.093 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 18:09:22.108 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 18:09:22.111 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:09:22.112 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 18:09:22.114 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:09:22.116 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 18:09:22.118 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 18:09:22.120 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 18:09:22.121 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 18:09:22.160 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:09:22.174 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 18:09:22.249 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 18:09:22.266 +04:00 DBG Creating DbConnection.
2025-04-01 18:09:22.267 +04:00 DBG Created DbConnection. (1ms).
2025-04-01 18:09:22.269 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.272 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.272 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:09:22.272 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:09:22.272 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:09:22.273 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:09:22.300 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:09:22.310 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.311 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 10ms reading results.
2025-04-01 18:09:22.313 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.314 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:09:22.316 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:09:22.316 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:22.316 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:09:22.427 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 18:09:22.427 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 18:09:22.427 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 18:09:22.427 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 18:09:22.505 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger - null null
2025-04-01 18:09:22.671 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 18:09:22.671 +04:00 INF Hosting environment: Development
2025-04-01 18:09:22.672 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 18:09:22.672 +04:00 DBG Hosting started
2025-04-01 18:09:22.703 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 18:09:22.745 +04:00 DBG No candidates found for the request path '/swagger'
2025-04-01 18:09:22.745 +04:00 DBG Request did not match any endpoints
2025-04-01 18:09:22.808 +04:00 DBG Connection ID "18374686489872171079" disconnecting.
2025-04-01 18:09:22.808 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 18:09:22.814 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 18:09:22.815 +04:00 DBG Request did not match any endpoints
2025-04-01 18:09:22.829 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger - 301 null null 336.0084ms
2025-04-01 18:09:22.924 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 18:09:22.926 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 18:09:22.967 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 18:09:22.967 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 18:09:22.978 +04:00 DBG Connection ID "17870283323016740882" disconnecting.
2025-04-01 18:09:22.978 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 169.8644ms
2025-04-01 18:09:22.979 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/swagger-ui-bundle.js - null null
2025-04-01 18:09:22.980 +04:00 DBG No candidates found for the request path '/swagger/swagger-ui-bundle.js'
2025-04-01 18:09:22.980 +04:00 DBG Request did not match any endpoints
2025-04-01 18:09:22.993 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/swagger-ui-standalone-preset.js - null null
2025-04-01 18:09:22.993 +04:00 DBG No candidates found for the request path '/swagger/swagger-ui-standalone-preset.js'
2025-04-01 18:09:22.993 +04:00 DBG Request did not match any endpoints
2025-04-01 18:09:22.994 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 18:09:22.995 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/swagger-ui.css - null null
2025-04-01 18:09:22.996 +04:00 DBG No candidates found for the request path '/swagger/swagger-ui.css'
2025-04-01 18:09:22.996 +04:00 DBG Request did not match any endpoints
2025-04-01 18:09:23.001 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.7903ms
2025-04-01 18:09:23.007 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 18:09:23.014 +04:00 INF Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-04-01 18:09:23.020 +04:00 DBG Connection ID "17870283323016740884" disconnecting.
2025-04-01 18:09:23.020 +04:00 INF Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-04-01 18:09:23.026 +04:00 DBG Connection ID "18014398511092596787" disconnecting.
2025-04-01 18:09:23.027 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/swagger-ui.css - 200 152034 text/css 32.6955ms
2025-04-01 18:09:23.030 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 37.4445ms
2025-04-01 18:09:23.045 +04:00 INF Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-04-01 18:09:23.104 +04:00 DBG Connection ID "17798225728978812948" disconnecting.
2025-04-01 18:09:23.105 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 125.5906ms
2025-04-01 18:09:23.120 +04:00 DBG Connection ID "18086456118015426592" disconnecting.
2025-04-01 18:09:23.121 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 113.264ms
2025-04-01 18:09:23.514 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 18:09:23.518 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 18:09:23.518 +04:00 DBG Request did not match any endpoints
2025-04-01 18:09:23.555 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.4132ms
2025-04-01 18:09:50.544 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 62
2025-04-01 18:09:50.611 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:09:50.617 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:09:50.618 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:09:50.621 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:09:50.709 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:09:50.713 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:09:50.748 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:09:50.751 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:09:50.752 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:09:50.752 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:09:50.752 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:09:50.753 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:09:50.755 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:09:50.820 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:09:50.822 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:09:50.838 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:09:50.843 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:09:50.850 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:09:50.872 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:09:50.873 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:09:50.873 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:09:50.873 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:09:50.885 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:09:50.887 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:09:50.887 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:09:50.888 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:09:50.888 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:09:50.891 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 18:09:50.900 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 18:09:50.914 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 18:09:50.926 +04:00 DBG Creating DbConnection.
2025-04-01 18:09:50.926 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:09:50.926 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:50.926 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:50.926 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:09:50.927 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:09:50.933 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (6ms).
2025-04-01 18:09:50.935 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:09:50.969 +04:00 INF Executed DbCommand (36ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:09:51.022 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:09:51.061 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:51.061 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 91ms reading results.
2025-04-01 18:09:51.062 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:51.062 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:09:51.171 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:09:51.173 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:09:51.173 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:09:51.174 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:09:51.175 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:09:51.176 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 18:09:51.189 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 433.7921ms
2025-04-01 18:09:51.190 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:09:51.192 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:09:51.192 +04:00 DBG Connection ID "18086456109425491973" disconnecting.
2025-04-01 18:09:51.193 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:09:51.193 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:09:51.195 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 651.5132ms
2025-04-01 18:10:20.309 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 80
2025-04-01 18:10:20.311 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:10:20.312 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:10:20.312 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:10:20.312 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:10:20.334 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:10:20.334 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:10:20.336 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:10:20.336 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:10:20.336 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:10:20.337 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:10:20.337 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:10:20.337 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:10:20.337 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:10:20.339 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:10:20.340 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:10:20.340 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:10:20.341 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:10:20.341 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:10:20.341 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:10:20.342 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:10:20.342 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:10:20.342 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:10:20.343 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:10:20.343 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:10:20.344 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:10:20.344 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:10:20.345 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:10:20.345 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 18:10:20.353 +04:00 DBG Creating DbConnection.
2025-04-01 18:10:20.353 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:10:20.353 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:10:20.353 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:10:20.353 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:10:20.353 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:10:20.354 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:10:20.354 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:10:20.365 +04:00 INF Executed DbCommand (11ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:10:20.366 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:10:20.366 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:10:20.366 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-04-01 18:10:20.366 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:10:20.366 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:10:20.367 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:10:20.367 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:10:20.367 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:10:20.367 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:10:20.368 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:10:20.368 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 18:10:20.369 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 31.5855ms
2025-04-01 18:10:20.369 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:10:20.370 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:10:20.370 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:10:20.370 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:10:20.370 +04:00 DBG Connection ID "18086456105130524714" disconnecting.
2025-04-01 18:10:20.370 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 61.6609ms
2025-04-01 18:12:13.290 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 18:12:13.429 +04:00 INF starting web host
2025-04-01 18:12:13.660 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 18:12:14.653 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:12:14.654 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:12:14.745 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:12:14.894 +04:00 DBG Creating DbConnection.
2025-04-01 18:12:14.937 +04:00 DBG Created DbConnection. (39ms).
2025-04-01 18:12:14.940 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:14.960 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.252 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.257 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:12:15.262 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 18:12:15.264 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 18:12:15.270 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:12:15.295 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:12:15.297 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.309 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (9ms).
2025-04-01 18:12:15.310 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.311 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.312 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 18:12:15.314 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:12:15.314 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:12:15.314 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:12:15.315 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:12:15.337 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:12:15.430 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:12:15.439 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:12:15.440 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:12:15.440 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:12:15.441 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 18:12:15.441 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:12:15.445 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:12:15.447 +04:00 DBG Committing transaction.
2025-04-01 18:12:15.452 +04:00 DBG Committed transaction.
2025-04-01 18:12:15.454 +04:00 DBG Disposing transaction.
2025-04-01 18:12:15.457 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:12:15.457 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:12:15.459 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:12:15.459 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:12:15.459 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:12:15.459 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:12:15.460 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:12:15.460 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:12:15.461 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:12:15.461 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:12:15.461 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:12:15.462 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:12:15.463 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:12:15.463 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:15.464 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:15.464 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:12:15.468 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:12:15.471 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.473 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 18:12:15.477 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 18:12:15.478 +04:00 DBG Committing transaction.
2025-04-01 18:12:15.478 +04:00 DBG Committed transaction.
2025-04-01 18:12:15.479 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:12:15.479 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:12:15.479 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:12:15.479 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:12:15.482 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:12:15.483 +04:00 DBG Disposing transaction.
2025-04-01 18:12:15.483 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.484 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:12:15.548 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 18:12:15.781 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 18:12:15.830 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.831 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.831 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:12:15.831 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:15.831 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:15.831 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:12:15.839 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:12:15.841 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.841 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 18:12:15.841 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.841 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:12:15.843 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:12:15.845 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:15.846 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 18:12:15.852 +04:00 DBG Hosting starting
2025-04-01 18:12:15.872 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 18:12:15.888 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 18:12:15.894 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 18:12:15.909 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 18:12:15.913 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:12:15.914 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 18:12:15.918 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:12:15.920 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 18:12:15.921 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 18:12:15.923 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 18:12:15.925 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 18:12:15.960 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:12:15.975 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 18:12:16.046 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 18:12:16.063 +04:00 DBG Creating DbConnection.
2025-04-01 18:12:16.063 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:12:16.065 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:16.068 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:16.068 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:12:16.068 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:16.069 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:16.069 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:12:16.088 +04:00 INF Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:12:16.098 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:16.102 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 13ms reading results.
2025-04-01 18:12:16.105 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:16.106 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:12:16.107 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:12:16.107 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:16.107 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:12:16.185 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 18:12:16.185 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 18:12:16.185 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 18:12:16.185 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 18:12:16.240 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 18:12:16.387 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 18:12:16.402 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 18:12:16.402 +04:00 INF Hosting environment: Development
2025-04-01 18:12:16.403 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 18:12:16.403 +04:00 DBG Hosting started
2025-04-01 18:12:16.412 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 18:12:16.413 +04:00 DBG Request did not match any endpoints
2025-04-01 18:12:16.546 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 18:12:16.549 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 18:12:16.620 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 18:12:16.621 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 18:12:16.631 +04:00 DBG Connection ID "18014398515387564059" disconnecting.
2025-04-01 18:12:16.635 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 411.7924ms
2025-04-01 18:12:16.678 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 18:12:16.689 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 18:12:16.695 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.0959ms
2025-04-01 18:12:16.696 +04:00 DBG Connection ID "18158513712053354539" disconnecting.
2025-04-01 18:12:16.758 +04:00 DBG Connection ID "17870283331606675469" disconnecting.
2025-04-01 18:12:16.772 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 94.1835ms
2025-04-01 18:12:16.987 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 18:12:16.988 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 18:12:16.988 +04:00 DBG Request did not match any endpoints
2025-04-01 18:12:17.028 +04:00 DBG Connection ID "18230571306091282464" disconnecting.
2025-04-01 18:12:17.029 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.6035ms
2025-04-01 18:12:38.176 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 68
2025-04-01 18:12:38.218 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:12:38.222 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:12:38.223 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:12:38.226 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:12:38.304 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:12:38.307 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:12:38.330 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:12:38.333 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:12:38.334 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:12:38.335 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:12:38.335 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:12:38.336 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:12:38.337 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:12:38.409 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:12:38.412 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:12:38.422 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:12:38.425 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:12:38.427 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:12:38.455 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:12:38.456 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:12:38.456 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:12:38.457 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:12:38.465 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:12:38.467 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:12:38.469 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:12:38.469 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:12:38.469 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:12:38.472 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 18:12:38.477 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 18:12:38.493 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 18:12:38.509 +04:00 DBG Creating DbConnection.
2025-04-01 18:12:38.510 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:12:38.510 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:38.510 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:38.511 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:12:38.511 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:38.516 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (4ms).
2025-04-01 18:12:38.521 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:12:38.549 +04:00 INF Executed DbCommand (33ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:12:38.598 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:12:38.644 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:38.644 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 94ms reading results.
2025-04-01 18:12:38.645 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:38.646 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:12:38.807 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 467.6604ms
2025-04-01 18:12:38.808 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:12:38.814 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:12:39.085 +04:00 WRN Handled exception: Email or password is incorrectoffers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:12:39.090 +04:00 DBG Connection ID "18014398515387564061" disconnecting.
2025-04-01 18:12:39.090 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:12:39.091 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:39.091 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:12:39.093 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 404 null application/json 916.9876ms
2025-04-01 18:12:53.691 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-04-01 18:12:53.693 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:12:53.694 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:12:53.694 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:12:53.694 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:12:53.698 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:12:53.698 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:12:53.699 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:12:53.699 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:12:53.699 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:12:53.699 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:12:53.699 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:12:53.700 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:12:53.700 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:12:53.703 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:12:53.704 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:12:53.705 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:12:53.706 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:12:53.706 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:12:53.707 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:12:53.708 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:12:53.708 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:12:53.708 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:12:53.709 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:12:53.710 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:12:53.710 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:12:53.711 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:12:53.711 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:12:53.714 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-04-01 18:12:53.720 +04:00 DBG Creating DbConnection.
2025-04-01 18:12:53.721 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:12:53.721 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:53.721 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:53.721 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:12:53.721 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:53.721 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:12:53.722 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:12:53.724 +04:00 INF Executed DbCommand (2ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:12:53.727 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:12:53.727 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:53.727 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 18:12:53.727 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:53.728 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:12:53.827 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:12:53.832 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:12:53.832 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:12:53.833 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:12:53.836 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:12:53.837 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 18:12:53.860 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 160.281ms
2025-04-01 18:12:53.861 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:12:53.861 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:12:53.861 +04:00 DBG Connection ID "18014398515387564063" disconnecting.
2025-04-01 18:12:53.863 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:12:53.864 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-04-01 18:12:53.866 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 176.1819ms
2025-04-01 18:13:36.101 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 18:13:36.102 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 18:13:36.102 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 18:13:36.103 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:13:36.103 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:13:36.157 +04:00 DBG Successfully validated the token.
2025-04-01 18:13:36.161 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 18:13:36.167 +04:00 DBG Authorization was successful.
2025-04-01 18:13:36.167 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:13:36.172 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 18:13:36.172 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:13:36.172 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:13:36.172 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:13:36.172 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:13:36.172 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:13:36.172 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:13:36.176 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:13:36.180 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:13:36.180 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:13:36.180 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:13:36.180 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:13:36.180 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:13:36.195 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .FirstOrDefault(acc => acc.Id == __id_0)'
2025-04-01 18:13:36.215 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 18:13:36.217 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 18:13:36.280 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 18:13:36.300 +04:00 DBG Creating DbConnection.
2025-04-01 18:13:36.300 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:13:36.300 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:13:36.300 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:13:36.300 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:13:36.301 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:13:36.301 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:13:36.302 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:13:36.318 +04:00 INF Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:13:36.321 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:13:36.340 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:13:36.343 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:13:36.351 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:13:36.351 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 32ms reading results.
2025-04-01 18:13:36.351 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:13:36.351 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:13:36.363 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:13:36.364 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:13:36.364 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:13:36.364 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:13:36.364 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:13:36.364 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.UserResponseModel'.
2025-04-01 18:13:36.371 +04:00 INF Executed action offers.API.Controllers.UserController.GetCurrentUser (offers.API) in 199.0708ms
2025-04-01 18:13:36.372 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:13:36.372 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:13:36.372 +04:00 DBG Connection ID "18086456118015426597" disconnecting.
2025-04-01 18:13:36.372 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:13:36.372 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:13:36.373 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 200 null application/json; charset=utf-8 271.9923ms
2025-04-01 18:14:15.194 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 21
2025-04-01 18:14:15.198 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 18:14:15.199 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 18:14:15.199 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:14:15.199 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:14:15.227 +04:00 DBG Successfully validated the token.
2025-04-01 18:14:15.227 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 18:14:15.230 +04:00 DBG Authorization was successful.
2025-04-01 18:14:15.230 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:14:15.244 +04:00 INF Route matched with {action = "Deposit", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Deposit(offers.API.Models.DepositRequestDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 18:14:15.244 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:14:15.244 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:14:15.244 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:14:15.245 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:14:15.245 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:14:15.245 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:14:15.246 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:14:15.248 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:14:15.248 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 18:14:15.248 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' using the name '' in request data ...
2025-04-01 18:14:15.249 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:14:15.266 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.DepositRequestDTO'
2025-04-01 18:14:15.266 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:14:15.266 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:14:15.266 +04:00 DBG Attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 18:14:15.268 +04:00 DBG Done attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:14:15.269 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:14:15.269 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:14:15.269 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:14:15.269 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:14:20.210 +04:00 INF attempt to make a Deposit
2025-04-01 18:14:24.247 +04:00 DBG Creating DbConnection.
2025-04-01 18:14:24.247 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:14:24.247 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:24.247 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:24.247 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:14:24.248 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:14:24.248 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:14:24.248 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:14:24.275 +04:00 INF Executed DbCommand (26ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:14:24.279 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:14:24.282 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:14:24.282 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:14:24.283 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:24.283 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-04-01 18:14:24.283 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:24.283 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:14:27.728 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:27.729 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:27.729 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:14:27.730 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:14:35.626 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 18:14:35.629 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 18:14:35.653 +04:00 DBG The unchanged property 'UserDetail.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 18:14:35.662 +04:00 DBG An entity of type 'UserDetail' tracked by 'ApplicationDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:14:35.666 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 18:14:35.743 +04:00 DBG Creating transaction savepoint.
2025-04-01 18:14:35.790 +04:00 DBG Created transaction savepoint.
2025-04-01 18:14:35.794 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:14:35.794 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:14:35.797 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (2ms).
2025-04-01 18:14:35.797 +04:00 DBG Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [UserDetails] SET [Balance] = @p0
OUTPUT 1
WHERE [AccountId] = @p1;
2025-04-01 18:14:35.808 +04:00 INF Executed DbCommand (11ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [UserDetails] SET [Balance] = @p0
OUTPUT 1
WHERE [AccountId] = @p1;
2025-04-01 18:14:35.814 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:35.815 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-04-01 18:14:35.822 +04:00 DBG An entity of type 'UserDetail' tracked by 'ApplicationDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:14:35.825 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-04-01 18:14:37.109 +04:00 DBG Committing transaction.
2025-04-01 18:14:37.111 +04:00 DBG Committed transaction.
2025-04-01 18:14:37.113 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:37.113 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:14:37.743 +04:00 DBG Disposing transaction.
2025-04-01 18:14:45.395 +04:00 INF Executing StatusCodeResult, setting HTTP status code 204
2025-04-01 18:14:45.395 +04:00 INF Executed action offers.API.Controllers.UserController.Deposit (offers.API) in 30150.6698ms
2025-04-01 18:14:45.395 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:14:45.397 +04:00 DBG Connection ID "18086456118015426599" disconnecting.
2025-04-01 18:14:50.529 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:14:50.529 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:14:50.529 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:14:51.123 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 204 null null 35931.5087ms
2025-04-01 18:15:07.831 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 18:15:07.831 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 18:15:07.832 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 18:15:07.832 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:15:07.832 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:15:07.833 +04:00 DBG Successfully validated the token.
2025-04-01 18:15:07.834 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 18:15:07.836 +04:00 DBG Authorization was successful.
2025-04-01 18:15:07.837 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:15:07.837 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 18:15:07.837 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:15:07.837 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:15:07.837 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:15:07.837 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:15:07.837 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:15:07.837 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:15:07.844 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:15:07.865 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:15:07.865 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:15:07.865 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:15:07.865 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:15:07.865 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:15:07.867 +04:00 DBG Creating DbConnection.
2025-04-01 18:15:07.867 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:15:07.867 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:15:07.868 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:15:07.868 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:15:07.868 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:15:07.869 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:15:07.869 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:15:07.876 +04:00 INF Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:15:07.905 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:15:07.926 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:15:07.927 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:15:07.927 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:15:07.927 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 51ms reading results.
2025-04-01 18:15:07.927 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:15:07.928 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:15:14.388 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:15:14.388 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:15:14.388 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:15:14.388 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:15:14.388 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:15:14.388 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.UserResponseModel'.
2025-04-01 18:15:14.450 +04:00 INF Executed action offers.API.Controllers.UserController.GetCurrentUser (offers.API) in 6612.6201ms
2025-04-01 18:15:14.450 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:15:14.450 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:15:14.450 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:15:14.450 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:15:14.450 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 200 null application/json; charset=utf-8 6619.3796ms
2025-04-01 18:15:35.830 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 22
2025-04-01 18:15:35.832 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 18:15:35.833 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 18:15:35.833 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:15:35.833 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:15:35.834 +04:00 DBG Successfully validated the token.
2025-04-01 18:15:35.834 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 18:15:35.834 +04:00 DBG Authorization was successful.
2025-04-01 18:15:35.834 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:15:35.835 +04:00 INF Route matched with {action = "Deposit", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Deposit(offers.API.Models.DepositRequestDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 18:15:35.835 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:15:35.835 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:15:35.835 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:15:35.835 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:15:35.835 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:15:35.835 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:15:43.109 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:16:07.200 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:16:07.200 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 18:16:07.200 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' using the name '' in request data ...
2025-04-01 18:16:07.201 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:16:07.276 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.DepositRequestDTO'
2025-04-01 18:16:07.276 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:16:07.277 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:16:07.277 +04:00 DBG Attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 18:16:07.281 +04:00 DBG Done attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:16:07.281 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:16:07.281 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:16:07.281 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:16:07.282 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:16:07.283 +04:00 DBG The request has model state errors, returning an error response.
2025-04-01 18:16:07.285 +04:00 DBG Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-04-01 18:16:07.286 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:16:07.286 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:16:07.287 +04:00 DBG Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-04-01 18:16:07.288 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-04-01 18:16:07.288 +04:00 INF Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-04-01 18:16:07.339 +04:00 INF Executed action offers.API.Controllers.UserController.Deposit (offers.API) in 31503.7258ms
2025-04-01 18:16:07.339 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:16:07.339 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:16:07.339 +04:00 DBG Connection ID "18158513712053354544" disconnecting.
2025-04-01 18:16:07.339 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 400 null application/problem+json; charset=utf-8 31509.3199ms
2025-04-01 18:16:38.122 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/User/deposit - application/json 20
2025-04-01 18:16:38.125 +04:00 DBG 1 candidate(s) found for the request path '/api/User/deposit'
2025-04-01 18:16:38.127 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)' with route pattern 'api/User/deposit' is valid for the request path '/api/User/deposit'
2025-04-01 18:16:38.127 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:16:38.127 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:16:38.130 +04:00 DBG Successfully validated the token.
2025-04-01 18:16:38.131 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 18:16:38.131 +04:00 DBG Authorization was successful.
2025-04-01 18:16:38.131 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:16:38.131 +04:00 INF Route matched with {action = "Deposit", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Deposit(offers.API.Models.DepositRequestDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 18:16:38.132 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:16:38.132 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:16:38.132 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:16:38.132 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:16:38.132 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:16:38.132 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:16:38.133 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:16:38.134 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:16:38.135 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 18:16:38.135 +04:00 DBG Attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' using the name '' in request data ...
2025-04-01 18:16:38.135 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:16:38.135 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.DepositRequestDTO'
2025-04-01 18:16:38.135 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:16:38.135 +04:00 DBG Done attempting to bind parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:16:38.135 +04:00 DBG Attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO' ...
2025-04-01 18:16:38.135 +04:00 DBG Done attempting to validate the bound parameter 'depositDTO' of type 'offers.API.Models.DepositRequestDTO'.
2025-04-01 18:16:38.136 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:16:38.136 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:16:38.136 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:16:38.136 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:16:40.977 +04:00 INF attempt to make a Deposit
2025-04-01 18:16:43.051 +04:00 DBG Creating DbConnection.
2025-04-01 18:16:43.051 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:16:43.051 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:43.052 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:43.052 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:16:43.052 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:16:43.052 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:16:43.052 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:16:43.082 +04:00 INF Executed DbCommand (30ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:16:43.084 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:16:43.087 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:16:43.087 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:16:43.087 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:43.088 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 18:16:43.090 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:43.090 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:16:44.509 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:44.510 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:44.510 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:16:44.511 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:16:49.637 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 18:16:49.637 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 18:16:49.638 +04:00 DBG The unchanged property 'UserDetail.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 18:16:49.638 +04:00 DBG An entity of type 'UserDetail' tracked by 'ApplicationDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:16:49.639 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 18:16:49.641 +04:00 DBG Creating transaction savepoint.
2025-04-01 18:16:49.644 +04:00 DBG Created transaction savepoint.
2025-04-01 18:16:49.645 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:16:49.645 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:16:49.645 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:16:49.646 +04:00 DBG Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [UserDetails] SET [Balance] = @p0
OUTPUT 1
WHERE [AccountId] = @p1;
2025-04-01 18:16:49.680 +04:00 INF Executed DbCommand (35ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [UserDetails] SET [Balance] = @p0
OUTPUT 1
WHERE [AccountId] = @p1;
2025-04-01 18:16:49.681 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:49.681 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 18:16:49.682 +04:00 DBG An entity of type 'UserDetail' tracked by 'ApplicationDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:16:49.682 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-04-01 18:16:50.530 +04:00 DBG Committing transaction.
2025-04-01 18:16:50.532 +04:00 DBG Committed transaction.
2025-04-01 18:16:50.533 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:50.533 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:16:50.815 +04:00 DBG Disposing transaction.
2025-04-01 18:16:54.039 +04:00 INF Executing StatusCodeResult, setting HTTP status code 204
2025-04-01 18:16:54.039 +04:00 INF Executed action offers.API.Controllers.UserController.Deposit (offers.API) in 15907.1625ms
2025-04-01 18:16:54.039 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.Deposit (offers.API)'
2025-04-01 18:16:54.040 +04:00 DBG Connection ID "18086456105130524721" disconnecting.
2025-04-01 18:16:55.010 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:16:55.010 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:16:55.011 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:16:55.570 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/User/deposit - 204 null null 17448.7689ms
2025-04-01 18:17:07.593 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/User - null null
2025-04-01 18:17:07.594 +04:00 DBG 1 candidate(s) found for the request path '/api/User'
2025-04-01 18:17:07.594 +04:00 DBG Endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)' with route pattern 'api/User' is valid for the request path '/api/User'
2025-04-01 18:17:07.594 +04:00 DBG Request matched endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:17:07.594 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:17:07.595 +04:00 DBG Successfully validated the token.
2025-04-01 18:17:07.595 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 18:17:07.596 +04:00 DBG Authorization was successful.
2025-04-01 18:17:07.596 +04:00 INF Executing endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:17:07.596 +04:00 INF Route matched with {action = "GetCurrentUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCurrentUser(System.Threading.CancellationToken) on controller offers.API.Controllers.UserController (offers.API).
2025-04-01 18:17:07.596 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:17:07.596 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:17:07.596 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:17:07.596 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:17:07.596 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:17:07.596 +04:00 DBG Executing controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:17:07.597 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:17:07.598 +04:00 DBG Executed controller factory for controller offers.API.Controllers.UserController (offers.API)
2025-04-01 18:17:07.598 +04:00 DBG Attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:17:07.598 +04:00 DBG Done attempting to bind parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:17:07.598 +04:00 DBG Attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:17:07.598 +04:00 DBG Done attempting to validate the bound parameter 'cancellationToken' of type 'System.Threading.CancellationToken'.
2025-04-01 18:17:07.600 +04:00 DBG Creating DbConnection.
2025-04-01 18:17:07.600 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:17:07.600 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:07.601 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:07.601 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:17:07.601 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:17:07.601 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:17:07.601 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:17:07.604 +04:00 INF Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 18:17:07.607 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:17:07.608 +04:00 DBG The navigation 'Account.UserDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:17:07.608 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:17:07.608 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:07.608 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 18:17:07.609 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:07.609 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:17:07.610 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:17:07.610 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:17:07.610 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:17:07.610 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:17:07.610 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:17:07.610 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.UserResponseModel'.
2025-04-01 18:17:07.611 +04:00 INF Executed action offers.API.Controllers.UserController.GetCurrentUser (offers.API) in 15.3866ms
2025-04-01 18:17:07.612 +04:00 INF Executed endpoint 'offers.API.Controllers.UserController.GetCurrentUser (offers.API)'
2025-04-01 18:17:07.613 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:17:07.613 +04:00 DBG Connection ID "18158513712053354546" disconnecting.
2025-04-01 18:17:07.614 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:07.614 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:17:07.615 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/User - 200 null application/json; charset=utf-8 21.321ms
2025-04-01 18:17:16.105 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:17:16.107 +04:00 DBG Creating DbConnection.
2025-04-01 18:17:16.107 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:17:16.107 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:16.108 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:16.108 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:17:16.109 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:17:16.109 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:17:16.109 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:17:16.114 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:17:16.115 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:16.116 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 18:17:16.116 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:17:16.116 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:18:46.984 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 18:18:47.116 +04:00 INF starting web host
2025-04-01 18:18:47.272 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 18:18:48.499 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:18:48.501 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:18:48.605 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:18:48.824 +04:00 DBG Creating DbConnection.
2025-04-01 18:18:48.869 +04:00 DBG Created DbConnection. (37ms).
2025-04-01 18:18:48.871 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:48.885 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.230 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.235 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:18:49.246 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 18:18:49.252 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (17ms).
2025-04-01 18:18:49.258 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:18:49.293 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:18:49.296 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.306 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-04-01 18:18:49.306 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.308 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.309 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 18:18:49.314 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:18:49.314 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:18:49.315 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:18:49.317 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:18:49.349 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:18:49.445 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:18:49.454 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:18:49.456 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:18:49.456 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:18:49.457 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 18:18:49.458 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:18:49.472 +04:00 INF Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:18:49.474 +04:00 DBG Committing transaction.
2025-04-01 18:18:49.477 +04:00 DBG Committed transaction.
2025-04-01 18:18:49.478 +04:00 DBG Disposing transaction.
2025-04-01 18:18:49.483 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:18:49.483 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:18:49.484 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:18:49.484 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:18:49.485 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:18:49.485 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:18:49.485 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:18:49.486 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:18:49.486 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:18:49.486 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:18:49.486 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:18:49.487 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:18:49.488 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:18:49.488 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:18:49.489 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:18:49.489 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:18:49.493 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:18:49.495 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.497 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 18:18:49.501 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 18:18:49.502 +04:00 DBG Committing transaction.
2025-04-01 18:18:49.502 +04:00 DBG Committed transaction.
2025-04-01 18:18:49.502 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:18:49.502 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:18:49.503 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:18:49.503 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:18:49.509 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:18:49.509 +04:00 DBG Disposing transaction.
2025-04-01 18:18:49.509 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.510 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:18:49.620 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 18:18:49.948 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 18:18:49.990 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.990 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:49.990 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:18:49.990 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:18:49.990 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:18:49.991 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:18:50.002 +04:00 INF Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:18:50.005 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.005 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 18:18:50.005 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.005 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:18:50.007 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:18:50.008 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.009 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:18:50.017 +04:00 DBG Hosting starting
2025-04-01 18:18:50.041 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 18:18:50.073 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 18:18:50.083 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 18:18:50.095 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 18:18:50.101 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:18:50.102 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 18:18:50.105 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:18:50.108 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 18:18:50.110 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 18:18:50.117 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 18:18:50.119 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 18:18:50.161 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:18:50.172 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 18:18:50.232 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 18:18:50.252 +04:00 DBG Creating DbConnection.
2025-04-01 18:18:50.253 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:18:50.254 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.256 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.257 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:18:50.257 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:18:50.257 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:18:50.258 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:18:50.291 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:18:50.304 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.306 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 13ms reading results.
2025-04-01 18:18:50.308 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.309 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:18:50.320 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:18:50.320 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:18:50.321 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:18:50.417 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 18:18:50.418 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 18:18:50.418 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 18:18:50.418 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 18:18:50.474 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 18:18:50.685 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 18:18:50.685 +04:00 INF Hosting environment: Development
2025-04-01 18:18:50.686 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 18:18:50.686 +04:00 DBG Hosting started
2025-04-01 18:18:50.709 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 18:18:50.739 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 18:18:50.740 +04:00 DBG Request did not match any endpoints
2025-04-01 18:18:50.856 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 18:18:50.860 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 18:18:50.935 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 18:18:50.935 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 18:18:50.947 +04:00 DBG Connection ID "18014398519682531371" disconnecting.
2025-04-01 18:18:50.949 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 493.1812ms
2025-04-01 18:18:50.972 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 18:18:50.972 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 18:18:50.987 +04:00 DBG Connection ID "18158513703463419978" disconnecting.
2025-04-01 18:18:50.988 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 6.1024ms
2025-04-01 18:18:51.070 +04:00 DBG Connection ID "17798225728978812960" disconnecting.
2025-04-01 18:18:51.077 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 105.4267ms
2025-04-01 18:18:51.174 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 18:18:51.174 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 18:18:51.175 +04:00 DBG Request did not match any endpoints
2025-04-01 18:18:51.208 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 33.9456ms
2025-04-01 18:22:41.012 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/company/register - application/json 152
2025-04-01 18:22:41.053 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/company/register'
2025-04-01 18:22:41.061 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.Register (offers.API)' with route pattern 'api/Auth/company/register' is valid for the request path '/api/Auth/company/register'
2025-04-01 18:22:41.063 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 18:22:41.070 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:22:41.202 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:22:41.205 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 18:22:41.252 +04:00 INF Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(offers.API.Models.CompanyRegisterDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:22:41.254 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:22:41.255 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:22:41.256 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:22:41.256 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:22:41.256 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:22:41.262 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:22:41.371 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:22:41.373 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:22:41.387 +04:00 DBG Attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' ...
2025-04-01 18:22:41.394 +04:00 DBG Attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' using the name '' in request data ...
2025-04-01 18:22:41.398 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:22:41.447 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.CompanyRegisterDTO'
2025-04-01 18:22:41.447 +04:00 DBG Done attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 18:22:41.448 +04:00 DBG Done attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 18:22:41.448 +04:00 DBG Attempting to validate the bound parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' ...
2025-04-01 18:22:41.462 +04:00 DBG Done attempting to validate the bound parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 18:22:41.464 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:22:41.465 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:22:41.465 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:22:41.465 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:22:41.470 +04:00 INF Register attempt for kirvalidzedachi@gmail.com
2025-04-01 18:22:41.615 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(acc => acc.Email == __Email_0)'
2025-04-01 18:22:41.629 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Accounts AS a
                WHERE a.Email == @__Email_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Accounts AS a
                WHERE a.Email == @__Email_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 18:22:41.647 +04:00 DBG Creating DbConnection.
2025-04-01 18:22:41.648 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:22:41.648 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:41.649 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:41.649 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:22:41.649 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:22:41.654 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-04-01 18:22:41.660 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:22:41.710 +04:00 INF Executed DbCommand (55ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:22:41.714 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:41.715 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 18:22:41.716 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:41.716 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:22:41.962 +04:00 INF Executed action offers.API.Controllers.AuthController.Register (offers.API) in 696.6692ms
2025-04-01 18:22:41.963 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 18:22:41.969 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.AccountAlreadyExistsException: There already is an account with this email
   at offers.Application.Services.Accounts.AccountService.RegisterAsync(Account account, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 54
   at offers.API.Controllers.AuthController.Register(CompanyRegisterDTO companyDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 59
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:22:42.331 +04:00 WRN Handled exception: There already is an account with this emailoffers.Application.Exceptions.AccountAlreadyExistsException: There already is an account with this email
   at offers.Application.Services.Accounts.AccountService.RegisterAsync(Account account, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 54
   at offers.API.Controllers.AuthController.Register(CompanyRegisterDTO companyDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 59
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:22:42.336 +04:00 DBG Connection ID "18158513703463419980" disconnecting.
2025-04-01 18:22:42.336 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:22:42.336 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:42.337 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:22:42.338 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/company/register - 409 null application/json 1327.4256ms
2025-04-01 18:22:56.742 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/company/register - application/json 153
2025-04-01 18:22:56.746 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/company/register'
2025-04-01 18:22:56.747 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.Register (offers.API)' with route pattern 'api/Auth/company/register' is valid for the request path '/api/Auth/company/register'
2025-04-01 18:22:56.747 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 18:22:56.748 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:22:56.750 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:22:56.751 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 18:22:56.751 +04:00 INF Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(offers.API.Models.CompanyRegisterDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:22:56.752 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:22:56.752 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:22:56.752 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:22:56.753 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:22:56.753 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:22:56.753 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:22:56.758 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:22:56.758 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:22:56.760 +04:00 DBG Attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' ...
2025-04-01 18:22:56.761 +04:00 DBG Attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' using the name '' in request data ...
2025-04-01 18:22:56.761 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:22:56.763 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.CompanyRegisterDTO'
2025-04-01 18:22:56.763 +04:00 DBG Done attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 18:22:56.764 +04:00 DBG Done attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 18:22:56.764 +04:00 DBG Attempting to validate the bound parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' ...
2025-04-01 18:22:56.767 +04:00 DBG Done attempting to validate the bound parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 18:22:56.768 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:22:56.769 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:22:56.769 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:22:56.770 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:22:56.771 +04:00 INF Register attempt for kirvalidzedachi1@gmail.com
2025-04-01 18:22:56.777 +04:00 DBG Creating DbConnection.
2025-04-01 18:22:56.777 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:22:56.778 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:56.778 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:56.778 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:22:56.779 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:22:56.779 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:22:56.779 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:22:56.786 +04:00 INF Executed DbCommand (7ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:22:56.787 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:56.787 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-04-01 18:22:56.787 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:56.787 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:22:56.849 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:22:56.959 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:22:57.018 +04:00 DBG The navigation 'CompanyDetail.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:22:57.034 +04:00 DBG Context 'ApplicationDbContext' started tracking 'CompanyDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:22:57.044 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 18:22:57.054 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 18:22:57.083 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 18:22:57.191 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:57.192 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:57.193 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:22:57.194 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:22:57.197 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:22:57.197 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:22:57.197 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:22:57.197 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 18:22:57.210 +04:00 INF Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 18:22:57.220 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 18:22:57.225 +04:00 DBG The foreign key property 'CompanyDetail.AccountId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 18:22:57.230 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:57.230 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 19ms reading results.
2025-04-01 18:22:57.231 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:22:57.232 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:22:57.232 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:22:57.233 +04:00 DBG Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Size = 255) (DbType = AnsiString), @p6='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CompanyDetails] ([AccountId], [CompanyName], [IsActive])
VALUES (@p4, @p5, @p6);
2025-04-01 18:22:57.239 +04:00 INF Executed DbCommand (7ms) [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Size = 255) (DbType = AnsiString), @p6='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CompanyDetails] ([AccountId], [CompanyName], [IsActive])
VALUES (@p4, @p5, @p6);
2025-04-01 18:22:57.239 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:57.240 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 18:22:57.245 +04:00 DBG Committing transaction.
2025-04-01 18:22:57.247 +04:00 DBG Committed transaction.
2025-04-01 18:22:57.250 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:57.250 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:22:57.251 +04:00 DBG Disposing transaction.
2025-04-01 18:22:57.268 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:22:57.269 +04:00 DBG An entity of type 'CompanyDetail' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:22:57.271 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 2 entities written to the database.
2025-04-01 18:22:57.280 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:22:57.282 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:22:57.282 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:22:57.283 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:22:57.284 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:22:57.285 +04:00 INF Executing CreatedAtActionResult, writing value of type 'offers.Application.Models.AccountResponseModel'.
2025-04-01 18:22:57.309 +04:00 DBG Found the endpoints ["offers.API.Controllers.CompanyController.GetCurrentCompany (offers.API)"] for address (action=[GetCurrentCompany],controller=[Company])
2025-04-01 18:22:57.312 +04:00 DBG Successfully processed template api/Company for offers.API.Controllers.CompanyController.GetCurrentCompany (offers.API) resulting in /api/Company and 
2025-04-01 18:22:57.314 +04:00 DBG Link generation succeeded for endpoints ["offers.API.Controllers.CompanyController.GetCurrentCompany (offers.API)"] with result /api/Company
2025-04-01 18:22:57.330 +04:00 INF Executed action offers.API.Controllers.AuthController.Register (offers.API) in 577.2583ms
2025-04-01 18:22:57.331 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 18:22:57.331 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:22:57.331 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:22:57.332 +04:00 DBG Connection ID "18014398515387564071" disconnecting.
2025-04-01 18:22:57.332 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:22:57.332 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/company/register - 201 null application/json; charset=utf-8 590.117ms
2025-04-01 18:23:50.331 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:23:50.370 +04:00 DBG Creating DbConnection.
2025-04-01 18:23:50.370 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:23:50.370 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:23:50.370 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:23:50.370 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:23:50.371 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:23:50.371 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:23:50.371 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:23:50.391 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:23:50.392 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:23:50.393 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 18:23:50.393 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:23:50.394 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:23:50.394 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:23:50.395 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:23:50.395 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:25:33.531 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 64
2025-04-01 18:25:33.533 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:25:33.534 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:25:33.551 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:25:33.552 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:25:33.556 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:25:33.556 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:25:33.568 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:25:33.569 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:25:33.569 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:25:33.569 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:25:33.569 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:25:33.569 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:25:33.570 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:25:33.577 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:25:33.581 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:25:33.585 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:25:33.587 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:25:33.587 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:25:33.589 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:25:33.589 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:25:33.589 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:25:33.589 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:25:33.590 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:25:33.590 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:25:33.590 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:25:33.590 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:25:33.590 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:25:33.593 +04:00 INF Login attempt for kirvalidzedachi1@gmail.com
2025-04-01 18:25:33.598 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 18:25:33.609 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 18:25:33.616 +04:00 DBG Creating DbConnection.
2025-04-01 18:25:33.616 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:25:33.616 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:25:33.616 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:25:33.616 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:25:33.616 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:25:33.616 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:25:33.616 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:25:33.628 +04:00 INF Executed DbCommand (11ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:25:33.632 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:25:33.633 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:25:33.633 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-04-01 18:25:33.633 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:25:33.633 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:25:33.687 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 18:25:33.687 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 18:25:33.687 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 18:25:33.687 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 18:25:33.688 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 18:25:33.688 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 18:25:33.690 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 120.3316ms
2025-04-01 18:25:33.690 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:25:33.691 +04:00 DBG Connection ID "18014398515387564073" disconnecting.
2025-04-01 18:25:33.691 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:25:33.691 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:25:33.695 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-04-01 18:25:33.695 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 164.6785ms
2025-04-01 18:27:23.711 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 18:27:23.711 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:27:23.711 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:27:23.711 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:23.712 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:27:23.712 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:27:23.712 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:23.712 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:27:23.712 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:27:23.712 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:27:23.713 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:27:23.713 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:27:23.713 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:27:23.713 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:27:23.715 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:27:23.715 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:27:23.716 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:27:23.716 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:27:23.716 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:27:23.717 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:27:23.717 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:23.717 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:23.717 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:27:23.717 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:23.717 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:27:23.717 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:27:23.717 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:27:23.717 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:27:23.717 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 18:27:23.718 +04:00 DBG Creating DbConnection.
2025-04-01 18:27:23.719 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:27:23.719 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:23.719 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:23.719 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:27:23.719 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:27:23.719 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:27:23.720 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:27:23.751 +04:00 INF Executed DbCommand (32ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:27:23.753 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:27:23.753 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:23.754 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 18:27:23.755 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:23.755 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:27:23.889 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 176.4269ms
2025-04-01 18:27:23.890 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:23.891 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:27:23.897 +04:00 WRN Handled exception: Email or password is incorrectoffers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:27:23.901 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:27:23.901 +04:00 DBG Connection ID "18014398515387564075" disconnecting.
2025-04-01 18:27:23.901 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:23.902 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:27:23.902 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 404 null application/json 191.537ms
2025-04-01 18:27:41.533 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 18:27:41.533 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:27:41.533 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:27:41.533 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:41.533 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:27:41.534 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:27:41.534 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:41.534 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:27:41.534 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:27:41.534 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:27:41.534 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:27:41.534 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:27:41.534 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:27:41.534 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:27:41.536 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:27:41.536 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:27:41.537 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:27:41.537 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:27:41.537 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:27:41.537 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:27:41.537 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:41.537 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:41.538 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:27:41.538 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:41.538 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:27:41.538 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:27:41.538 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:27:41.538 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:27:41.538 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 18:27:41.539 +04:00 DBG Creating DbConnection.
2025-04-01 18:27:41.539 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:27:41.539 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:41.539 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:41.539 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:27:41.539 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:27:41.540 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:27:41.540 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:27:41.559 +04:00 INF Executed DbCommand (20ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:27:41.560 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:27:41.560 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:41.561 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-04-01 18:27:41.561 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:41.561 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:27:41.647 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 112.6009ms
2025-04-01 18:27:41.648 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:41.649 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:27:41.652 +04:00 WRN Handled exception: Email or password is incorrectoffers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:27:41.655 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:27:41.655 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:41.655 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:27:41.655 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 404 null application/json 122.3402ms
2025-04-01 18:27:41.655 +04:00 DBG Connection ID "18014398519682531376" disconnecting.
2025-04-01 18:27:42.344 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 18:27:42.344 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 18:27:42.344 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 18:27:42.344 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:42.345 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 18:27:42.346 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 18:27:42.346 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:42.346 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 18:27:42.346 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 18:27:42.346 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 18:27:42.346 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 18:27:42.346 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 18:27:42.346 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 18:27:42.347 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:27:42.348 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:27:42.348 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 18:27:42.348 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:27:42.349 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 18:27:42.349 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 18:27:42.349 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 18:27:42.349 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:42.349 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:42.349 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 18:27:42.349 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 18:27:42.349 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:27:42.349 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:27:42.349 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 18:27:42.349 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 18:27:42.349 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 18:27:42.350 +04:00 DBG Creating DbConnection.
2025-04-01 18:27:42.350 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:27:42.350 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:42.350 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:42.350 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:27:42.350 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:27:42.351 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:27:42.351 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:27:42.368 +04:00 INF Executed DbCommand (17ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 18:27:42.369 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:27:42.369 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:42.370 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-04-01 18:27:42.370 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:42.370 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:27:42.457 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 110.2681ms
2025-04-01 18:27:42.457 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 18:27:42.458 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:27:42.461 +04:00 WRN Handled exception: Email or password is incorrectoffers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 18:27:42.466 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:27:42.466 +04:00 DBG Connection ID "17798225728978812963" disconnecting.
2025-04-01 18:27:42.466 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:27:42.466 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:27:42.467 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 404 null application/json 123.0886ms
2025-04-01 18:28:50.412 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:28:50.415 +04:00 DBG Creating DbConnection.
2025-04-01 18:28:50.416 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:28:50.416 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:28:50.416 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:28:50.416 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:28:50.416 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:28:50.417 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:28:50.417 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:28:50.445 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:28:50.445 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:28:50.445 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 18:28:50.446 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:28:50.446 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:28:50.446 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:28:50.446 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:28:50.446 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:54:43.752 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 18:54:43.912 +04:00 INF starting web host
2025-04-01 18:54:44.137 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 18:54:44.888 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:54:44.889 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 18:54:44.987 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:54:45.143 +04:00 DBG Creating DbConnection.
2025-04-01 18:54:45.212 +04:00 DBG Created DbConnection. (67ms).
2025-04-01 18:54:45.214 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.237 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.642 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.652 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:54:45.664 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 18:54:45.667 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (17ms).
2025-04-01 18:54:45.690 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:54:45.745 +04:00 INF Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:54:45.748 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.759 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-04-01 18:54:45.759 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.760 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.762 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 18:54:45.765 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:54:45.765 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:54:45.765 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:54:45.766 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:54:45.786 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 18:54:45.878 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:54:45.887 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:54:45.888 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:54:45.889 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:54:45.890 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 18:54:45.890 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:54:45.893 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 18:54:45.895 +04:00 DBG Committing transaction.
2025-04-01 18:54:45.901 +04:00 DBG Committed transaction.
2025-04-01 18:54:45.903 +04:00 DBG Disposing transaction.
2025-04-01 18:54:45.906 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 18:54:45.907 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 18:54:45.910 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 18:54:45.910 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:54:45.910 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 18:54:45.910 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:54:45.912 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 18:54:45.912 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:54:45.912 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:54:45.912 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:54:45.913 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:54:45.915 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 18:54:45.918 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:54:45.918 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:54:45.918 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:54:45.919 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:54:45.923 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 18:54:45.927 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.929 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 18:54:45.936 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 18:54:45.937 +04:00 DBG Committing transaction.
2025-04-01 18:54:45.937 +04:00 DBG Committed transaction.
2025-04-01 18:54:45.937 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 18:54:45.938 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:54:45.938 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 18:54:45.938 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:54:45.940 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 18:54:45.940 +04:00 DBG Disposing transaction.
2025-04-01 18:54:45.940 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:45.941 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:54:46.014 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 18:54:46.289 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 18:54:46.329 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.330 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.330 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:54:46.333 +04:00 DBG Created DbCommand for 'ExecuteReader' (2ms).
2025-04-01 18:54:46.334 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (3ms).
2025-04-01 18:54:46.334 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:54:46.344 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 18:54:46.348 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.348 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 18:54:46.348 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.348 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:54:46.387 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:54:46.489 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:54:46.493 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 18:54:46.497 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 18:54:46.512 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 18:54:46.582 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.585 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.589 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:54:46.590 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:54:46.593 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (3ms).
2025-04-01 18:54:46.596 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 18:54:46.637 +04:00 INF Executed DbCommand (44ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 18:54:46.654 +04:00 DBG Hosting starting
2025-04-01 18:54:46.659 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 18:54:46.690 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.692 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 18:54:46.692 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 54ms reading results.
2025-04-01 18:54:46.696 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.697 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:54:46.709 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 18:54:46.712 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-04-01 18:54:46.715 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:54:46.719 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 18:54:46.719 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.720 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 18:54:46.733 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 18:54:46.747 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 18:54:46.752 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:54:46.753 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 18:54:46.756 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 18:54:46.758 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 18:54:46.760 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 18:54:46.764 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 18:54:46.766 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 18:54:46.798 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 18:54:46.806 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 18:54:46.850 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 18:54:46.862 +04:00 DBG Creating DbConnection.
2025-04-01 18:54:46.863 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 18:54:46.863 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.863 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.863 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 18:54:46.863 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:54:46.864 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 18:54:46.864 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:54:46.873 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 18:54:46.879 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.879 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-04-01 18:54:46.879 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.879 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 18:54:46.881 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 18:54:46.881 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 18:54:46.881 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 18:54:47.024 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 18:54:47.025 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 18:54:47.025 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 18:54:47.025 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 18:54:47.103 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 18:54:47.311 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 18:54:47.311 +04:00 INF Hosting environment: Development
2025-04-01 18:54:47.311 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 18:54:47.311 +04:00 DBG Hosting started
2025-04-01 18:54:47.366 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 18:54:47.389 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 18:54:47.390 +04:00 DBG Request did not match any endpoints
2025-04-01 18:54:47.516 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 18:54:47.520 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 18:54:47.630 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 18:54:47.631 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 18:54:47.647 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 549.5957ms
2025-04-01 18:54:47.647 +04:00 DBG Connection ID "18086456105130524726" disconnecting.
2025-04-01 18:54:47.715 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 18:54:47.776 +04:00 DBG Connection ID "18014398515387564080" disconnecting.
2025-04-01 18:54:47.777 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.8434ms
2025-04-01 18:54:47.807 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 18:54:47.933 +04:00 DBG Connection ID "18014398519682531380" disconnecting.
2025-04-01 18:54:47.935 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 127.8013ms
2025-04-01 18:54:48.243 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 18:54:48.244 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 18:54:48.244 +04:00 DBG Request did not match any endpoints
2025-04-01 18:54:48.274 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.6724ms
2025-04-01 19:01:44.648 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 19:01:44.952 +04:00 INF starting web host
2025-04-01 19:01:45.171 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 19:01:46.085 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:01:46.086 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:01:46.195 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:01:46.399 +04:00 DBG Creating DbConnection.
2025-04-01 19:01:46.449 +04:00 DBG Created DbConnection. (44ms).
2025-04-01 19:01:46.452 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:46.469 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:46.822 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:46.832 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:01:46.843 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-04-01 19:01:46.845 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-04-01 19:01:46.851 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:01:46.887 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:01:46.890 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:46.901 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (7ms).
2025-04-01 19:01:46.901 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:46.903 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:46.905 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 19:01:46.908 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:01:46.909 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:01:46.909 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:01:46.910 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:01:46.935 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:01:47.036 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:01:47.050 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:01:47.051 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:01:47.052 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:01:47.053 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 19:01:47.053 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:01:47.055 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:01:47.057 +04:00 DBG Committing transaction.
2025-04-01 19:01:47.064 +04:00 DBG Committed transaction.
2025-04-01 19:01:47.066 +04:00 DBG Disposing transaction.
2025-04-01 19:01:47.070 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:01:47.070 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:01:47.073 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:01:47.073 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:01:47.073 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:01:47.073 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:01:47.074 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:01:47.077 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:01:47.077 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:01:47.077 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:01:47.078 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:01:47.080 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:01:47.083 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:01:47.083 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:01:47.083 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:01:47.084 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:01:47.088 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:01:47.091 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.094 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:01:47.101 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 19:01:47.101 +04:00 DBG Committing transaction.
2025-04-01 19:01:47.102 +04:00 DBG Committed transaction.
2025-04-01 19:01:47.102 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:01:47.102 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:01:47.102 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:01:47.103 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:01:47.106 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:01:47.106 +04:00 DBG Disposing transaction.
2025-04-01 19:01:47.106 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.107 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-04-01 19:01:47.198 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 19:01:47.598 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 19:01:47.657 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.658 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.659 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:01:47.660 +04:00 DBG Created DbCommand for 'ExecuteReader' (1ms).
2025-04-01 19:01:47.660 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-04-01 19:01:47.661 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:01:47.666 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:01:47.670 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.670 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:01:47.670 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.671 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:01:47.733 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:01:47.800 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:01:47.804 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 19:01:47.806 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 19:01:47.822 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 19:01:47.930 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.934 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:47.939 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:01:47.939 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:01:47.948 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (9ms).
2025-04-01 19:01:47.951 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:01:47.998 +04:00 INF Executed DbCommand (49ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:01:48.006 +04:00 DBG Hosting starting
2025-04-01 19:01:48.016 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:01:48.036 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 19:01:48.040 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.043 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 45ms reading results.
2025-04-01 19:01:48.046 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.047 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:01:48.055 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 19:01:48.061 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:01:48.064 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-04-01 19:01:48.067 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:01:48.069 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.069 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 19:01:48.070 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 19:01:48.088 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 19:01:48.098 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:01:48.099 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 19:01:48.102 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:01:48.103 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 19:01:48.105 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 19:01:48.110 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 19:01:48.112 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 19:01:48.164 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:01:48.178 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 19:01:48.241 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:01:48.255 +04:00 DBG Creating DbConnection.
2025-04-01 19:01:48.256 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:01:48.256 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.257 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.257 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:01:48.257 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:01:48.257 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:01:48.257 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:01:48.266 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:01:48.271 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.271 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:01:48.271 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.272 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:01:48.272 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:01:48.273 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:01:48.273 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:01:48.383 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 19:01:48.383 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 19:01:48.383 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 19:01:48.383 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 19:01:48.469 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 19:01:48.634 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 19:01:48.653 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 19:01:48.653 +04:00 INF Hosting environment: Development
2025-04-01 19:01:48.653 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 19:01:48.653 +04:00 DBG Hosting started
2025-04-01 19:01:48.670 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 19:01:48.671 +04:00 DBG Request did not match any endpoints
2025-04-01 19:01:48.801 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 19:01:48.804 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 19:01:48.901 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 19:01:48.902 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 19:01:49.004 +04:00 DBG Connection ID "18014398515387564086" disconnecting.
2025-04-01 19:01:49.006 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 536.4427ms
2025-04-01 19:01:49.006 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 19:01:49.088 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 19:01:49.106 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 19.5885ms
2025-04-01 19:01:49.148 +04:00 DBG Connection ID "18374686485577203769" disconnecting.
2025-04-01 19:01:49.151 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 145.8856ms
2025-04-01 19:01:49.337 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 19:01:49.337 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 19:01:49.337 +04:00 DBG Request did not match any endpoints
2025-04-01 19:01:49.378 +04:00 DBG Connection ID "18374686485577203771" disconnecting.
2025-04-01 19:01:49.379 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 41.9016ms
2025-04-01 19:02:25.416 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/user/register - application/json 142
2025-04-01 19:02:25.469 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/user/register'
2025-04-01 19:02:25.474 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.Register (offers.API)' with route pattern 'api/Auth/user/register' is valid for the request path '/api/Auth/user/register'
2025-04-01 19:02:25.476 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 19:02:25.482 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:02:25.573 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:02:25.576 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 19:02:25.611 +04:00 INF Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(offers.API.Models.UserRegisterDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:02:25.614 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:02:25.615 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:02:25.616 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:02:25.616 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:02:25.616 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:02:25.619 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:02:25.717 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:02:25.719 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:02:25.730 +04:00 DBG Attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO' ...
2025-04-01 19:02:25.733 +04:00 DBG Attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO' using the name '' in request data ...
2025-04-01 19:02:25.738 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:02:25.768 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.UserRegisterDTO'
2025-04-01 19:02:25.768 +04:00 DBG Done attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO'.
2025-04-01 19:02:25.768 +04:00 DBG Done attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO'.
2025-04-01 19:02:25.769 +04:00 DBG Attempting to validate the bound parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO' ...
2025-04-01 19:02:25.781 +04:00 DBG Done attempting to validate the bound parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO'.
2025-04-01 19:02:25.782 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:02:25.783 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:02:25.783 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:02:25.783 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:02:25.786 +04:00 INF Register attempt for kirvalidzedachi@gmail.com
2025-04-01 19:02:25.924 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(acc => acc.Email == __Email_0)'
2025-04-01 19:02:25.929 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Accounts AS a
                WHERE a.Email == @__Email_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Accounts AS a
                WHERE a.Email == @__Email_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:02:25.944 +04:00 DBG Creating DbConnection.
2025-04-01 19:02:25.945 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:02:25.945 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:25.946 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:25.946 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:02:25.946 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:02:25.946 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:02:25.947 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:02:25.958 +04:00 INF Executed DbCommand (11ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:02:25.961 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:25.962 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:02:25.962 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:25.962 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:02:25.981 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:02:25.982 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:02:26.002 +04:00 DBG The navigation 'UserDetail.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:02:26.009 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:02:26.010 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 19:02:26.010 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 19:02:26.016 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 19:02:26.025 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:26.025 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:26.026 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:02:26.027 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:02:26.027 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:02:26.027 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:02:26.027 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:02:26.027 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:02:26.030 +04:00 INF Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:02:26.031 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:02:26.032 +04:00 DBG The foreign key property 'UserDetail.AccountId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:02:26.035 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:26.035 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:02:26.036 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:02:26.036 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:02:26.038 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-04-01 19:02:26.039 +04:00 DBG Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (Size = 100) (DbType = AnsiString), @p7='?' (Size = 100) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserDetails] ([AccountId], [Balance], [FirstName], [LastName])
VALUES (@p4, @p5, @p6, @p7);
2025-04-01 19:02:26.047 +04:00 INF Executed DbCommand (9ms) [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (Size = 100) (DbType = AnsiString), @p7='?' (Size = 100) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserDetails] ([AccountId], [Balance], [FirstName], [LastName])
VALUES (@p4, @p5, @p6, @p7);
2025-04-01 19:02:26.048 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:26.048 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 19:02:26.050 +04:00 DBG Committing transaction.
2025-04-01 19:02:26.051 +04:00 DBG Committed transaction.
2025-04-01 19:02:26.053 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:26.054 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:02:26.055 +04:00 DBG Disposing transaction.
2025-04-01 19:02:26.056 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:02:26.057 +04:00 DBG An entity of type 'UserDetail' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:02:26.057 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 2 entities written to the database.
2025-04-01 19:02:26.065 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:02:26.067 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:02:26.067 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:02:26.067 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:02:26.069 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:02:26.069 +04:00 INF Executing CreatedAtActionResult, writing value of type 'offers.Application.Models.AccountResponseModel'.
2025-04-01 19:02:26.090 +04:00 DBG Found the endpoints ["offers.API.Controllers.UserController.GetCurrentUser (offers.API)"] for address (action=[GetCurrentUser],controller=[User])
2025-04-01 19:02:26.094 +04:00 DBG Successfully processed template api/User for offers.API.Controllers.UserController.GetCurrentUser (offers.API) resulting in /api/User and 
2025-04-01 19:02:26.096 +04:00 DBG Link generation succeeded for endpoints ["offers.API.Controllers.UserController.GetCurrentUser (offers.API)"] with result /api/User
2025-04-01 19:02:26.118 +04:00 INF Executed action offers.API.Controllers.AuthController.Register (offers.API) in 495.467ms
2025-04-01 19:02:26.119 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 19:02:26.121 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:02:26.121 +04:00 DBG Connection ID "18374686485577203773" disconnecting.
2025-04-01 19:02:26.122 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:02:26.122 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:02:26.124 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/user/register - 201 null application/json; charset=utf-8 707.7533ms
2025-04-01 19:03:50.350 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/company/register - application/json 151
2025-04-01 19:03:50.393 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/company/register'
2025-04-01 19:03:50.393 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.Register (offers.API)' with route pattern 'api/Auth/company/register' is valid for the request path '/api/Auth/company/register'
2025-04-01 19:03:50.394 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 19:03:50.395 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:03:50.402 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:03:50.402 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 19:03:50.431 +04:00 INF Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(offers.API.Models.CompanyRegisterDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:03:50.431 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:03:50.431 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:03:50.431 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:03:50.432 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:03:50.432 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:03:50.432 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:03:50.438 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:03:50.438 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:03:50.440 +04:00 DBG Attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' ...
2025-04-01 19:03:50.440 +04:00 DBG Attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' using the name '' in request data ...
2025-04-01 19:03:50.441 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:03:50.447 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.CompanyRegisterDTO'
2025-04-01 19:03:50.447 +04:00 DBG Done attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 19:03:50.448 +04:00 DBG Done attempting to bind parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 19:03:50.448 +04:00 DBG Attempting to validate the bound parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO' ...
2025-04-01 19:03:50.451 +04:00 DBG Done attempting to validate the bound parameter 'companyDTO' of type 'offers.API.Models.CompanyRegisterDTO'.
2025-04-01 19:03:50.451 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:03:50.452 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:03:50.452 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:03:50.452 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:03:50.454 +04:00 INF Register attempt for kirvalidzedachi1@gmail.com
2025-04-01 19:03:50.494 +04:00 DBG Creating DbConnection.
2025-04-01 19:03:50.494 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:03:50.494 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.495 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.495 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:03:50.495 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:03:50.495 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:03:50.498 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:03:50.519 +04:00 INF Executed DbCommand (22ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:03:50.520 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.521 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-04-01 19:03:50.521 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.521 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:03:50.522 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:03:50.523 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:03:50.541 +04:00 DBG The navigation 'CompanyDetail.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:03:50.542 +04:00 DBG Context 'ApplicationDbContext' started tracking 'CompanyDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:03:50.542 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 19:03:50.543 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 19:03:50.556 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 19:03:50.559 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.559 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.559 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:03:50.560 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:03:50.560 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:03:50.560 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:03:50.560 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:03:50.561 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:03:50.565 +04:00 INF Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:03:50.566 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:03:50.568 +04:00 DBG The foreign key property 'CompanyDetail.AccountId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:03:50.571 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.572 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-04-01 19:03:50.572 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:03:50.572 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:03:50.573 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:03:50.573 +04:00 DBG Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Size = 255) (DbType = AnsiString), @p6='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CompanyDetails] ([AccountId], [CompanyName], [IsActive])
VALUES (@p4, @p5, @p6);
2025-04-01 19:03:50.578 +04:00 INF Executed DbCommand (5ms) [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Size = 255) (DbType = AnsiString), @p6='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CompanyDetails] ([AccountId], [CompanyName], [IsActive])
VALUES (@p4, @p5, @p6);
2025-04-01 19:03:50.578 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.579 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 19:03:50.580 +04:00 DBG Committing transaction.
2025-04-01 19:03:50.581 +04:00 DBG Committed transaction.
2025-04-01 19:03:50.582 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.582 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:03:50.582 +04:00 DBG Disposing transaction.
2025-04-01 19:03:50.582 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:03:50.584 +04:00 DBG An entity of type 'CompanyDetail' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:03:50.584 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 2 entities written to the database.
2025-04-01 19:03:50.585 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:03:50.586 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:03:50.586 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:03:50.586 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:03:50.587 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:03:50.587 +04:00 INF Executing CreatedAtActionResult, writing value of type 'offers.Application.Models.AccountResponseModel'.
2025-04-01 19:03:50.589 +04:00 DBG Found the endpoints ["offers.API.Controllers.CompanyController.GetCurrentCompany (offers.API)"] for address (action=[GetCurrentCompany],controller=[Company])
2025-04-01 19:03:50.590 +04:00 DBG Successfully processed template api/Company for offers.API.Controllers.CompanyController.GetCurrentCompany (offers.API) resulting in /api/Company and 
2025-04-01 19:03:50.590 +04:00 DBG Link generation succeeded for endpoints ["offers.API.Controllers.CompanyController.GetCurrentCompany (offers.API)"] with result /api/Company
2025-04-01 19:03:50.591 +04:00 INF Executed action offers.API.Controllers.AuthController.Register (offers.API) in 158.4787ms
2025-04-01 19:03:50.591 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-04-01 19:03:50.592 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:03:50.592 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:03:50.592 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:03:50.592 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/company/register - 201 null application/json; charset=utf-8 246.7031ms
2025-04-01 19:03:50.592 +04:00 DBG Connection ID "17870283331606675471" disconnecting.
2025-04-01 19:04:40.225 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 19:04:40.225 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 19:04:40.225 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 19:04:40.226 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:04:40.226 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:04:40.232 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:04:40.233 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:04:40.252 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:04:40.253 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:04:40.253 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:04:40.253 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:04:40.253 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:04:40.253 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:04:40.253 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:04:40.262 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:04:40.264 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:04:40.264 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:04:40.265 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 19:04:40.265 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:04:40.267 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 19:04:40.267 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:04:40.267 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:04:40.267 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:04:40.268 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:04:40.268 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:04:40.268 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:04:40.268 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:04:40.268 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:04:40.270 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 19:04:40.273 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 19:04:40.286 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:04:40.291 +04:00 DBG Creating DbConnection.
2025-04-01 19:04:40.292 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:04:40.292 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:04:40.293 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:04:40.293 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:04:40.293 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:04:40.294 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:04:40.294 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:04:40.302 +04:00 INF Executed DbCommand (8ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:04:40.314 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:04:40.315 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:04:40.315 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 10ms reading results.
2025-04-01 19:04:40.315 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:04:40.315 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:04:40.472 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 218.4809ms
2025-04-01 19:04:40.473 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:04:40.478 +04:00 ERR An unhandled exception has occurred while executing the request.offers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 19:04:40.765 +04:00 WRN Handled exception: Email or password is incorrectoffers.Application.Exceptions.Account.AccountNotFoundException: Email or password is incorrect
   at offers.Application.Services.Accounts.AccountService.LoginAsync(String Email, String password, CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Accounts\AccountService.cs:line 42
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 73
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-04-01 19:04:40.770 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:04:40.770 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:04:40.770 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:04:40.770 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 404 null application/json 546.0157ms
2025-04-01 19:06:48.282 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:06:48.288 +04:00 DBG Creating DbConnection.
2025-04-01 19:06:48.288 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:06:48.288 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:06:48.289 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:06:48.289 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:06:48.289 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:06:48.289 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:06:48.289 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:06:48.296 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:06:48.296 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:06:48.296 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 19:06:48.296 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:06:48.296 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:06:48.297 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:06:48.297 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:06:48.297 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:07:35.065 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 19:07:35.181 +04:00 INF starting web host
2025-04-01 19:07:35.302 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 19:07:36.148 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:07:36.149 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:07:36.229 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:07:36.408 +04:00 DBG Creating DbConnection.
2025-04-01 19:07:36.502 +04:00 DBG Created DbConnection. (92ms).
2025-04-01 19:07:36.504 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:36.516 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:36.800 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:36.804 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:07:36.810 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-04-01 19:07:36.812 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-04-01 19:07:36.817 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:07:36.840 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:07:36.842 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:36.849 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-04-01 19:07:36.850 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:36.851 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:36.852 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 19:07:36.854 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:07:36.854 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:07:36.854 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:07:36.855 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:07:36.875 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:07:36.969 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:07:36.980 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:07:36.982 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:07:36.982 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:07:36.984 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 19:07:36.984 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:07:36.987 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:07:36.990 +04:00 DBG Committing transaction.
2025-04-01 19:07:36.995 +04:00 DBG Committed transaction.
2025-04-01 19:07:36.996 +04:00 DBG Disposing transaction.
2025-04-01 19:07:36.999 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:07:36.999 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:07:37.001 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:07:37.001 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:07:37.001 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:07:37.001 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:07:37.002 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:07:37.003 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:07:37.003 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:07:37.003 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:07:37.003 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:07:37.004 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:07:37.006 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:07:37.006 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:07:37.006 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:07:37.007 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:07:37.011 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:07:37.015 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.017 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:07:37.023 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 19:07:37.023 +04:00 DBG Committing transaction.
2025-04-01 19:07:37.023 +04:00 DBG Committed transaction.
2025-04-01 19:07:37.024 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:07:37.024 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:07:37.024 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:07:37.024 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:07:37.027 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:07:37.028 +04:00 DBG Disposing transaction.
2025-04-01 19:07:37.028 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.028 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:07:37.108 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 19:07:37.438 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 19:07:37.490 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.490 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.490 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:07:37.490 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:07:37.491 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:07:37.491 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:07:37.496 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:07:37.499 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.499 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:07:37.500 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.500 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:07:37.501 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:07:37.503 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.505 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 19:07:37.510 +04:00 DBG Hosting starting
2025-04-01 19:07:37.534 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 19:07:37.564 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 19:07:37.576 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 19:07:37.585 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 19:07:37.589 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:07:37.589 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 19:07:37.591 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:07:37.593 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 19:07:37.594 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 19:07:37.596 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 19:07:37.597 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 19:07:37.621 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:07:37.631 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 19:07:37.715 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:07:37.733 +04:00 DBG Creating DbConnection.
2025-04-01 19:07:37.733 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:07:37.735 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.738 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.738 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:07:37.739 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:07:37.739 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:07:37.739 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:07:37.761 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:07:37.778 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.779 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 18ms reading results.
2025-04-01 19:07:37.783 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.783 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:07:37.785 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:07:37.785 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:07:37.785 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:07:37.870 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 19:07:37.870 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 19:07:37.870 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 19:07:37.870 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 19:07:37.918 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 19:07:38.082 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 19:07:38.095 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 19:07:38.095 +04:00 INF Hosting environment: Development
2025-04-01 19:07:38.095 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 19:07:38.096 +04:00 DBG Hosting started
2025-04-01 19:07:38.112 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 19:07:38.113 +04:00 DBG Request did not match any endpoints
2025-04-01 19:07:38.216 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 19:07:38.219 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 19:07:38.288 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 19:07:38.293 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 19:07:38.302 +04:00 DBG Connection ID "18014398519682531386" disconnecting.
2025-04-01 19:07:38.307 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 399.8135ms
2025-04-01 19:07:38.390 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 19:07:38.394 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 19:07:38.400 +04:00 DBG Connection ID "18158513703463419984" disconnecting.
2025-04-01 19:07:38.401 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.883ms
2025-04-01 19:07:38.453 +04:00 DBG Connection ID "17870283323016740886" disconnecting.
2025-04-01 19:07:38.457 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 63.3047ms
2025-04-01 19:07:38.554 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 19:07:38.555 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 19:07:38.555 +04:00 DBG Request did not match any endpoints
2025-04-01 19:07:38.585 +04:00 DBG Connection ID "17870283323016740888" disconnecting.
2025-04-01 19:07:38.586 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.2938ms
2025-04-01 19:07:59.255 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 19:07:59.288 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 19:07:59.295 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 19:07:59.296 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:07:59.299 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:07:59.386 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:07:59.390 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:07:59.429 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:07:59.430 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:07:59.430 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:07:59.431 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:07:59.431 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:07:59.431 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:07:59.433 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:07:59.499 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:07:59.500 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:07:59.507 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:07:59.514 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 19:07:59.516 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:07:59.540 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 19:07:59.541 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:07:59.542 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:07:59.542 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:07:59.552 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:07:59.553 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:07:59.554 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:07:59.554 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:07:59.555 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:08:10.665 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 19:13:09.081 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 19:13:09.236 +04:00 INF starting web host
2025-04-01 19:13:09.456 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 19:13:10.442 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:13:10.443 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:13:10.552 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:13:10.734 +04:00 DBG Creating DbConnection.
2025-04-01 19:13:10.774 +04:00 DBG Created DbConnection. (38ms).
2025-04-01 19:13:10.776 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:10.792 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.150 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.157 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:13:11.169 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 19:13:11.173 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (16ms).
2025-04-01 19:13:11.184 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:13:11.225 +04:00 INF Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:13:11.230 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.241 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (8ms).
2025-04-01 19:13:11.241 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.243 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.245 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 19:13:11.250 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:13:11.250 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:13:11.250 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:13:11.251 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:13:11.288 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:13:11.374 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:13:11.380 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:13:11.381 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:13:11.381 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:13:11.382 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 19:13:11.382 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:13:11.384 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:13:11.386 +04:00 DBG Committing transaction.
2025-04-01 19:13:11.389 +04:00 DBG Committed transaction.
2025-04-01 19:13:11.390 +04:00 DBG Disposing transaction.
2025-04-01 19:13:11.392 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:13:11.392 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:13:11.395 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:13:11.395 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:13:11.395 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:13:11.396 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:13:11.398 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:13:11.398 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:13:11.398 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:13:11.398 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:13:11.399 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:13:11.399 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:13:11.402 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:13:11.403 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:13:11.403 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:13:11.403 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:13:11.408 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:13:11.416 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.417 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-04-01 19:13:11.423 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 19:13:11.424 +04:00 DBG Committing transaction.
2025-04-01 19:13:11.424 +04:00 DBG Committed transaction.
2025-04-01 19:13:11.424 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:13:11.425 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:13:11.425 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:13:11.425 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:13:11.431 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:13:11.431 +04:00 DBG Disposing transaction.
2025-04-01 19:13:11.431 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.432 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:13:11.541 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 19:13:11.877 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 19:13:11.971 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.971 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.972 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:13:11.972 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:13:11.972 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:13:11.972 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:13:11.982 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:13:11.986 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.986 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:13:11.986 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:11.986 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:13:12.048 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:13:12.171 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:13:12.178 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 19:13:12.183 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 19:13:12.207 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 19:13:12.375 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.381 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.391 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:13:12.391 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:13:12.398 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (7ms).
2025-04-01 19:13:12.401 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:13:12.449 +04:00 INF Executed DbCommand (50ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-04-01 19:13:12.461 +04:00 DBG Hosting starting
2025-04-01 19:13:12.469 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:13:12.506 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 19:13:12.513 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.516 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 66ms reading results.
2025-04-01 19:13:12.520 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.520 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:13:12.535 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 19:13:12.538 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:13:12.551 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 19:13:12.555 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-04-01 19:13:12.558 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:13:12.563 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.565 +04:00 DBG Disposed connection to database '' on server '' (3ms).
2025-04-01 19:13:12.571 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 19:13:12.580 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:13:12.581 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 19:13:12.584 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:13:12.587 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 19:13:12.589 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 19:13:12.592 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 19:13:12.594 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 19:13:12.674 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:13:12.692 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 19:13:12.778 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:13:12.797 +04:00 DBG Creating DbConnection.
2025-04-01 19:13:12.798 +04:00 DBG Created DbConnection. (1ms).
2025-04-01 19:13:12.798 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.798 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.798 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:13:12.798 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:13:12.799 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:13:12.799 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:13:12.808 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:13:12.819 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.820 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-04-01 19:13:12.820 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.820 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:13:12.821 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:13:12.821 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:13:12.821 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:13:12.991 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 19:13:12.991 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 19:13:12.991 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 19:13:12.991 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 19:13:13.142 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 19:13:13.364 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 19:13:13.364 +04:00 INF Hosting environment: Development
2025-04-01 19:13:13.364 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 19:13:13.365 +04:00 DBG Hosting started
2025-04-01 19:13:13.580 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 19:13:13.618 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 19:13:13.619 +04:00 DBG Request did not match any endpoints
2025-04-01 19:13:13.771 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 19:13:13.774 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 19:13:13.901 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 19:13:13.903 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 19:13:13.920 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 800.4604ms
2025-04-01 19:13:14.041 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 19:13:14.070 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 28.8899ms
2025-04-01 19:13:14.072 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 19:13:14.186 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 114.7738ms
2025-04-01 19:13:14.187 +04:00 DBG Connection ID "18374686489872171088" disconnecting.
2025-04-01 19:13:14.283 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 19:13:14.283 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 19:13:14.283 +04:00 DBG Request did not match any endpoints
2025-04-01 19:13:14.337 +04:00 DBG Connection ID "18230571301796315182" disconnecting.
2025-04-01 19:13:14.337 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 52.8212ms
2025-04-01 19:13:47.568 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 19:13:47.603 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 19:13:47.604 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 19:13:47.605 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:13:47.611 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:13:47.682 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:13:47.686 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:13:47.735 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:13:47.738 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:13:47.739 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:13:47.740 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:13:47.743 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:13:47.745 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:13:47.749 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:13:47.838 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:13:47.840 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:13:47.850 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:13:47.853 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 19:13:47.857 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:13:47.887 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 19:13:47.887 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:13:47.888 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:13:47.888 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:13:47.902 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:13:47.903 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:13:47.904 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:13:47.904 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:13:47.905 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:13:51.070 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 19:14:16.730 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 19:14:16.751 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:14:16.766 +04:00 DBG Creating DbConnection.
2025-04-01 19:14:16.766 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:14:16.766 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:14:16.767 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:14:16.767 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:14:16.767 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:14:16.767 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:14:16.768 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:14:16.775 +04:00 INF Executed DbCommand (7ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:14:16.815 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:14:16.818 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:14:16.818 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 37ms reading results.
2025-04-01 19:14:16.818 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:14:16.819 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:14:26.316 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:14:26.319 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:14:26.319 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:14:26.319 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:14:26.322 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:14:26.322 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 19:14:26.424 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 38674.1021ms
2025-04-01 19:14:26.426 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:14:26.430 +04:00 DBG Connection ID "18374686489872171093" disconnecting.
2025-04-01 19:14:26.430 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:14:26.431 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:14:26.431 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:14:26.433 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 38865.2099ms
2025-04-01 19:15:25.340 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/companies - null null
2025-04-01 19:15:25.375 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/companies'
2025-04-01 19:15:25.376 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)' with route pattern 'api/Admin/companies' is valid for the request path '/api/Admin/companies'
2025-04-01 19:15:25.376 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)'
2025-04-01 19:15:25.378 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:15:25.453 +04:00 DBG Successfully validated the token.
2025-04-01 19:15:25.455 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:15:25.460 +04:00 DBG Authorization was successful.
2025-04-01 19:15:25.461 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)'
2025-04-01 19:15:25.468 +04:00 INF Route matched with {action = "GetAllCompanies", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCompanies(System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:15:25.468 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:15:25.468 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:15:25.468 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:15:25.468 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:15:25.469 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:15:25.469 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:15:25.470 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:15:25.471 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:15:25.472 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:15:25.472 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:15:25.472 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:15:25.473 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:15:25.476 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Where(acc => (int)acc.Role == 1)'
2025-04-01 19:15:25.485 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Account>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
        SELECT a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
        FROM Accounts AS a
        WHERE a.Role == 'Company') | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
        SELECT a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
        FROM Accounts AS a
        WHERE a.Role == 'Company', 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Account entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Account instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Account);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Account)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                        {
                            return 
                            {
                                Account instance;
                                instance = new Account();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Email>k__BackingField = dataReader.GetString(1);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                instance.<Phone>k__BackingField = dataReader.GetString(3);
                                instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Account)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:15:25.488 +04:00 DBG Creating DbConnection.
2025-04-01 19:15:25.488 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:15:25.488 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:15:25.488 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:15:25.488 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:15:25.488 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:15:25.489 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:15:25.489 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Role] = 'Company'
2025-04-01 19:15:25.497 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Role] = 'Company'
2025-04-01 19:15:25.498 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:15:25.500 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:15:25.501 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:15:25.501 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:15:25.501 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:15:25.534 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:15:25.535 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:15:25.535 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:15:25.535 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:15:25.535 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:15:25.536 +04:00 INF Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.Application.Models.CompanyResponseModel, offers.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-01 19:15:25.541 +04:00 INF Executed action offers.API.Controllers.AdminController.GetAllCompanies (offers.API) in 72.014ms
2025-04-01 19:15:25.541 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)'
2025-04-01 19:15:25.542 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:15:25.542 +04:00 DBG Connection ID "18086456105130524733" disconnecting.
2025-04-01 19:15:25.542 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:15:25.542 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:15:25.542 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/companies - 200 null application/json; charset=utf-8 203.8235ms
2025-04-01 19:16:03.731 +04:00 INF Request starting HTTP/2 PATCH https://localhost:44346/api/Admin/companies/5/confirm - null null
2025-04-01 19:16:03.753 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/companies/5/confirm'
2025-04-01 19:16:03.753 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.ConfirmCompany (offers.API)' with route pattern 'api/Admin/companies/{id}/confirm' is valid for the request path '/api/Admin/companies/5/confirm'
2025-04-01 19:16:03.753 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.ConfirmCompany (offers.API)'
2025-04-01 19:16:03.754 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:16:03.759 +04:00 DBG Successfully validated the token.
2025-04-01 19:16:03.759 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:16:03.768 +04:00 DBG Authorization was successful.
2025-04-01 19:16:03.769 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.ConfirmCompany (offers.API)'
2025-04-01 19:16:03.774 +04:00 INF Route matched with {action = "ConfirmCompany", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ConfirmCompany(Int32, System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:16:03.774 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:16:03.775 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:16:03.775 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:16:03.775 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:16:03.775 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:16:03.775 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:16:03.778 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:16:03.781 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:16:03.781 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-04-01 19:16:03.782 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-04-01 19:16:03.783 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:16:03.784 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:16:03.784 +04:00 DBG Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-04-01 19:16:03.785 +04:00 DBG Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-04-01 19:16:03.785 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:16:03.785 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:16:03.785 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:16:03.785 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:16:03.786 +04:00 INF attempt to Confirm a company with the ID 5
2025-04-01 19:16:03.792 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .FirstOrDefault(acc => acc.Id == __id_0)'
2025-04-01 19:16:03.806 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 19:16:03.808 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 19:16:03.871 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(1) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Id == @__id_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:16:03.889 +04:00 DBG Creating DbConnection.
2025-04-01 19:16:03.889 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:16:03.889 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.889 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.889 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:16:03.890 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:16:03.890 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:16:03.891 +04:00 DBG Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 19:16:03.904 +04:00 INF Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Id] = @__id_0
2025-04-01 19:16:03.906 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:16:03.918 +04:00 DBG The navigation 'Account.CompanyDetail' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:16:03.920 +04:00 DBG Context 'ApplicationDbContext' started tracking 'CompanyDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:16:03.926 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.926 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 21ms reading results.
2025-04-01 19:16:03.926 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.926 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:16:03.937 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 19:16:03.937 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 19:16:03.944 +04:00 DBG The unchanged property 'CompanyDetail.IsActive' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:16:03.945 +04:00 DBG An entity of type 'CompanyDetail' tracked by 'ApplicationDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:16:03.946 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 19:16:03.951 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.952 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.952 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:16:03.952 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:16:03.952 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:16:03.952 +04:00 DBG Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CompanyDetails] SET [IsActive] = @p0
OUTPUT 1
WHERE [AccountId] = @p1;
2025-04-01 19:16:03.956 +04:00 INF Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CompanyDetails] SET [IsActive] = @p0
OUTPUT 1
WHERE [AccountId] = @p1;
2025-04-01 19:16:03.958 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.958 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 19:16:03.958 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.959 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:16:03.959 +04:00 DBG An entity of type 'CompanyDetail' tracked by 'ApplicationDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:16:03.959 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-04-01 19:16:03.960 +04:00 INF Executing StatusCodeResult, setting HTTP status code 204
2025-04-01 19:16:03.960 +04:00 INF Executed action offers.API.Controllers.AdminController.ConfirmCompany (offers.API) in 185.6336ms
2025-04-01 19:16:03.961 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.ConfirmCompany (offers.API)'
2025-04-01 19:16:03.963 +04:00 DBG Connection ID "17798225737568747549" disconnecting.
2025-04-01 19:16:03.963 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:16:03.963 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:16:03.963 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:16:03.964 +04:00 INF Request finished HTTP/2 PATCH https://localhost:44346/api/Admin/companies/5/confirm - 204 null null 232.9812ms
2025-04-01 19:18:01.579 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Admin/Category - application/json 66
2025-04-01 19:18:01.582 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/Category'
2025-04-01 19:18:01.582 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.Post (offers.API)' with route pattern 'api/Admin/Category' is valid for the request path '/api/Admin/Category'
2025-04-01 19:18:01.583 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.Post (offers.API)'
2025-04-01 19:18:01.583 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:18:01.583 +04:00 DBG Successfully validated the token.
2025-04-01 19:18:01.584 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:18:01.590 +04:00 DBG Authorization was successful.
2025-04-01 19:18:01.590 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.Post (offers.API)'
2025-04-01 19:18:01.597 +04:00 INF Route matched with {action = "Post", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(offers.API.Models.CategoryDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:18:01.598 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:18:01.598 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:18:01.598 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:18:01.598 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:18:01.598 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:18:01.598 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:18:01.606 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:18:01.615 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:18:01.615 +04:00 DBG Attempting to bind parameter 'categoryDTO' of type 'offers.API.Models.CategoryDTO' ...
2025-04-01 19:18:01.615 +04:00 DBG Attempting to bind parameter 'categoryDTO' of type 'offers.API.Models.CategoryDTO' using the name '' in request data ...
2025-04-01 19:18:01.616 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:18:01.619 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.CategoryDTO'
2025-04-01 19:18:01.619 +04:00 DBG Done attempting to bind parameter 'categoryDTO' of type 'offers.API.Models.CategoryDTO'.
2025-04-01 19:18:01.619 +04:00 DBG Done attempting to bind parameter 'categoryDTO' of type 'offers.API.Models.CategoryDTO'.
2025-04-01 19:18:01.619 +04:00 DBG Attempting to validate the bound parameter 'categoryDTO' of type 'offers.API.Models.CategoryDTO' ...
2025-04-01 19:18:01.621 +04:00 DBG Done attempting to validate the bound parameter 'categoryDTO' of type 'offers.API.Models.CategoryDTO'.
2025-04-01 19:18:01.621 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:18:01.621 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:18:01.621 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:18:01.621 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:18:01.624 +04:00 INF attempt to add a new category Accessories
2025-04-01 19:18:01.638 +04:00 DBG Compiling query expression: 
'DbSet<Category>()
    .Any(ctg => ctg.Name == __name_0)'
2025-04-01 19:18:01.645 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Categories AS c
                WHERE c.Name == @__name_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Categories AS c
                WHERE c.Name == @__name_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:18:01.658 +04:00 DBG Creating DbConnection.
2025-04-01 19:18:01.658 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:18:01.658 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.659 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.659 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:18:01.659 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:01.659 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:01.659 +04:00 DBG Executing DbCommand [Parameters=[@__name_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:18:01.677 +04:00 INF Executed DbCommand (18ms) [Parameters=[@__name_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:18:01.679 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.679 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 19:18:01.679 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.680 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:18:01.699 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:18:01.714 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:18:01.715 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-04-01 19:18:01.715 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-04-01 19:18:01.718 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-04-01 19:18:01.720 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.720 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.721 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:18:01.721 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:01.721 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:01.721 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 1000) (DbType = AnsiString), @p1='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Description], [Name])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2025-04-01 19:18:01.732 +04:00 INF Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 1000) (DbType = AnsiString), @p1='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Description], [Name])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1);
2025-04-01 19:18:01.735 +04:00 DBG The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-04-01 19:18:01.737 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.737 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:18:01.737 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.738 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:18:01.739 +04:00 DBG An entity of type 'Category' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:18:01.739 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-04-01 19:18:01.743 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:18:01.743 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:18:01.743 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:18:01.743 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:18:01.743 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:18:01.743 +04:00 INF Executing CreatedAtActionResult, writing value of type 'offers.Application.Models.CategoryResponseModel'.
2025-04-01 19:18:01.763 +04:00 DBG Found the endpoints ["offers.API.Controllers.AdminController.GetCategoryById (offers.API)"] for address (id=[1],action=[GetCategoryById],controller=[Admin])
2025-04-01 19:18:01.767 +04:00 DBG Successfully processed template api/Admin/categories/{id} for offers.API.Controllers.AdminController.GetCategoryById (offers.API) resulting in /api/Admin/categories/1 and 
2025-04-01 19:18:01.770 +04:00 DBG Link generation succeeded for endpoints ["offers.API.Controllers.AdminController.GetCategoryById (offers.API)"] with result /api/Admin/categories/1
2025-04-01 19:18:01.774 +04:00 INF Executed action offers.API.Controllers.AdminController.Post (offers.API) in 176.4534ms
2025-04-01 19:18:01.774 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.Post (offers.API)'
2025-04-01 19:18:01.775 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:18:01.775 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:01.775 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:18:01.775 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Admin/Category - 201 null application/json; charset=utf-8 201.1394ms
2025-04-01 19:18:12.836 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:18:12.841 +04:00 DBG Creating DbConnection.
2025-04-01 19:18:12.841 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:18:12.841 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:12.841 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:12.842 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:18:12.842 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:12.842 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:12.842 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:18:12.848 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:18:12.849 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:12.849 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 19:18:12.849 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:12.849 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:18:12.850 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:18:12.850 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:12.850 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:18:21.034 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - null null
2025-04-01 19:18:21.035 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/categories/1'
2025-04-01 19:18:21.035 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)' with route pattern 'api/Admin/categories/{id}' is valid for the request path '/api/Admin/categories/1'
2025-04-01 19:18:21.035 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:18:21.035 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:18:21.036 +04:00 DBG Successfully validated the token.
2025-04-01 19:18:21.036 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:18:21.037 +04:00 DBG Authorization was successful.
2025-04-01 19:18:21.037 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:18:21.080 +04:00 INF Route matched with {action = "GetCategoryById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCategoryById(Int32, System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:18:21.080 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:18:21.080 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:18:21.080 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:18:21.080 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:18:21.081 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:18:21.081 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:18:21.085 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:18:21.086 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:18:21.086 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-04-01 19:18:21.087 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-04-01 19:18:21.087 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:18:21.087 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:18:21.087 +04:00 DBG Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-04-01 19:18:21.087 +04:00 DBG Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-04-01 19:18:21.087 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:18:21.087 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:18:21.087 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:18:21.088 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:18:21.108 +04:00 DBG Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2025-04-01 19:18:21.113 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<Name>k__BackingField = dataReader.GetString(2);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:18:21.123 +04:00 DBG Creating DbConnection.
2025-04-01 19:18:21.123 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:18:21.123 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:21.124 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:21.124 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:18:21.124 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:21.124 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:18:21.124 +04:00 DBG Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:18:21.131 +04:00 INF Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:18:21.132 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:18:21.132 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:18:21.132 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:18:21.132 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:18:21.132 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:18:21.132 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.CategoryResponseModel'.
2025-04-01 19:18:21.134 +04:00 INF Executed action offers.API.Controllers.AdminController.GetCategoryById (offers.API) in 53.1866ms
2025-04-01 19:18:21.134 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:18:21.134 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:18:21.131 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:18:21.135 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:21.135 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:18:21.135 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:18:21.135 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:18:21.136 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - 200 null application/json; charset=utf-8 101.3948ms
2025-04-01 19:34:10.166 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 19:34:10.348 +04:00 INF starting web host
2025-04-01 19:34:10.709 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 19:34:11.807 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:34:11.809 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:34:11.918 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:34:12.077 +04:00 DBG Creating DbConnection.
2025-04-01 19:34:12.150 +04:00 DBG Created DbConnection. (72ms).
2025-04-01 19:34:12.152 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.175 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.625 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.634 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:34:12.642 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-04-01 19:34:12.649 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-04-01 19:34:12.656 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:34:12.698 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:34:12.702 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.719 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (8ms).
2025-04-01 19:34:12.720 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.721 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.723 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 19:34:12.725 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:34:12.726 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:34:12.726 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:34:12.727 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:34:12.753 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:34:12.822 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:34:12.828 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:34:12.831 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:34:12.831 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:34:12.832 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 19:34:12.832 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:34:12.836 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:34:12.838 +04:00 DBG Committing transaction.
2025-04-01 19:34:12.841 +04:00 DBG Committed transaction.
2025-04-01 19:34:12.842 +04:00 DBG Disposing transaction.
2025-04-01 19:34:12.847 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:34:12.848 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:34:12.849 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:34:12.849 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:34:12.850 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:34:12.850 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:34:12.850 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:34:12.851 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:34:12.851 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:34:12.851 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:34:12.851 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:34:12.852 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:34:12.854 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:34:12.854 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:34:12.854 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:34:12.855 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:34:12.859 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:34:12.862 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.864 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:34:12.874 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 19:34:12.874 +04:00 DBG Committing transaction.
2025-04-01 19:34:12.875 +04:00 DBG Committed transaction.
2025-04-01 19:34:12.875 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:34:12.875 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:34:12.876 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:34:12.876 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:34:12.884 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:34:12.884 +04:00 DBG Disposing transaction.
2025-04-01 19:34:12.884 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:12.885 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:34:12.986 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 19:34:13.315 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 19:34:13.363 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.366 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.366 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:34:13.366 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:34:13.366 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:34:13.367 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:34:13.376 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:34:13.382 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.382 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-04-01 19:34:13.383 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.383 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:34:13.385 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:34:13.387 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.388 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 19:34:13.396 +04:00 DBG Hosting starting
2025-04-01 19:34:13.432 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 19:34:13.460 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 19:34:13.475 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 19:34:13.490 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 19:34:13.495 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:34:13.496 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 19:34:13.500 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:34:13.502 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 19:34:13.503 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 19:34:13.506 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 19:34:13.507 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 19:34:13.557 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:34:13.583 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 19:34:13.717 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:34:13.750 +04:00 DBG Creating DbConnection.
2025-04-01 19:34:13.750 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:34:13.753 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.757 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.758 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:34:13.758 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:34:13.758 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:34:13.759 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:34:13.823 +04:00 INF Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:34:13.855 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.856 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 33ms reading results.
2025-04-01 19:34:13.859 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.859 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:34:13.861 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:34:13.861 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:34:13.861 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:34:13.991 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 19:34:13.992 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 19:34:13.992 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 19:34:13.992 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 19:34:14.133 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 19:34:14.356 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 19:34:14.356 +04:00 INF Hosting environment: Development
2025-04-01 19:34:14.357 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 19:34:14.357 +04:00 DBG Hosting started
2025-04-01 19:34:14.547 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 19:34:14.598 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 19:34:14.599 +04:00 DBG Request did not match any endpoints
2025-04-01 19:34:14.804 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 19:34:14.808 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 19:34:14.896 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 19:34:14.897 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 19:34:14.904 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 801.0487ms
2025-04-01 19:34:14.915 +04:00 DBG Connection ID "17798225728978812970" disconnecting.
2025-04-01 19:34:14.951 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 19:34:14.972 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 19:34:14.974 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 23.8602ms
2025-04-01 19:34:15.140 +04:00 DBG Connection ID "17798225728978812972" disconnecting.
2025-04-01 19:34:15.141 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 168.9407ms
2025-04-01 19:34:15.370 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 19:34:15.370 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 19:34:15.370 +04:00 DBG Request did not match any endpoints
2025-04-01 19:34:15.407 +04:00 DBG Connection ID "18374686485577203775" disconnecting.
2025-04-01 19:34:15.408 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 37.5972ms
2025-04-01 19:34:49.547 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 19:34:49.583 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 19:34:49.595 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 19:34:49.596 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:34:49.602 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:34:50.188 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:34:50.193 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:34:50.231 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:34:50.234 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:34:50.234 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:34:50.235 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:34:50.235 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:34:50.235 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:34:50.238 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:34:50.302 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:34:50.304 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:34:50.313 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:34:50.316 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 19:34:50.320 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:34:50.354 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 19:34:50.355 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:34:50.355 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:34:50.356 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:34:50.370 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:34:50.371 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:34:50.372 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:34:50.372 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:34:50.373 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:34:53.989 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 19:35:19.006 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 19:35:19.033 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 19:35:19.035 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 19:35:19.161 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:35:19.199 +04:00 DBG Creating DbConnection.
2025-04-01 19:35:19.200 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:35:19.200 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:35:19.200 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:35:19.200 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:35:19.200 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:35:19.209 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (8ms).
2025-04-01 19:35:19.214 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:35:19.495 +04:00 INF Executed DbCommand (286ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:35:19.648 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:35:19.715 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:35:19.715 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 219ms reading results.
2025-04-01 19:35:19.716 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:35:19.716 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:35:30.924 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:35:30.926 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:35:30.926 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:35:30.926 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:35:30.927 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:35:30.928 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 19:35:31.008 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 40767.0072ms
2025-04-01 19:35:31.008 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:35:31.012 +04:00 DBG Connection ID "18014398519682531394" disconnecting.
2025-04-01 19:35:31.012 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:35:31.012 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:35:31.012 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:35:31.014 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 41467.1878ms
2025-04-01 19:36:09.823 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/categories - null null
2025-04-01 19:36:09.829 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/categories'
2025-04-01 19:36:09.830 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllCategoriesAsync (offers.API)' with route pattern 'api/Admin/categories' is valid for the request path '/api/Admin/categories'
2025-04-01 19:36:09.833 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllCategoriesAsync (offers.API)'
2025-04-01 19:36:09.837 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:36:09.891 +04:00 DBG Successfully validated the token.
2025-04-01 19:36:09.892 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:36:09.898 +04:00 DBG Authorization was successful.
2025-04-01 19:36:09.898 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.GetAllCategoriesAsync (offers.API)'
2025-04-01 19:36:09.908 +04:00 INF Route matched with {action = "GetAllCategories", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCategoriesAsync(System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:36:09.908 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:36:09.908 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:36:09.908 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:36:09.908 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:36:09.908 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:36:09.908 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:36:09.911 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:36:09.912 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:36:09.913 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:36:09.913 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:36:09.913 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:36:09.913 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:36:09.923 +04:00 DBG Compiling query expression: 
'DbSet<Category>()'
2025-04-01 19:36:09.932 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
        SELECT c.Id, c.Description, c.Name
        FROM Categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
        SELECT c.Id, c.Description, c.Name
        FROM Categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Description>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                instance.<Name>k__BackingField = dataReader.GetString(2);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:36:09.936 +04:00 DBG Creating DbConnection.
2025-04-01 19:36:09.936 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:36:09.936 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:09.936 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:09.936 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:36:09.937 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:36:09.937 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:36:09.937 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
2025-04-01 19:36:09.945 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
2025-04-01 19:36:09.954 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:36:09.962 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:09.962 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-04-01 19:36:09.962 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:09.963 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:36:09.986 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:36:09.987 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:36:09.987 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:36:09.987 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:36:09.987 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:36:09.988 +04:00 INF Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.Application.Models.CategoryResponseModel, offers.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-01 19:36:09.991 +04:00 INF Executed action offers.API.Controllers.AdminController.GetAllCategoriesAsync (offers.API) in 82.6883ms
2025-04-01 19:36:09.991 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.GetAllCategoriesAsync (offers.API)'
2025-04-01 19:36:09.992 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:36:09.992 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:09.992 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:36:09.993 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/categories - 200 null application/json; charset=utf-8 170.2632ms
2025-04-01 19:36:09.993 +04:00 DBG Connection ID "18374686485577203777" disconnecting.
2025-04-01 19:36:24.221 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - null null
2025-04-01 19:36:24.222 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/categories/1'
2025-04-01 19:36:24.222 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)' with route pattern 'api/Admin/categories/{id}' is valid for the request path '/api/Admin/categories/1'
2025-04-01 19:36:24.222 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:36:24.223 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:36:24.226 +04:00 DBG Successfully validated the token.
2025-04-01 19:36:24.226 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:36:24.228 +04:00 DBG Authorization was successful.
2025-04-01 19:36:24.228 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:36:24.237 +04:00 INF Route matched with {action = "GetCategoryById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCategoryById(Int32, System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:36:24.237 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:36:24.237 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:36:24.238 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:36:24.238 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:36:24.238 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:36:24.238 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:36:24.242 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:36:24.243 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:36:24.243 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-04-01 19:36:24.244 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-04-01 19:36:24.245 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:36:24.245 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:36:24.245 +04:00 DBG Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-04-01 19:36:24.246 +04:00 DBG Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-04-01 19:36:24.246 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:36:24.246 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:36:24.246 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:36:24.246 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:36:35.310 +04:00 DBG Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2025-04-01 19:36:35.318 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<Name>k__BackingField = dataReader.GetString(2);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:36:35.322 +04:00 DBG Creating DbConnection.
2025-04-01 19:36:35.322 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:36:35.322 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:35.322 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:35.323 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:36:35.323 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:36:35.323 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:36:35.324 +04:00 DBG Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:36:35.330 +04:00 INF Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:36:35.377 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:36:35.407 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:35.407 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 74ms reading results.
2025-04-01 19:36:35.408 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:35.408 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:36:40.025 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:36:40.025 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:36:40.025 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:36:40.025 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:36:40.025 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:36:40.025 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.CategoryResponseModel'.
2025-04-01 19:36:40.026 +04:00 INF Executed action offers.API.Controllers.AdminController.GetCategoryById (offers.API) in 15788.6228ms
2025-04-01 19:36:40.027 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:36:40.027 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:36:40.027 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:36:40.027 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:36:40.028 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - 200 null application/json; charset=utf-8 15807.3765ms
2025-04-01 19:36:40.032 +04:00 DBG Connection ID "18230571301796315188" disconnecting.
2025-04-01 19:38:25.615 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 19:38:25.828 +04:00 INF starting web host
2025-04-01 19:38:26.121 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 19:38:26.993 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:38:26.994 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:38:27.088 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:38:27.282 +04:00 DBG Creating DbConnection.
2025-04-01 19:38:27.341 +04:00 DBG Created DbConnection. (57ms).
2025-04-01 19:38:27.342 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:27.357 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:27.825 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:27.829 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:38:27.837 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-04-01 19:38:27.841 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (11ms).
2025-04-01 19:38:27.846 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:38:27.874 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:38:27.877 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:27.892 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (7ms).
2025-04-01 19:38:27.892 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:27.893 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:27.894 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 19:38:27.897 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:38:27.897 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:38:27.897 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:38:27.898 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:38:27.921 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:38:28.002 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:38:28.009 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:38:28.011 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:38:28.011 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:38:28.012 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 19:38:28.012 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:38:28.018 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:38:28.020 +04:00 DBG Committing transaction.
2025-04-01 19:38:28.025 +04:00 DBG Committed transaction.
2025-04-01 19:38:28.026 +04:00 DBG Disposing transaction.
2025-04-01 19:38:28.028 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:38:28.029 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:38:28.031 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:38:28.031 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:38:28.032 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:38:28.032 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:38:28.032 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:38:28.033 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:38:28.033 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:38:28.033 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:38:28.033 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:38:28.034 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:38:28.036 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:38:28.037 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:38:28.037 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:38:28.038 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:38:28.044 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:38:28.048 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.050 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:38:28.059 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 19:38:28.060 +04:00 DBG Committing transaction.
2025-04-01 19:38:28.060 +04:00 DBG Committed transaction.
2025-04-01 19:38:28.061 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:38:28.061 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:38:28.061 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:38:28.061 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:38:28.065 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:38:28.065 +04:00 DBG Disposing transaction.
2025-04-01 19:38:28.065 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.066 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:38:28.153 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 19:38:28.462 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 19:38:28.551 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.551 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.551 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:38:28.552 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:38:28.552 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:38:28.558 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:38:28.564 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:38:28.568 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.568 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:38:28.568 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.569 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:38:28.571 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:38:28.575 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.576 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 19:38:28.583 +04:00 DBG Hosting starting
2025-04-01 19:38:28.627 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 19:38:28.653 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 19:38:28.666 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 19:38:28.685 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 19:38:28.692 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:38:28.693 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 19:38:28.695 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:38:28.697 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 19:38:28.699 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 19:38:28.701 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 19:38:28.702 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 19:38:28.762 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:38:28.781 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 19:38:28.891 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:38:28.912 +04:00 DBG Creating DbConnection.
2025-04-01 19:38:28.913 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:38:28.916 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.918 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.919 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:38:28.920 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:38:28.920 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:38:28.920 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:38:28.941 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:38:28.951 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.953 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-04-01 19:38:28.958 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.959 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:38:28.961 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:38:28.961 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:28.962 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:38:29.111 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 19:38:29.111 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 19:38:29.111 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 19:38:29.111 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 19:38:29.205 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 19:38:29.412 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 19:38:29.413 +04:00 INF Hosting environment: Development
2025-04-01 19:38:29.413 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 19:38:29.415 +04:00 DBG Hosting started
2025-04-01 19:38:29.675 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 19:38:29.753 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 19:38:29.754 +04:00 DBG Request did not match any endpoints
2025-04-01 19:38:29.917 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 19:38:29.922 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 19:38:30.028 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 19:38:30.029 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 19:38:30.114 +04:00 DBG Connection ID "18374686485577203779" disconnecting.
2025-04-01 19:38:30.115 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 19:38:30.117 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 929.1712ms
2025-04-01 19:38:30.126 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 19:38:30.133 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 6.0015ms
2025-04-01 19:38:30.204 +04:00 DBG Connection ID "18086456118015426613" disconnecting.
2025-04-01 19:38:30.209 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 94.6471ms
2025-04-01 19:38:30.326 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 19:38:30.327 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 19:38:30.327 +04:00 DBG Request did not match any endpoints
2025-04-01 19:38:30.398 +04:00 DBG Connection ID "18374686485577203781" disconnecting.
2025-04-01 19:38:30.398 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 71.7681ms
2025-04-01 19:38:46.036 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 19:38:46.074 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 19:38:46.080 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 19:38:46.081 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:38:46.090 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:38:46.185 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:38:46.191 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:38:46.225 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:38:46.227 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:38:46.227 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:38:46.228 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:38:46.228 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:38:46.228 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:38:46.230 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:38:46.294 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:38:46.296 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:38:46.311 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:38:46.315 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 19:38:46.320 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:38:46.347 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 19:38:46.347 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:38:46.348 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:38:46.348 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:38:46.359 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:38:46.360 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:38:46.361 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:38:46.361 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:38:46.362 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:38:46.364 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 19:38:46.376 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 19:38:46.393 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 19:38:46.394 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 19:38:46.504 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:38:46.561 +04:00 DBG Creating DbConnection.
2025-04-01 19:38:46.562 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:38:46.562 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:46.562 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:46.563 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:38:46.563 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:38:46.570 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (7ms).
2025-04-01 19:38:46.575 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:38:46.621 +04:00 INF Executed DbCommand (50ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:38:46.667 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:38:46.693 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:46.694 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 71ms reading results.
2025-04-01 19:38:46.694 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:46.694 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:38:46.866 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:38:46.869 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:38:46.869 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:38:46.870 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:38:46.872 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:38:46.873 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 19:38:46.942 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 709.3633ms
2025-04-01 19:38:46.954 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:38:46.958 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:38:46.958 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:38:46.958 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:38:46.960 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 923.7912ms
2025-04-01 19:39:26.538 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - null null
2025-04-01 19:39:26.541 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/categories/1'
2025-04-01 19:39:26.542 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)' with route pattern 'api/Admin/categories/{id}' is valid for the request path '/api/Admin/categories/1'
2025-04-01 19:39:26.549 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:39:26.550 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:39:26.604 +04:00 DBG Successfully validated the token.
2025-04-01 19:39:26.606 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:39:26.618 +04:00 DBG Authorization was successful.
2025-04-01 19:39:26.618 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:39:26.623 +04:00 INF Route matched with {action = "GetCategoryById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCategoryById(Int32, System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:39:26.624 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:39:26.624 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:39:26.624 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:39:26.624 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:39:26.624 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:39:26.625 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:39:26.626 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:39:26.638 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:39:26.638 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-04-01 19:39:26.639 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-04-01 19:39:26.640 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:39:26.640 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:39:26.640 +04:00 DBG Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-04-01 19:39:26.641 +04:00 DBG Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-04-01 19:39:26.641 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:39:26.641 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:39:26.641 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:39:26.641 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:40:01.156 +04:00 DBG Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2025-04-01 19:40:01.166 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<Name>k__BackingField = dataReader.GetString(2);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:40:01.175 +04:00 DBG Creating DbConnection.
2025-04-01 19:40:01.176 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:40:01.176 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:40:01.176 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:40:01.176 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:40:01.177 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:40:01.177 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:40:01.178 +04:00 DBG Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:40:01.238 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:40:01.238 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:40:01.238 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:40:01.238 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:40:01.239 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:40:01.239 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.CategoryResponseModel'.
2025-04-01 19:40:01.243 +04:00 INF Executed DbCommand (66ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:40:01.243 +04:00 INF Executed action offers.API.Controllers.AdminController.GetCategoryById (offers.API) in 34618.7087ms
2025-04-01 19:40:01.244 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:40:01.244 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:40:01.245 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:40:01.245 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:40:01.245 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - 200 null application/json; charset=utf-8 34707.9959ms
2025-04-01 19:40:01.273 +04:00 ERR An exception occurred while iterating over the results of a query for context type 'offers.Persistance.Context.ApplicationDbContext'.
System.InvalidOperationException: Invalid attempt to call CheckDataIsReady when reader is closed.
   at Microsoft.Data.SqlClient.SqlDataReader.CheckDataIsReady(Int32 columnIndex, Boolean allowPartiallyReadColumn, Boolean permitAsync, String methodName)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadColumn(Int32 i, Boolean setTimeout, Boolean allowPartiallyReadColumn, Boolean forStreaming)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadColumn(Int32 i, Boolean setTimeout, Boolean allowPartiallyReadColumn)
   at Microsoft.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
   at lambda_method129(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()System.InvalidOperationException: Invalid attempt to call CheckDataIsReady when reader is closed.
   at Microsoft.Data.SqlClient.SqlDataReader.CheckDataIsReady(Int32 columnIndex, Boolean allowPartiallyReadColumn, Boolean permitAsync, String methodName)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadColumn(Int32 i, Boolean setTimeout, Boolean allowPartiallyReadColumn, Boolean forStreaming)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadColumn(Int32 i, Boolean setTimeout, Boolean allowPartiallyReadColumn)
   at Microsoft.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
   at lambda_method129(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()

2025-04-01 19:40:01.278 +04:00 DBG Creating DbConnection.
2025-04-01 19:40:01.278 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:40:01.278 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:40:01.279 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 35ms reading results.
2025-04-01 19:43:28.965 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:43:28.982 +04:00 DBG Creating DbConnection.
2025-04-01 19:43:28.983 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:43:28.983 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:43:28.983 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:43:28.983 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:43:28.983 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:43:28.984 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:43:28.984 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:43:28.995 +04:00 INF Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:43:28.996 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:43:28.996 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 19:43:28.996 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:43:28.996 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:43:28.996 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:43:28.996 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:43:28.996 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:48:29.021 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:48:29.029 +04:00 DBG Creating DbConnection.
2025-04-01 19:48:29.029 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:48:29.029 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:48:29.047 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:48:29.048 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:48:29.048 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:48:29.048 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:48:29.048 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:48:29.051 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:48:29.051 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:48:29.051 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-04-01 19:48:29.052 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:48:29.052 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:48:29.052 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:48:29.052 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:48:29.052 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:51:22.957 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 19:51:23.144 +04:00 INF starting web host
2025-04-01 19:51:23.444 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 19:51:24.430 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:51:24.436 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:51:24.571 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:51:24.753 +04:00 DBG Creating DbConnection.
2025-04-01 19:51:24.805 +04:00 DBG Created DbConnection. (50ms).
2025-04-01 19:51:24.807 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:24.820 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.153 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.158 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:51:25.171 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 19:51:25.173 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-04-01 19:51:25.179 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:51:25.223 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:51:25.226 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.238 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-04-01 19:51:25.238 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.239 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.240 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 19:51:25.242 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:51:25.243 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:51:25.243 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:51:25.243 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:51:25.261 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:51:25.334 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:51:25.343 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:51:25.344 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:51:25.344 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:51:25.346 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 19:51:25.346 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:51:25.350 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:51:25.353 +04:00 DBG Committing transaction.
2025-04-01 19:51:25.357 +04:00 DBG Committed transaction.
2025-04-01 19:51:25.360 +04:00 DBG Disposing transaction.
2025-04-01 19:51:25.362 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:51:25.362 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:51:25.364 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:51:25.364 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:51:25.365 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:51:25.365 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:51:25.368 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:51:25.370 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:51:25.370 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:51:25.370 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:51:25.370 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:51:25.371 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:51:25.373 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:51:25.373 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:51:25.373 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:51:25.374 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:51:25.377 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:51:25.380 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.384 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-04-01 19:51:25.390 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 19:51:25.390 +04:00 DBG Committing transaction.
2025-04-01 19:51:25.390 +04:00 DBG Committed transaction.
2025-04-01 19:51:25.391 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:51:25.391 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:51:25.391 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:51:25.391 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:51:25.395 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:51:25.396 +04:00 DBG Disposing transaction.
2025-04-01 19:51:25.396 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.397 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:51:25.500 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 19:51:25.804 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 19:51:25.851 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.852 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.852 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:51:25.852 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:51:25.853 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:51:25.853 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:51:25.861 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:51:25.865 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.865 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:51:25.865 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.865 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:51:25.868 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:51:25.870 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:25.871 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 19:51:25.878 +04:00 DBG Hosting starting
2025-04-01 19:51:25.908 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 19:51:25.932 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 19:51:25.941 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 19:51:25.954 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 19:51:25.960 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:51:25.961 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 19:51:25.964 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:51:25.969 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 19:51:25.971 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 19:51:25.973 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 19:51:25.974 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 19:51:26.012 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:51:26.026 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 19:51:26.109 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:51:26.132 +04:00 DBG Creating DbConnection.
2025-04-01 19:51:26.133 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:51:26.135 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:26.139 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:26.140 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:51:26.140 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:51:26.140 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:51:26.141 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:51:26.172 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:51:26.185 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:26.187 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 13ms reading results.
2025-04-01 19:51:26.189 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:26.190 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:51:26.191 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:51:26.191 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:26.192 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:51:26.306 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 19:51:26.306 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 19:51:26.306 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 19:51:26.306 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 19:51:26.360 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 19:51:26.545 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 19:51:26.555 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 19:51:26.555 +04:00 INF Hosting environment: Development
2025-04-01 19:51:26.555 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 19:51:26.555 +04:00 DBG Hosting started
2025-04-01 19:51:26.585 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 19:51:26.585 +04:00 DBG Request did not match any endpoints
2025-04-01 19:51:26.688 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 19:51:26.690 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 19:51:26.796 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 19:51:26.797 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 19:51:26.870 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 19:51:26.871 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 19:51:26.876 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 528.1134ms
2025-04-01 19:51:26.877 +04:00 DBG Connection ID "18374686485577203783" disconnecting.
2025-04-01 19:51:26.880 +04:00 DBG Connection ID "18086456118015426617" disconnecting.
2025-04-01 19:51:26.879 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 6.3105ms
2025-04-01 19:51:26.982 +04:00 DBG Connection ID "18014398511092596803" disconnecting.
2025-04-01 19:51:26.982 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 112.069ms
2025-04-01 19:51:27.167 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 19:51:27.168 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 19:51:27.168 +04:00 DBG Request did not match any endpoints
2025-04-01 19:51:27.208 +04:00 DBG Connection ID "18302628891539275785" disconnecting.
2025-04-01 19:51:27.208 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.9877ms
2025-04-01 19:51:56.121 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 19:51:56.173 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 19:51:56.182 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 19:51:56.183 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:51:56.187 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:51:56.264 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:51:56.267 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:51:56.289 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:51:56.291 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:51:56.291 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:51:56.291 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:51:56.292 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:51:56.292 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:51:56.294 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:51:56.353 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:51:56.354 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:51:56.359 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:51:56.363 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 19:51:56.367 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:51:56.388 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 19:51:56.389 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:51:56.389 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:51:56.389 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:51:56.400 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:51:56.402 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:51:56.403 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:51:56.403 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:51:56.404 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:51:56.406 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 19:51:56.418 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 19:51:56.434 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 19:51:56.436 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 19:51:56.554 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:51:56.583 +04:00 DBG Creating DbConnection.
2025-04-01 19:51:56.583 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:51:56.583 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:56.583 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:56.584 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:51:56.584 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:51:56.590 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (6ms).
2025-04-01 19:51:56.596 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:51:56.628 +04:00 INF Executed DbCommand (37ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:51:56.673 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:51:56.730 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:56.730 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 100ms reading results.
2025-04-01 19:51:56.731 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:56.731 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:51:56.870 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:51:56.872 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:51:56.872 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:51:56.873 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:51:56.874 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:51:56.874 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 19:51:56.888 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 593.5112ms
2025-04-01 19:51:56.889 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:51:56.893 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:51:56.896 +04:00 DBG Connection ID "17798225737568747553" disconnecting.
2025-04-01 19:51:56.896 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:51:56.896 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:51:56.898 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 777.9374ms
2025-04-01 19:52:25.078 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - null null
2025-04-01 19:52:25.083 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/categories/1'
2025-04-01 19:52:25.089 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)' with route pattern 'api/Admin/categories/{id}' is valid for the request path '/api/Admin/categories/1'
2025-04-01 19:52:25.091 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:52:25.091 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:52:25.168 +04:00 DBG Successfully validated the token.
2025-04-01 19:52:25.170 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:52:25.180 +04:00 DBG Authorization was successful.
2025-04-01 19:52:25.181 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:52:25.197 +04:00 INF Route matched with {action = "GetCategoryById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCategoryById(Int32, System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:52:25.198 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:52:25.198 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:52:25.199 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:52:25.200 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:52:25.200 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:52:25.201 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:52:25.206 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:52:25.212 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:52:25.214 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-04-01 19:52:25.215 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-04-01 19:52:25.216 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:52:25.217 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:52:25.217 +04:00 DBG Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-04-01 19:52:25.218 +04:00 DBG Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-04-01 19:52:25.218 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:52:25.218 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:52:25.218 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:52:25.218 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:53:06.991 +04:00 DBG Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2025-04-01 19:53:06.998 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<Name>k__BackingField = dataReader.GetString(2);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:53:07.003 +04:00 DBG Creating DbConnection.
2025-04-01 19:53:07.003 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:53:07.003 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:53:07.004 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:53:07.004 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:53:07.004 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:53:07.004 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:53:07.008 +04:00 DBG Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:53:07.047 +04:00 INF Executed DbCommand (42ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:53:07.058 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:53:07.061 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:53:07.061 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:53:07.061 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:53:07.061 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:53:07.062 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:53:07.062 +04:00 INF Executing OkObjectResult, writing value of type 'offers.Application.Models.CategoryResponseModel'.
2025-04-01 19:53:07.064 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:53:07.064 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 17ms reading results.
2025-04-01 19:53:07.065 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:53:07.065 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:53:07.065 +04:00 INF Executed action offers.API.Controllers.AdminController.GetCategoryById (offers.API) in 41864.1995ms
2025-04-01 19:53:07.065 +04:00 INF Executed endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:53:07.117 +04:00 DBG Connection ID "18374686485577203788" disconnecting.
2025-04-01 19:53:07.117 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:53:07.117 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:53:07.117 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:53:07.118 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - 200 null application/json; charset=utf-8 42048.0183ms
2025-04-01 19:56:40.327 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-04-01 19:56:40.479 +04:00 INF starting web host
2025-04-01 19:56:40.669 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-04-01 19:56:41.966 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:56:41.968 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-04-01 19:56:42.145 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:56:42.428 +04:00 DBG Creating DbConnection.
2025-04-01 19:56:42.505 +04:00 DBG Created DbConnection. (72ms).
2025-04-01 19:56:42.507 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:42.528 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:42.896 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:42.900 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:56:42.911 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-04-01 19:56:42.913 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-04-01 19:56:42.920 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:56:42.965 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:56:42.978 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.028 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (30ms).
2025-04-01 19:56:43.028 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.043 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.045 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-01 19:56:43.048 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:56:43.048 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:56:43.049 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:56:43.049 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:56:43.130 +04:00 INF Executed DbCommand (80ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-04-01 19:56:43.240 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:56:43.245 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:56:43.247 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:56:43.247 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:56:43.248 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-04-01 19:56:43.248 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:56:43.251 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-04-01 19:56:43.254 +04:00 DBG Committing transaction.
2025-04-01 19:56:43.258 +04:00 DBG Committed transaction.
2025-04-01 19:56:43.261 +04:00 DBG Disposing transaction.
2025-04-01 19:56:43.263 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-04-01 19:56:43.263 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-04-01 19:56:43.265 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-04-01 19:56:43.265 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:56:43.265 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-04-01 19:56:43.265 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:56:43.266 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-04-01 19:56:43.266 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:56:43.267 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:56:43.267 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:56:43.267 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:56:43.267 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-04-01 19:56:43.271 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:56:43.271 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:56:43.271 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:56:43.272 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:56:43.277 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-04-01 19:56:43.282 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.285 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-04-01 19:56:43.298 +04:00 INF No migrations were applied. The database is already up to date.
2025-04-01 19:56:43.298 +04:00 DBG Committing transaction.
2025-04-01 19:56:43.300 +04:00 DBG Committed transaction.
2025-04-01 19:56:43.300 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-04-01 19:56:43.301 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:56:43.301 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-04-01 19:56:43.301 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:56:43.314 +04:00 INF Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-04-01 19:56:43.314 +04:00 DBG Disposing transaction.
2025-04-01 19:56:43.314 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.315 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:56:43.418 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-04-01 19:56:43.789 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-04-01 19:56:43.851 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.851 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.851 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:56:43.852 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:56:43.852 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:56:43.852 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:56:43.858 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-04-01 19:56:43.862 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.862 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-04-01 19:56:43.862 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.862 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:56:43.864 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:56:43.866 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:43.868 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-04-01 19:56:43.874 +04:00 DBG Hosting starting
2025-04-01 19:56:43.902 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-01 19:56:43.926 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-04-01 19:56:43.934 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-04-01 19:56:43.954 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-04-01 19:56:43.963 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:56:43.964 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-04-01 19:56:43.966 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-04-01 19:56:43.968 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-04-01 19:56:43.971 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-04-01 19:56:43.975 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-04-01 19:56:43.977 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-04-01 19:56:44.005 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:56:44.015 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-04-01 19:56:44.086 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-04-01 19:56:44.109 +04:00 DBG Creating DbConnection.
2025-04-01 19:56:44.110 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:56:44.111 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:44.115 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:44.116 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:56:44.116 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:56:44.116 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:56:44.117 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:56:44.145 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-04-01 19:56:44.159 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:44.160 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-04-01 19:56:44.163 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:44.164 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:56:44.174 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:56:44.181 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:56:44.181 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:56:44.269 +04:00 DBG Loaded hosting startup assembly offers.API
2025-04-01 19:56:44.269 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-04-01 19:56:44.269 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-04-01 19:56:44.269 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-04-01 19:56:44.326 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-04-01 19:56:44.716 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-04-01 19:56:44.716 +04:00 INF Hosting environment: Development
2025-04-01 19:56:44.716 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-04-01 19:56:44.717 +04:00 DBG Hosting started
2025-04-01 19:56:44.843 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-04-01 19:56:44.880 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-04-01 19:56:44.881 +04:00 DBG Request did not match any endpoints
2025-04-01 19:56:45.071 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-04-01 19:56:45.074 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-04-01 19:56:45.204 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-04-01 19:56:45.205 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-04-01 19:56:45.212 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 901.3344ms
2025-04-01 19:56:45.375 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-04-01 19:56:45.420 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-04-01 19:56:45.427 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.985ms
2025-04-01 19:56:45.656 +04:00 DBG Connection ID "18014398511092596805" disconnecting.
2025-04-01 19:56:45.656 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 282.4927ms
2025-04-01 19:56:45.711 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-04-01 19:56:45.711 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-04-01 19:56:45.712 +04:00 DBG Request did not match any endpoints
2025-04-01 19:56:45.765 +04:00 DBG Connection ID "18158513703463419992" disconnecting.
2025-04-01 19:56:45.765 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 54.4545ms
2025-04-01 19:57:08.513 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-04-01 19:57:08.552 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-04-01 19:57:08.595 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-04-01 19:57:08.597 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:57:08.603 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:57:08.697 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-04-01 19:57:08.701 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:57:08.745 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-04-01 19:57:08.748 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:57:08.748 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:57:08.749 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:57:08.750 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:57:08.751 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:57:08.754 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:57:08.859 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:57:08.860 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-04-01 19:57:08.868 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:57:08.872 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-04-01 19:57:08.875 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-04-01 19:57:08.906 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-04-01 19:57:08.907 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:57:08.907 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:57:08.908 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-04-01 19:57:08.921 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-04-01 19:57:08.922 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:57:08.923 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:57:08.923 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:57:08.924 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:57:08.927 +04:00 INF Login attempt for randomuser@example.com
2025-04-01 19:57:08.947 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Include(acc => acc.UserDetail)
    .Include(acc => acc.CompanyDetail)
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-04-01 19:57:08.976 +04:00 DBG Including navigation: 'Account.UserDetail'.
2025-04-01 19:57:08.978 +04:00 DBG Including navigation: 'Account.CompanyDetail'.
2025-04-01 19:57:09.061 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
                1 -> Dictionary<IProperty, int> { [Property: UserDetail.AccountId (int) Required PK FK AfterSave:Throw, 5], [Property: UserDetail.Balance (decimal) Required, 6], [Property: UserDetail.FirstName (string) Required MaxLength(100) ANSI, 7], [Property: UserDetail.LastName (string) Required MaxLength(100) ANSI, 8] }
                2 -> Dictionary<IProperty, int> { [Property: CompanyDetail.AccountId (int) Required PK FK AfterSave:Throw, 9], [Property: CompanyDetail.CompanyName (string) Required MaxLength(255) ANSI, 10], [Property: CompanyDetail.IsActive (bool) Required, 11] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role, u.AccountId, u.Balance, u.FirstName, u.LastName, c.AccountId, c.CompanyName, c.IsActive
            FROM Accounts AS a
            LEFT JOIN UserDetails AS u ON a.Id == u.AccountId
            LEFT JOIN CompanyDetails AS c ON a.Id == c.AccountId
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            UserDetail entity;
            CompanyDetail entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                UserDetail instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(UserDetail);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetInt32(5) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (UserDetail)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]: 
                            {
                                return 
                                {
                                    UserDetail instance;
                                    instance = new UserDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(5) ? default(int) : dataReader.GetInt32(5);
                                    instance.<Balance>k__BackingField = dataReader.IsDBNull(6) ? default(decimal) : dataReader.GetDecimal(6);
                                    instance.<FirstName>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<LastName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserDetail | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserDetail)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                CompanyDetail instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(CompanyDetail);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: CompanyDetail.AccountId PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetInt32(9) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (CompanyDetail)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]: 
                            {
                                return 
                                {
                                    CompanyDetail instance;
                                    instance = new CompanyDetail();
                                    instance.<AccountId>k__BackingField = dataReader.IsDBNull(9) ? default(int) : dataReader.GetInt32(9);
                                    instance.<CompanyName>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<IsActive>k__BackingField = dataReader.IsDBNull(11) ? default(bool) : dataReader.GetBoolean(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: CompanyDetail | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(CompanyDetail)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, UserDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.UserDetail (UserDetail) ToDependent UserDetail Inverse: Account | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("UserDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: UserDetail.Account (Account) ToPrincipal Account Inverse: UserDetail | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("offers.Domain.Models.UserDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{12}, namelessParameter{13}) => 
                {
                    namelessParameter{12}.<UserDetail>k__BackingField = namelessParameter{13};
                    return namelessParameter{13}.<Account>k__BackingField = namelessParameter{12};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Account, Account, CompanyDetail>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Account.CompanyDetail (CompanyDetail) ToDependent CompanyDetail Inverse: Account | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindNavigation("CompanyDetail")], 
                inverseNavigation: [LIFTABLE Constant: Navigation: CompanyDetail.Account (Account) ToPrincipal Account Inverse: CompanyDetail | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("offers.Domain.Models.CompanyDetail").FindNavigation("Account")], 
                fixup: (namelessParameter{16}, namelessParameter{17}) => 
                {
                    namelessParameter{16}.<CompanyDetail>k__BackingField = namelessParameter{17};
                    return namelessParameter{17}.<Account>k__BackingField = namelessParameter{16};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:57:09.087 +04:00 DBG Creating DbConnection.
2025-04-01 19:57:09.087 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:57:09.088 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:57:09.088 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:57:09.088 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:57:09.088 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:57:09.093 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (4ms).
2025-04-01 19:57:09.096 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:57:09.138 +04:00 INF Executed DbCommand (45ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role], [u].[AccountId], [u].[Balance], [u].[FirstName], [u].[LastName], [c].[AccountId], [c].[CompanyName], [c].[IsActive]
FROM [Accounts] AS [a]
LEFT JOIN [UserDetails] AS [u] ON [a].[Id] = [u].[AccountId]
LEFT JOIN [CompanyDetails] AS [c] ON [a].[Id] = [c].[AccountId]
WHERE [a].[Email] = @__Email_0
2025-04-01 19:57:09.219 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-04-01 19:57:09.268 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:57:09.269 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 129ms reading results.
2025-04-01 19:57:09.269 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:57:09.269 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-04-01 19:57:09.393 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-04-01 19:57:09.395 +04:00 DBG No information found on request to perform content negotiation.
2025-04-01 19:57:09.395 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-04-01 19:57:09.395 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-04-01 19:57:09.396 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-04-01 19:57:09.397 +04:00 INF Executing OkObjectResult, writing value of type 'offers.API.Models.LoginResponseDTO'.
2025-04-01 19:57:09.410 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 656.4421ms
2025-04-01 19:57:09.411 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-04-01 19:57:09.413 +04:00 DBG 'ApplicationDbContext' disposed.
2025-04-01 19:57:09.413 +04:00 DBG Connection ID "17798225737568747556" disconnecting.
2025-04-01 19:57:09.414 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:57:09.414 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-04-01 19:57:09.416 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 200 null application/json; charset=utf-8 903.2618ms
2025-04-01 19:57:46.819 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/categories/1 - null null
2025-04-01 19:57:46.840 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/categories/1'
2025-04-01 19:57:46.840 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)' with route pattern 'api/Admin/categories/{id}' is valid for the request path '/api/Admin/categories/1'
2025-04-01 19:57:46.841 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:57:46.841 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-04-01 19:57:46.925 +04:00 DBG Successfully validated the token.
2025-04-01 19:57:46.927 +04:00 DBG AuthenticationScheme: Bearer was successfully authenticated.
2025-04-01 19:57:46.938 +04:00 DBG Authorization was successful.
2025-04-01 19:57:46.938 +04:00 INF Executing endpoint 'offers.API.Controllers.AdminController.GetCategoryById (offers.API)'
2025-04-01 19:57:46.945 +04:00 INF Route matched with {action = "GetCategoryById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCategoryById(Int32, System.Threading.CancellationToken) on controller offers.API.Controllers.AdminController (offers.API).
2025-04-01 19:57:46.945 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-04-01 19:57:46.945 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-04-01 19:57:46.946 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-04-01 19:57:46.946 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-04-01 19:57:46.947 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-04-01 19:57:46.947 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:57:46.951 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-04-01 19:57:46.954 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AdminController (offers.API)
2025-04-01 19:57:46.961 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-04-01 19:57:46.962 +04:00 DBG Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-04-01 19:57:46.964 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:57:46.965 +04:00 DBG Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-04-01 19:57:46.965 +04:00 DBG Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-04-01 19:57:46.965 +04:00 DBG Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-04-01 19:57:46.966 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:57:46.966 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:57:46.966 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-04-01 19:57:46.966 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-04-01 19:57:46.994 +04:00 DBG Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2025-04-01 19:57:47.005 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.Description (string) MaxLength(1000) ANSI, 1], [Property: Category.Name (string) Required MaxLength(255) ANSI, 2] }
            SELECT TOP(1) c.Id, c.Description, c.Name
            FROM Categories AS c
            WHERE c.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<Name>k__BackingField = dataReader.GetString(2);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-04-01 19:57:47.009 +04:00 DBG Creating DbConnection.
2025-04-01 19:57:47.009 +04:00 DBG Created DbConnection. (0ms).
2025-04-01 19:57:47.009 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:57:47.009 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-04-01 19:57:47.010 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-04-01 19:57:47.010 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:57:47.010 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-04-01 19:57:47.011 +04:00 DBG Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-04-01 19:57:50.934 +04:00 INF Executed DbCommand (3,924ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Description], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
