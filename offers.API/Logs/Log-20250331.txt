2025-03-31 14:17:42.145 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 14:17:42.541 +04:00 INF starting web host
2025-03-31 14:17:43.126 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:17:45.244 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:17:45.246 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:17:45.424 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:17:45.454 +04:00 INF No migrations were found in assembly 'offers.Persistance'. A migration needs to be added before the database can be updated.
2025-03-31 14:17:45.460 +04:00 DBG Creating DbConnection.
2025-03-31 14:17:45.614 +04:00 DBG Created DbConnection. (151ms).
2025-03-31 14:17:45.618 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:17:45.649 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:17:47.109 +04:00 DBG An error occurred using the connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:17:47.347 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:17:47.359 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:17:47.372 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-03-31 14:17:47.399 +04:00 DBG Hosting starting
2025-03-31 14:17:47.490 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 14:17:47.538 +04:00 DBG Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-03-31 14:17:47.538 +04:00 DBG Policy resolution states that a new key should be added to the key ring.
2025-03-31 14:17:47.545 +04:00 INF Creating key {557b37cc-37f6-47ec-b065-df0e1794c732} with creation date 2025-03-31 10:17:47Z, activation date 2025-03-31 10:17:47Z, and expiration date 2025-06-29 10:17:47Z.
2025-03-31 14:17:47.559 +04:00 DBG Descriptor deserializer type for key {557b37cc-37f6-47ec-b065-df0e1794c732} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-03-31 14:17:47.604 +04:00 DBG No key escrow sink found. Not writing key {557b37cc-37f6-47ec-b065-df0e1794c732} to escrow.
2025-03-31 14:17:47.612 +04:00 DBG Encrypting to Windows DPAPI for current user account (DESKTOP-T9J7KFM\misho).
2025-03-31 14:17:47.640 +04:00 INF Writing data to file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 14:17:47.642 +04:00 DBG Key cache expiration token triggered by 'CreateNewKey' operation.
2025-03-31 14:17:47.642 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 14:17:47.694 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 14:17:47.702 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 14:17:47.704 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 14:17:47.705 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 14:17:47.707 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 14:17:47.709 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 14:17:47.710 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 14:17:47.720 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 14:17:47.723 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 14:17:47.834 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:17:48.045 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 14:17:48.737 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 14:17:48.812 +04:00 DBG Creating DbConnection.
2025-03-31 14:17:48.812 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 14:17:48.815 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:17:48.828 +04:00 ERR An error occurred using the connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:17:48.856 +04:00 ERR An exception occurred while iterating over the results of a query for context type 'offers.Persistance.Context.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:4f54dcc9-5466-44a9-8cf8-e5ff0667ee45
Error Number:-2146893019,State:0,Class:20Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:4f54dcc9-5466-44a9-8cf8-e5ff0667ee45
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:17:48.994 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:17:48.995 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:17:48.995 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 14:17:48.996 +04:00 ERR Hosting failed to startMicrosoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at offers.Infrastructure.Repositories.OfferRepository.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Infrastructure\Repositories\OfferRepository.cs:line 21
   at offers.Application.Services.Offers.OfferService.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Offers\OfferService.cs:line 237
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 30
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
ClientConnectionId:4f54dcc9-5466-44a9-8cf8-e5ff0667ee45
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:17:49.229 +04:00 FTL Host terminated unexpectedlyMicrosoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at offers.Infrastructure.Repositories.OfferRepository.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Infrastructure\Repositories\OfferRepository.cs:line 21
   at offers.Application.Services.Offers.OfferService.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Offers\OfferService.cs:line 237
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 30
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71
ClientConnectionId:4f54dcc9-5466-44a9-8cf8-e5ff0667ee45
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:19:05.675 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 14:19:05.898 +04:00 INF starting web host
2025-03-31 14:19:06.217 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:19:07.249 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:19:07.250 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:19:07.336 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:19:07.350 +04:00 INF No migrations were found in assembly 'offers.Persistance'. A migration needs to be added before the database can be updated.
2025-03-31 14:19:07.353 +04:00 DBG Creating DbConnection.
2025-03-31 14:19:07.400 +04:00 DBG Created DbConnection. (44ms).
2025-03-31 14:19:07.401 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:19:07.416 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:19:07.711 +04:00 DBG An error occurred using the connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:19:07.764 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:19:07.767 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:19:07.771 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 14:19:07.780 +04:00 DBG Hosting starting
2025-03-31 14:19:07.813 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 14:19:07.833 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 14:19:07.846 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 14:19:07.857 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 14:19:07.863 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 14:19:07.864 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 14:19:07.867 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 14:19:07.869 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 14:19:07.873 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 14:19:07.883 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 14:19:07.885 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 14:19:07.912 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:19:07.988 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 14:19:08.466 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 14:19:08.531 +04:00 DBG Creating DbConnection.
2025-03-31 14:19:08.531 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 14:19:08.533 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:19:08.546 +04:00 ERR An error occurred using the connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:19:08.573 +04:00 ERR An exception occurred while iterating over the results of a query for context type 'offers.Persistance.Context.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:7b9f4348-10b9-49f6-90de-964d10e2e10c
Error Number:-2146893019,State:0,Class:20Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:7b9f4348-10b9-49f6-90de-964d10e2e10c
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:19:08.660 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:19:08.661 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:19:08.662 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 14:19:08.663 +04:00 ERR Hosting failed to startMicrosoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at offers.Infrastructure.Repositories.OfferRepository.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Infrastructure\Repositories\OfferRepository.cs:line 21
   at offers.Application.Services.Offers.OfferService.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Offers\OfferService.cs:line 237
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 30
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
ClientConnectionId:7b9f4348-10b9-49f6-90de-964d10e2e10c
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:19:08.696 +04:00 FTL Host terminated unexpectedlyMicrosoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at offers.Infrastructure.Repositories.OfferRepository.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Infrastructure\Repositories\OfferRepository.cs:line 21
   at offers.Application.Services.Offers.OfferService.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Offers\OfferService.cs:line 237
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 30
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71
ClientConnectionId:7b9f4348-10b9-49f6-90de-964d10e2e10c
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:21:55.907 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 14:21:56.088 +04:00 INF starting web host
2025-03-31 14:21:56.257 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:21:57.181 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:21:57.183 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:21:57.291 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:21:57.302 +04:00 INF No migrations were found in assembly 'offers.Persistance'. A migration needs to be added before the database can be updated.
2025-03-31 14:21:57.304 +04:00 DBG Creating DbConnection.
2025-03-31 14:21:57.364 +04:00 DBG Created DbConnection. (56ms).
2025-03-31 14:21:57.366 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:21:57.378 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:21:57.679 +04:00 DBG An error occurred using the connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:21:57.750 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:21:57.757 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:21:57.765 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-03-31 14:21:57.773 +04:00 DBG Hosting starting
2025-03-31 14:21:57.802 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 14:21:57.825 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 14:21:57.834 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 14:21:57.847 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 14:21:57.851 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 14:21:57.852 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 14:21:57.854 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 14:21:57.856 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 14:21:57.857 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 14:21:57.863 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 14:21:57.864 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 14:21:57.903 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:21:57.999 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 14:21:58.416 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 14:21:58.466 +04:00 DBG Creating DbConnection.
2025-03-31 14:21:58.467 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 14:21:58.469 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:21:58.475 +04:00 ERR An error occurred using the connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:21:58.496 +04:00 ERR An exception occurred while iterating over the results of a query for context type 'offers.Persistance.Context.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:bf2c1538-ca87-4b38-af2b-6fca6f4eb886
Error Number:-2146893019,State:0,Class:20Microsoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:bf2c1538-ca87-4b38-af2b-6fca6f4eb886
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:21:58.628 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:21:58.634 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:21:58.635 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 14:21:58.636 +04:00 ERR Hosting failed to startMicrosoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at offers.Infrastructure.Repositories.OfferRepository.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Infrastructure\Repositories\OfferRepository.cs:line 21
   at offers.Application.Services.Offers.OfferService.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Offers\OfferService.cs:line 237
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 30
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
ClientConnectionId:bf2c1538-ca87-4b38-af2b-6fca6f4eb886
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:21:58.665 +04:00 FTL Host terminated unexpectedlyMicrosoft.Data.SqlClient.SqlException (0x80131904): A connection was successfully established with the server, but then an error occurred during the login process. (provider: SSL Provider, error: 0 - The certificate chain was issued by an authority that is not trusted.)
 ---> System.ComponentModel.Win32Exception (0x80090325): The certificate chain was issued by an authority that is not trusted.
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at offers.Infrastructure.Repositories.OfferRepository.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Infrastructure\Repositories\OfferRepository.cs:line 21
   at offers.Application.Services.Offers.OfferService.ArchiveOffersAsync(CancellationToken cancellationToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\Services\Offers\OfferService.cs:line 237
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 30
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 72
ClientConnectionId:bf2c1538-ca87-4b38-af2b-6fca6f4eb886
Error Number:-2146893019,State:0,Class:20

2025-03-31 14:27:11.110 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:27:11.769 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:27:11.770 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:27:11.842 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:27:12.649 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:27:53.116 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:27:53.966 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:27:53.968 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:27:54.061 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:27:54.227 +04:00 DBG Creating DbConnection.
2025-03-31 14:27:54.274 +04:00 DBG Created DbConnection. (44ms).
2025-03-31 14:27:54.276 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:27:54.280 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:27:54.496 +04:00 DBG An error occurred using the connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:27:54.503 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:27:54.506 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:27:54.511 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 14:30:02.565 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:30:03.117 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:30:03.119 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:30:03.195 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:30:03.404 +04:00 DBG Creating DbConnection.
2025-03-31 14:30:03.450 +04:00 DBG Created DbConnection. (41ms).
2025-03-31 14:30:03.453 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:03.458 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:03.661 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:03.667 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:03.672 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 14:30:03.674 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-03-31 14:30:03.680 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:30:03.710 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:30:03.712 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:03.720 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 14:30:03.720 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:03.721 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:03.723 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 14:30:03.725 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:30:03.725 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:30:03.726 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:30:03.726 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 14:30:03.761 +04:00 INF Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 14:30:03.857 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 14:30:03.862 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 14:30:03.863 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:03.863 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:03.865 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 14:30:03.865 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 14:30:03.879 +04:00 INF Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 14:30:03.881 +04:00 DBG Committing transaction.
2025-03-31 14:30:03.884 +04:00 DBG Committed transaction.
2025-03-31 14:30:03.886 +04:00 DBG Disposing transaction.
2025-03-31 14:30:03.887 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 14:30:03.887 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 14:30:03.889 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:03.889 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:03.889 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:03.889 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:30:03.889 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:30:03.889 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:30:03.889 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:30:03.890 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:30:03.890 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 14:30:03.891 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 14:30:03.892 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 14:30:03.892 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 14:30:03.892 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 14:30:03.893 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 14:30:03.907 +04:00 INF Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 14:30:03.909 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:03.910 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-03-31 14:30:03.917 +04:00 INF Applying migration '20250331102712_Init'.
2025-03-31 14:30:03.965 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:03.965 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:03.965 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:03.965 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 14:30:03.971 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 14:30:04.367 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:04.368 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.368 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.368 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 14:30:04.373 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 14:30:04.373 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:04.373 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.373 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.373 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:30:04.379 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:30:04.379 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:04.380 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.380 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.380 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:30:04.385 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:30:04.385 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:04.385 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.385 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:04.385 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:30:04.390 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:30:06.766 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:30:06.767 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:06.767 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:30:06.767 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 14:30:06.800 +04:00 ERR Failed executing DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 14:30:06.801 +04:00 DBG Disposing transaction.
2025-03-31 14:30:06.804 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:30:06.804 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:30:06.804 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:30:06.804 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 14:30:06.813 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 14:30:06.813 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:06.814 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 14:30:06.818 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:30:06.824 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:30:06.825 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-03-31 14:49:24.945 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:49:25.676 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:49:25.678 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:49:25.775 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:49:25.980 +04:00 DBG Creating DbConnection.
2025-03-31 14:49:26.055 +04:00 DBG Created DbConnection. (73ms).
2025-03-31 14:49:26.063 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:26.073 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:26.365 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:26.373 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.381 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 14:49:26.383 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-03-31 14:49:26.389 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:49:26.412 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:49:26.415 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:26.423 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 14:49:26.423 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:26.424 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:26.425 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 14:49:26.426 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:49:26.426 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:49:26.426 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:49:26.427 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 14:49:26.448 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 14:49:26.593 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 14:49:26.601 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 14:49:26.603 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.603 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.605 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 14:49:26.605 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 14:49:26.610 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 14:49:26.611 +04:00 DBG Committing transaction.
2025-03-31 14:49:26.614 +04:00 DBG Committed transaction.
2025-03-31 14:49:26.616 +04:00 DBG Disposing transaction.
2025-03-31 14:49:26.618 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 14:49:26.619 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 14:49:26.621 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.621 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.621 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.621 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:49:26.622 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:49:26.622 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:49:26.622 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:49:26.622 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:49:26.622 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 14:49:26.623 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 14:49:26.624 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 14:49:26.624 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 14:49:26.624 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 14:49:26.625 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 14:49:26.635 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 14:49:26.637 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:26.639 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 14:49:26.788 +04:00 INF Applying migration '20250331102712_Init'.
2025-03-31 14:49:26.837 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.838 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.838 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.838 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 14:49:26.847 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 14:49:26.848 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.848 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.848 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.848 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 14:49:26.852 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 14:49:26.852 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.852 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.853 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.853 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:49:26.856 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:49:26.856 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.857 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.857 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.857 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:49:26.861 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:49:26.861 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:26.861 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:26.861 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:29.152 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:49:29.163 +04:00 INF Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:49:29.163 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:49:29.163 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:29.163 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:49:29.163 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 14:49:29.185 +04:00 ERR Failed executing DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 14:49:29.185 +04:00 DBG Disposing transaction.
2025-03-31 14:49:29.191 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:49:29.191 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:49:29.191 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:49:29.191 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 14:49:29.195 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 14:49:29.195 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:29.196 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 14:49:29.198 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:49:29.202 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:49:29.204 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-03-31 14:55:50.094 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:55:50.737 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:55:50.739 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:55:50.806 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:55:50.940 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:55:50.940 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:55:50.971 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:57:32.677 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:57:33.373 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:57:33.375 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:57:33.450 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:57:34.310 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:57:58.559 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 14:57:59.166 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:57:59.167 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 14:57:59.233 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 14:57:59.393 +04:00 DBG Creating DbConnection.
2025-03-31 14:57:59.425 +04:00 DBG Created DbConnection. (29ms).
2025-03-31 14:57:59.427 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:57:59.432 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:57:59.601 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:57:59.612 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:57:59.623 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (10ms).
2025-03-31 14:57:59.625 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (18ms).
2025-03-31 14:57:59.634 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:57:59.664 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:57:59.666 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:57:59.677 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 14:57:59.677 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:57:59.678 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:57:59.679 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 14:57:59.682 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:57:59.682 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:57:59.682 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:57:59.682 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 14:57:59.706 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 14:57:59.802 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 14:57:59.808 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 14:57:59.810 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:57:59.810 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:57:59.812 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 14:57:59.814 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 14:57:59.969 +04:00 INF Executed DbCommand (157ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 14:57:59.971 +04:00 DBG Committing transaction.
2025-03-31 14:57:59.977 +04:00 DBG Committed transaction.
2025-03-31 14:57:59.979 +04:00 DBG Disposing transaction.
2025-03-31 14:57:59.981 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 14:57:59.981 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 14:57:59.983 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:57:59.983 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:57:59.983 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:57:59.983 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:57:59.983 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 14:57:59.984 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:57:59.984 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:57:59.984 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:57:59.984 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 14:57:59.984 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 14:57:59.986 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 14:57:59.986 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 14:57:59.986 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 14:57:59.986 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 14:58:00.000 +04:00 INF Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 14:58:00.003 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:58:00.006 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 14:58:00.018 +04:00 INF Applying migration '20250331102712_Init'.
2025-03-31 14:58:00.083 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:58:00.083 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.083 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.083 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 14:58:00.123 +04:00 INF Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 14:58:00.123 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:58:00.123 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.525 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (402ms).
2025-03-31 14:58:00.525 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 14:58:00.528 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 14:58:00.529 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:58:00.529 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.529 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.529 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:58:00.533 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:58:00.533 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:58:00.533 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.533 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.533 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:58:00.536 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:58:00.536 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:58:00.536 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.536 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:00.536 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:58:00.542 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 14:58:03.181 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 14:58:03.181 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:03.181 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 14:58:03.182 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 14:58:03.203 +04:00 ERR Failed executing DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 14:58:03.204 +04:00 DBG Disposing transaction.
2025-03-31 14:58:03.207 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 14:58:03.207 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:58:03.207 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 14:58:03.207 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 14:58:03.211 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 14:58:03.211 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:58:03.212 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 14:58:03.214 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 14:58:03.217 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 14:58:03.219 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 15:09:16.816 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:09:17.499 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:09:17.501 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:09:17.569 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:09:17.701 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:09:17.701 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:09:17.729 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:09:53.844 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:09:54.443 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:09:54.445 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:09:54.508 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:09:55.112 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:10:13.501 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:10:14.034 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:10:14.037 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:10:14.111 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:10:14.233 +04:00 DBG Creating DbConnection.
2025-03-31 15:10:14.265 +04:00 DBG Created DbConnection. (29ms).
2025-03-31 15:10:14.268 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:14.273 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:14.419 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:14.427 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:14.433 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 15:10:14.434 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (11ms).
2025-03-31 15:10:14.440 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:10:14.475 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:10:14.477 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:14.489 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 15:10:14.489 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:14.490 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:14.491 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 15:10:14.495 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:10:14.495 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:10:14.495 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:10:14.496 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 15:10:14.520 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 15:10:14.611 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 15:10:14.618 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 15:10:14.620 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:14.620 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:14.621 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 15:10:14.621 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 15:10:14.624 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 15:10:14.627 +04:00 DBG Committing transaction.
2025-03-31 15:10:14.631 +04:00 DBG Committed transaction.
2025-03-31 15:10:14.633 +04:00 DBG Disposing transaction.
2025-03-31 15:10:14.636 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 15:10:14.637 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 15:10:14.638 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:14.638 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:14.639 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:14.639 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:10:14.639 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:10:14.640 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:10:14.640 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:10:14.640 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:10:14.640 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:10:14.641 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:10:14.643 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 15:10:14.643 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:10:14.643 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:10:14.643 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:10:14.648 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:10:14.650 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:14.652 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 15:10:14.661 +04:00 INF Applying migration '20250331102712_Init'.
2025-03-31 15:10:14.700 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:14.701 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:14.701 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:14.701 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 15:10:14.708 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 15:10:14.708 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:14.709 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:15.417 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (707ms).
2025-03-31 15:10:15.417 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 15:10:15.424 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 15:10:15.425 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:15.425 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:15.426 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:15.426 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:10:15.437 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:10:15.437 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:15.437 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:15.438 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:15.438 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:10:15.444 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:10:15.445 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:15.445 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:15.445 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:15.445 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:10:15.451 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:10:18.098 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:10:18.098 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:18.098 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:10:18.098 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 15:10:18.114 +04:00 ERR Failed executing DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 15:10:18.114 +04:00 DBG Disposing transaction.
2025-03-31 15:10:18.117 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:10:18.118 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:10:18.118 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:10:18.118 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 15:10:18.122 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 15:10:18.122 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:18.123 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 15:10:18.124 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:10:18.126 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:10:18.127 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 15:25:34.508 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 15:25:34.656 +04:00 INF starting web host
2025-03-31 15:25:34.818 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:25:35.537 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:25:35.538 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:25:35.614 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:25:35.844 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:25:35.844 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:25:35.905 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:25:35.911 +04:00 DBG Hosting starting
2025-03-31 15:25:35.969 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 15:25:35.997 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 15:25:36.028 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 15:25:36.042 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 15:25:36.047 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 15:25:36.049 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 15:25:36.052 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 15:25:36.053 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 15:25:36.055 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 15:25:36.056 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 15:25:36.057 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 15:25:36.080 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:25:36.187 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 15:25:36.542 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 15:25:36.586 +04:00 DBG Creating DbConnection.
2025-03-31 15:25:36.609 +04:00 DBG Created DbConnection. (20ms).
2025-03-31 15:25:36.611 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:25:36.892 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 15:25:36.904 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 15:25:36.948 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71

2025-03-31 15:56:28.449 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 15:56:28.648 +04:00 INF starting web host
2025-03-31 15:56:28.866 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:56:29.785 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:56:29.786 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:56:29.871 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:56:30.046 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:56:30.047 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:56:30.115 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:56:30.127 +04:00 DBG Hosting starting
2025-03-31 15:56:30.282 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 15:56:30.305 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 15:56:30.351 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 15:56:30.373 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 15:56:30.378 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 15:56:30.379 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 15:56:30.383 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 15:56:30.386 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 15:56:30.388 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 15:56:30.393 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 15:56:30.395 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 15:56:30.422 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:57:24.723 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:57:25.348 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:57:25.350 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:57:25.429 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:57:26.358 +04:00 DBG Creating DbConnection.
2025-03-31 15:57:26.397 +04:00 DBG Created DbConnection. (37ms).
2025-03-31 15:57:26.400 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.628 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.636 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:57:26.644 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 15:57:26.647 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-03-31 15:57:26.659 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:57:26.699 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:57:26.703 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.712 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 15:57:26.715 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:57:26.715 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:57:26.716 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:57:26.716 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.717 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.717 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:57:26.735 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:57:26.735 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.736 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 15:57:26.755 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.755 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.755 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 15:57:26.755 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:57:26.756 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:57:26.756 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:57:26.767 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:57:26.769 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.770 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 15:57:26.770 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.770 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 15:57:26.850 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:57:26.853 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:26.854 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 15:57:43.483 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:57:44.107 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:57:44.109 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:57:44.176 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:57:44.763 +04:00 DBG Creating DbConnection.
2025-03-31 15:57:44.795 +04:00 DBG Created DbConnection. (29ms).
2025-03-31 15:57:44.799 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.030 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.043 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:57:45.051 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (9ms).
2025-03-31 15:57:45.055 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (17ms).
2025-03-31 15:57:45.066 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:57:45.103 +04:00 INF Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:57:45.105 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.119 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 15:57:45.122 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:57:45.123 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:57:45.123 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:57:45.123 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.125 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.125 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:57:45.139 +04:00 INF Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:57:45.139 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.140 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 15:57:45.149 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.149 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.149 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 15:57:45.150 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:57:45.150 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:57:45.150 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:57:45.156 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:57:45.158 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.158 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-03-31 15:57:45.159 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.159 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 15:57:45.245 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:57:45.248 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:57:45.250 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 15:59:06.619 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:59:07.186 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:59:07.189 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:59:07.305 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:59:08.277 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:59:23.956 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 15:59:24.565 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:59:24.567 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 15:59:24.673 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 15:59:24.825 +04:00 DBG Creating DbConnection.
2025-03-31 15:59:24.857 +04:00 DBG Created DbConnection. (29ms).
2025-03-31 15:59:24.860 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:24.867 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.044 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.051 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.059 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 15:59:25.062 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-03-31 15:59:25.071 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:59:25.099 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:59:25.101 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.112 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 15:59:25.112 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.113 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.114 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 15:59:25.117 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:59:25.118 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:59:25.118 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:59:25.118 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 15:59:25.155 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 15:59:25.250 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 15:59:25.259 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 15:59:25.261 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.261 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.262 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 15:59:25.263 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 15:59:25.269 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 15:59:25.271 +04:00 DBG Committing transaction.
2025-03-31 15:59:25.276 +04:00 DBG Committed transaction.
2025-03-31 15:59:25.278 +04:00 DBG Disposing transaction.
2025-03-31 15:59:25.281 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 15:59:25.281 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 15:59:25.283 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.283 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.283 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.283 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:59:25.285 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 15:59:25.285 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:59:25.286 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:59:25.286 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:59:25.286 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:59:25.287 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 15:59:25.289 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 15:59:25.290 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:59:25.290 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 15:59:25.290 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:59:25.295 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 15:59:25.298 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.299 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 15:59:25.309 +04:00 INF Applying migration '20250331102712_Init'.
2025-03-31 15:59:25.364 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.365 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.365 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.365 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 15:59:25.390 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 15:59:25.391 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.391 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.391 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.391 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 15:59:25.397 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 15:59:25.397 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.397 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.397 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.397 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:59:25.404 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:59:25.404 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.404 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.404 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.404 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:59:25.408 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:59:25.408 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.408 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.408 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.408 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:59:25.759 +04:00 INF Executed DbCommand (350ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 15:59:25.759 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 15:59:25.760 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.760 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 15:59:25.760 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 15:59:25.785 +04:00 ERR Failed executing DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [AccountId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Transactions_UserDetails_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE CASCADE
);
2025-03-31 15:59:25.785 +04:00 DBG Disposing transaction.
2025-03-31 15:59:25.790 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 15:59:25.791 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:59:25.791 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 15:59:25.791 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 15:59:25.820 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 15:59:25.820 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.821 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 15:59:25.824 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 15:59:25.827 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 15:59:25.829 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:03:02.109 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:03:03.003 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:03.005 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:03.097 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:03:04.118 +04:00 DBG Creating DbConnection.
2025-03-31 16:03:04.175 +04:00 DBG Created DbConnection. (54ms).
2025-03-31 16:03:04.182 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.421 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.433 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:04.444 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (14ms).
2025-03-31 16:03:04.446 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (20ms).
2025-03-31 16:03:04.457 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:04.487 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:04.490 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.500 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 16:03:04.505 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:03:04.506 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:04.506 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:04.506 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.507 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.508 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:03:04.531 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:03:04.531 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.532 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:03:04.550 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.550 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.550 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:03:04.550 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:03:04.551 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:03:04.551 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:03:04.566 +04:00 INF Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:03:04.569 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.571 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:03:04.571 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.571 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:03:04.700 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:03:04.704 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:04.706 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:03:12.430 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:03:13.301 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:13.303 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:13.435 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:03:14.101 +04:00 DBG Creating DbConnection.
2025-03-31 16:03:14.162 +04:00 DBG Created DbConnection. (56ms).
2025-03-31 16:03:14.169 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.390 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.400 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:14.408 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (10ms).
2025-03-31 16:03:14.412 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (18ms).
2025-03-31 16:03:14.423 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:14.458 +04:00 INF Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:14.460 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.475 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 16:03:14.480 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:03:14.480 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:14.480 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:14.480 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.481 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.482 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:03:14.516 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:03:14.516 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.517 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:03:14.538 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.538 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.539 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:03:14.539 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:03:14.539 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:03:14.539 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:03:14.547 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:03:14.549 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.552 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:03:14.553 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.553 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:03:14.569 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:03:14.573 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:14.575 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:03:37.834 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:03:38.384 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:38.387 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:38.500 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:03:39.286 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:03:57.361 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:03:57.995 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:57.998 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:03:58.076 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:03:58.259 +04:00 DBG Creating DbConnection.
2025-03-31 16:03:58.302 +04:00 DBG Created DbConnection. (39ms).
2025-03-31 16:03:58.304 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:58.310 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:58.464 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:58.471 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:58.481 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 16:03:58.484 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (16ms).
2025-03-31 16:03:58.498 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:58.535 +04:00 INF Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:58.538 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:58.554 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (7ms).
2025-03-31 16:03:58.554 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:58.556 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:58.558 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:03:58.564 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:03:58.564 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:58.564 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:58.565 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:03:58.602 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:03:58.702 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:03:58.708 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:03:58.710 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:58.710 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.711 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:03:58.712 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:03:58.719 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:03:58.720 +04:00 DBG Committing transaction.
2025-03-31 16:03:58.724 +04:00 DBG Committed transaction.
2025-03-31 16:03:58.726 +04:00 DBG Disposing transaction.
2025-03-31 16:03:58.729 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:03:58.733 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:03:58.735 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:58.735 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.735 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.735 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:58.736 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:03:58.736 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:03:58.737 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:58.737 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:03:58.737 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:03:58.737 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:03:58.739 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:03:58.739 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:03:58.739 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:03:58.740 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:03:58.749 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:03:58.752 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:03:58.755 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:03:58.767 +04:00 INF Applying migration '20250331120339_Init'.
2025-03-31 16:03:58.828 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:58.828 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.828 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.828 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 16:03:58.947 +04:00 INF Executed DbCommand (119ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Accounts] (
    [Id] int NOT NULL IDENTITY,
    [Email] varchar(255) NOT NULL,
    [Phone] varchar(50) NOT NULL,
    [PasswordHash] varchar(512) NOT NULL,
    [Role] varchar(50) NOT NULL,
    CONSTRAINT [PK_Accounts] PRIMARY KEY ([Id])
);
2025-03-31 16:03:58.948 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:58.948 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.948 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.948 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 16:03:58.955 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-31 16:03:58.955 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:58.955 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.955 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.955 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE NO ACTION
);
2025-03-31 16:03:58.983 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CompanyDetails] (
    [AccountId] int NOT NULL,
    [CompanyName] varchar(255) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_CompanyDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_CompanyDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE NO ACTION
);
2025-03-31 16:03:58.983 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:58.983 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.983 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:58.984 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE NO ACTION
);
2025-03-31 16:03:59.058 +04:00 INF Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserDetails] (
    [AccountId] int NOT NULL,
    [FirstName] varchar(100) NOT NULL,
    [LastName] varchar(100) NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_UserDetails] PRIMARY KEY ([AccountId]),
    CONSTRAINT [FK_UserDetails_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE NO ACTION
);
2025-03-31 16:03:59.059 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:59.059 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.059 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.059 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 16:03:59.423 +04:00 INF Executed DbCommand (364ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Offers] (
    [Id] int NOT NULL IDENTITY,
    [Name] varchar(255) NOT NULL,
    [Description] varchar(1000) NOT NULL,
    [Count] int NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [CategoryId] int NOT NULL,
    [AccountId] int NOT NULL,
    [ArchiveAt] datetime2 NOT NULL,
    [IsArchived] bit NOT NULL,
    CONSTRAINT [PK_Offers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Offers_Accounts_AccountId] FOREIGN KEY ([AccountId]) REFERENCES [Accounts] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Offers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE
);
2025-03-31 16:03:59.423 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:59.423 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.424 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.424 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [UserId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]),
    CONSTRAINT [FK_Transactions_UserDetails_UserId] FOREIGN KEY ([UserId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE NO ACTION
);
2025-03-31 16:03:59.434 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Transactions] (
    [Id] int NOT NULL IDENTITY,
    [Count] int NOT NULL,
    [Paid] decimal(18,2) NOT NULL,
    [CreatedAt] datetime NOT NULL,
    [UserId] int NOT NULL,
    [OfferId] int NOT NULL,
    CONSTRAINT [PK_Transactions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Transactions_Offers_OfferId] FOREIGN KEY ([OfferId]) REFERENCES [Offers] ([Id]),
    CONSTRAINT [FK_Transactions_UserDetails_UserId] FOREIGN KEY ([UserId]) REFERENCES [UserDetails] ([AccountId]) ON DELETE NO ACTION
);
2025-03-31 16:03:59.434 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:59.435 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.435 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.435 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Offers_AccountId] ON [Offers] ([AccountId]);
2025-03-31 16:03:59.443 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Offers_AccountId] ON [Offers] ([AccountId]);
2025-03-31 16:03:59.444 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:59.444 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.444 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.444 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Offers_CategoryId] ON [Offers] ([CategoryId]);
2025-03-31 16:03:59.446 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Offers_CategoryId] ON [Offers] ([CategoryId]);
2025-03-31 16:03:59.446 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:59.446 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.447 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.447 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_OfferId] ON [Transactions] ([OfferId]);
2025-03-31 16:03:59.449 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_OfferId] ON [Transactions] ([OfferId]);
2025-03-31 16:03:59.449 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:59.449 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.449 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.450 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_UserId] ON [Transactions] ([UserId]);
2025-03-31 16:03:59.987 +04:00 INF Executed DbCommand (537ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Transactions_UserId] ON [Transactions] ([UserId]);
2025-03-31 16:03:59.987 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:03:59.987 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.987 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:03:59.987 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250331120339_Init', N'9.0.3');
2025-03-31 16:04:00.004 +04:00 INF Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250331120339_Init', N'9.0.3');
2025-03-31 16:04:00.004 +04:00 DBG Committing transaction.
2025-03-31 16:04:00.005 +04:00 DBG Committed transaction.
2025-03-31 16:04:00.006 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:04:00.006 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:04:00.006 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:04:00.006 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:04:00.041 +04:00 INF Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:04:00.041 +04:00 DBG Disposing transaction.
2025-03-31 16:04:00.041 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:04:00.042 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:04:00.044 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:04:00.048 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:04:00.049 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:08:11.391 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:08:11.758 +04:00 INF starting web host
2025-03-31 16:08:12.086 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:08:13.003 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:08:13.004 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:08:13.106 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:08:13.368 +04:00 DBG Creating DbConnection.
2025-03-31 16:08:13.576 +04:00 DBG Created DbConnection. (203ms).
2025-03-31 16:08:13.578 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:13.603 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:14.089 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:14.097 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:08:14.111 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 16:08:14.115 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (17ms).
2025-03-31 16:08:14.121 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:08:14.155 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:08:14.159 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:14.168 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 16:08:14.168 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:14.171 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:14.173 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:08:14.176 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:08:14.176 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:08:14.176 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:08:14.177 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:08:14.199 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:08:14.310 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:08:14.321 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:08:14.323 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:08:14.323 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:08:14.327 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 16:08:14.327 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:08:14.330 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:08:14.332 +04:00 DBG Committing transaction.
2025-03-31 16:08:14.338 +04:00 DBG Committed transaction.
2025-03-31 16:08:14.344 +04:00 DBG Disposing transaction.
2025-03-31 16:08:14.347 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:08:14.348 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:08:14.350 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:08:14.350 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:08:14.350 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:08:14.350 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:08:14.351 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:08:14.352 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:08:14.352 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:08:14.352 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:08:14.352 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:08:14.354 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:08:14.359 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:08:14.359 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:08:14.359 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:08:14.360 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:08:14.402 +04:00 INF Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:08:14.407 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:14.411 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-03-31 16:08:14.420 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:08:14.420 +04:00 DBG Committing transaction.
2025-03-31 16:08:14.442 +04:00 DBG Committed transaction.
2025-03-31 16:08:14.442 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:08:14.442 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:08:14.442 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:08:14.442 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:08:14.461 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:08:14.461 +04:00 DBG Disposing transaction.
2025-03-31 16:08:14.461 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:14.462 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:08:14.637 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:08:15.156 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:08:15.245 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.245 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.245 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:08:15.245 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:08:15.245 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:08:15.245 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:08:15.263 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:08:15.267 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.267 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:08:15.268 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.268 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:08:15.332 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 16:08:15.521 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 16:08:15.532 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-03-31 16:08:15.538 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-03-31 16:08:15.564 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-03-31 16:08:15.702 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.708 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.718 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:08:15.718 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:08:15.726 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (7ms).
2025-03-31 16:08:15.736 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-31 16:08:15.829 +04:00 INF Executed DbCommand (103ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-31 16:08:15.835 +04:00 DBG Hosting starting
2025-03-31 16:08:15.872 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-03-31 16:08:15.880 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:08:15.892 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.896 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 66ms reading results.
2025-03-31 16:08:15.903 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.903 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 16:08:15.922 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 16:08:15.928 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 1 entities written to the database.
2025-03-31 16:08:15.930 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:08:15.931 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:08:15.934 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:15.935 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:08:15.953 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:08:15.972 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:08:15.979 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:08:15.980 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:08:15.983 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:08:15.986 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:08:15.988 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:08:15.993 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:08:15.995 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:08:16.046 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:08:16.062 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:08:16.164 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:08:16.177 +04:00 DBG Creating DbConnection.
2025-03-31 16:08:16.177 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 16:08:16.177 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:16.178 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:16.178 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:08:16.178 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:08:16.178 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:08:16.178 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:08:16.182 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:08:16.191 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:16.191 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 8ms reading results.
2025-03-31 16:08:16.192 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:16.193 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 16:08:16.194 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:08:16.194 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:08:16.194 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:08:16.234 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:08:16.251 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:08:16.349 +04:00 ERR BackgroundService failedSystem.Threading.Tasks.TaskCanceledException: A task was canceled.
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:08:16.382 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71

2025-03-31 16:10:24.806 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:10:25.184 +04:00 INF starting web host
2025-03-31 16:10:25.450 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:10:26.237 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:10:26.238 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:10:26.314 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:10:26.450 +04:00 DBG Creating DbConnection.
2025-03-31 16:10:26.490 +04:00 DBG Created DbConnection. (38ms).
2025-03-31 16:10:26.492 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:26.503 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:26.848 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:26.855 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:10:26.864 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 16:10:26.867 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-03-31 16:10:26.874 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:10:26.907 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:10:26.910 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:26.921 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 16:10:26.921 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:26.923 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:26.924 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:10:26.928 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:10:26.928 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:10:26.928 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:10:26.929 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:10:26.945 +04:00 INF Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:10:27.008 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:10:27.015 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:10:27.016 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:10:27.017 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:10:27.018 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:10:27.018 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:10:27.022 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:10:27.025 +04:00 DBG Committing transaction.
2025-03-31 16:10:27.031 +04:00 DBG Committed transaction.
2025-03-31 16:10:27.035 +04:00 DBG Disposing transaction.
2025-03-31 16:10:27.037 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:10:27.038 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:10:27.041 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:10:27.041 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:10:27.041 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:10:27.041 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:10:27.043 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:10:27.044 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:10:27.044 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:10:27.045 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:10:27.045 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:10:27.046 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:10:27.049 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:10:27.049 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:10:27.050 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:10:27.050 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:10:27.053 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:10:27.056 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.057 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:10:27.063 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:10:27.063 +04:00 DBG Committing transaction.
2025-03-31 16:10:27.064 +04:00 DBG Committed transaction.
2025-03-31 16:10:27.064 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:10:27.064 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:10:27.064 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:10:27.065 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:10:27.067 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:10:27.068 +04:00 DBG Disposing transaction.
2025-03-31 16:10:27.068 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.068 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:10:27.121 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:10:27.413 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:10:27.448 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.449 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.449 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:10:27.449 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:10:27.449 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:10:27.449 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:10:27.457 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:10:27.459 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.460 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:10:27.460 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.460 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:10:27.462 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:10:27.464 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.466 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:10:27.475 +04:00 DBG Hosting starting
2025-03-31 16:10:27.510 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:10:27.538 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:10:27.549 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:10:27.563 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:10:27.568 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:10:27.569 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:10:27.571 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:10:27.573 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:10:27.575 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:10:27.578 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:10:27.579 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:10:27.626 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:10:27.644 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:10:27.774 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:10:27.804 +04:00 DBG Creating DbConnection.
2025-03-31 16:10:27.807 +04:00 DBG Created DbConnection. (2ms).
2025-03-31 16:10:27.810 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.817 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.817 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:10:27.818 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:10:27.818 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:10:27.818 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:10:27.912 +04:00 INF Executed DbCommand (94ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:10:27.927 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.928 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 15ms reading results.
2025-03-31 16:10:27.945 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.945 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 16:10:27.947 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:10:27.947 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:10:27.947 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:10:27.966 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:10:27.998 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:10:28.121 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71

2025-03-31 16:10:28.126 +04:00 ERR BackgroundService failedSystem.Threading.Tasks.TaskCanceledException: A task was canceled.
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:14:14.096 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:14:17.433 +04:00 INF starting web host
2025-03-31 16:14:18.844 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:14:19.845 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:14:19.846 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:14:19.986 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:14:20.218 +04:00 DBG Creating DbConnection.
2025-03-31 16:14:20.267 +04:00 DBG Created DbConnection. (46ms).
2025-03-31 16:14:20.269 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.284 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.608 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.613 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:14:20.619 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 16:14:20.621 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-03-31 16:14:20.626 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:14:20.650 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:14:20.652 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.663 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (7ms).
2025-03-31 16:14:20.663 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.665 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.666 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:14:20.668 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:14:20.668 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:14:20.669 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:14:20.669 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:14:20.689 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:14:20.812 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:14:20.820 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:14:20.822 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:14:20.822 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:14:20.825 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 16:14:20.825 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:14:20.829 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:14:20.831 +04:00 DBG Committing transaction.
2025-03-31 16:14:20.837 +04:00 DBG Committed transaction.
2025-03-31 16:14:20.843 +04:00 DBG Disposing transaction.
2025-03-31 16:14:20.847 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:14:20.849 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:14:20.851 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:14:20.852 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:14:20.852 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:14:20.852 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:14:20.856 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:14:20.857 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:14:20.858 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:14:20.858 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-03-31 16:14:20.858 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:14:20.863 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:14:20.866 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:14:20.866 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:14:20.866 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:14:20.867 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:14:20.873 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:14:20.877 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.879 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:14:20.886 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:14:20.886 +04:00 DBG Committing transaction.
2025-03-31 16:14:20.887 +04:00 DBG Committed transaction.
2025-03-31 16:14:20.888 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:14:20.888 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:14:20.888 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:14:20.888 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:14:20.890 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:14:20.891 +04:00 DBG Disposing transaction.
2025-03-31 16:14:20.891 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:20.892 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:14:20.978 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:14:21.263 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:14:21.297 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:21.297 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:21.298 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:14:21.298 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:14:21.298 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:14:21.298 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:14:21.301 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:14:21.304 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:21.304 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:14:21.304 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:21.304 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:14:21.308 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:14:21.310 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:21.311 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:14:30.688 +04:00 DBG Hosting starting
2025-03-31 16:14:30.722 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:14:30.742 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:14:30.750 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:14:30.760 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:14:30.763 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:14:30.764 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:14:30.767 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:14:30.768 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:14:30.770 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:14:30.772 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:14:30.773 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:14:30.792 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:14:30.804 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:14:30.851 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:14:30.873 +04:00 DBG Creating DbConnection.
2025-03-31 16:14:30.874 +04:00 DBG Created DbConnection. (1ms).
2025-03-31 16:14:30.878 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:30.882 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:30.883 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:14:30.883 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:14:30.884 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:14:30.885 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:14:30.902 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:14:30.914 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:30.916 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 12ms reading results.
2025-03-31 16:14:30.918 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:30.919 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:14:30.926 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:14:30.926 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:14:30.926 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:14:30.935 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:14:30.943 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:14:30.970 +04:00 ERR BackgroundService failedSystem.Threading.Tasks.TaskCanceledException: A task was canceled.
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 32
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:15:27.996 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71

2025-03-31 16:22:53.148 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:22:59.718 +04:00 INF starting web host
2025-03-31 16:23:01.029 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:23:01.876 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:23:01.878 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:23:01.973 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:23:02.143 +04:00 DBG Creating DbConnection.
2025-03-31 16:23:02.203 +04:00 DBG Created DbConnection. (58ms).
2025-03-31 16:23:02.205 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.223 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.617 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.623 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:23:02.631 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 16:23:02.633 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-03-31 16:23:02.639 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:23:02.663 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:23:02.666 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.677 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 16:23:02.677 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.678 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.680 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:23:02.682 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:23:02.682 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:23:02.683 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:23:02.683 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:23:02.708 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:23:02.807 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:23:02.814 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:23:02.815 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:23:02.815 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:23:02.816 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:23:02.817 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:23:02.818 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:23:02.820 +04:00 DBG Committing transaction.
2025-03-31 16:23:02.827 +04:00 DBG Committed transaction.
2025-03-31 16:23:02.829 +04:00 DBG Disposing transaction.
2025-03-31 16:23:02.831 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:23:02.831 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:23:02.832 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:23:02.833 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:23:02.833 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:23:02.833 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:23:02.834 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:23:02.834 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:23:02.834 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:23:02.835 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:23:02.835 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:23:02.835 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:23:02.837 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:23:02.837 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:23:02.837 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:23:02.839 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:23:02.841 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:23:02.844 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.845 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:23:02.850 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:23:02.851 +04:00 DBG Committing transaction.
2025-03-31 16:23:02.851 +04:00 DBG Committed transaction.
2025-03-31 16:23:02.852 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:23:02.852 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:23:02.852 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:23:02.852 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:23:02.854 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:23:02.854 +04:00 DBG Disposing transaction.
2025-03-31 16:23:02.854 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:02.855 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 16:23:02.932 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:23:03.189 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:23:03.229 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:03.229 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:03.229 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:23:03.229 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:23:03.230 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:23:03.230 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:23:03.232 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:23:03.235 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:03.235 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:23:03.235 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:03.236 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:23:03.237 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:23:03.240 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:03.242 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-03-31 16:23:05.250 +04:00 DBG Hosting starting
2025-03-31 16:23:05.283 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:23:14.019 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:23:14.037 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:23:14.056 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:23:14.061 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:23:14.062 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:23:14.064 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:23:14.066 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:23:14.068 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:23:14.070 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:23:14.075 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:23:14.138 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:23:14.152 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:23:14.205 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:23:14.229 +04:00 DBG Creating DbConnection.
2025-03-31 16:23:14.230 +04:00 DBG Created DbConnection. (1ms).
2025-03-31 16:23:14.233 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:14.235 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:14.236 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:23:14.236 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:23:14.237 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:23:14.238 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:23:14.257 +04:00 INF Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:23:14.276 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:14.277 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 18ms reading results.
2025-03-31 16:23:14.281 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:14.282 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 16:23:14.283 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:23:14.283 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:23:14.283 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:23:14.300 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:23:14.310 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:27:48.882 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:27:50.014 +04:00 INF starting web host
2025-03-31 16:27:50.601 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:27:51.437 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:27:51.438 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:27:51.531 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:27:51.749 +04:00 DBG Creating DbConnection.
2025-03-31 16:27:51.787 +04:00 DBG Created DbConnection. (35ms).
2025-03-31 16:27:51.788 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:51.799 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.053 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.058 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:27:52.067 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 16:27:52.069 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-03-31 16:27:52.079 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:27:52.115 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:27:52.120 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.137 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (11ms).
2025-03-31 16:27:52.137 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.139 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.141 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:27:52.144 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:27:52.145 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:27:52.145 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:27:52.146 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:27:52.180 +04:00 INF Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:27:52.256 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:27:52.262 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:27:52.263 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:27:52.263 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:27:52.264 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:27:52.265 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:27:52.270 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:27:52.272 +04:00 DBG Committing transaction.
2025-03-31 16:27:52.275 +04:00 DBG Committed transaction.
2025-03-31 16:27:52.277 +04:00 DBG Disposing transaction.
2025-03-31 16:27:52.282 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:27:52.284 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:27:52.286 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:27:52.286 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:27:52.286 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:27:52.287 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:27:52.290 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:27:52.291 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:27:52.291 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:27:52.291 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:27:52.291 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:27:52.294 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:27:52.297 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:27:52.297 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:27:52.297 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:27:52.298 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:27:52.304 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:27:52.308 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.312 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 16:27:52.320 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:27:52.321 +04:00 DBG Committing transaction.
2025-03-31 16:27:52.322 +04:00 DBG Committed transaction.
2025-03-31 16:27:52.322 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:27:52.322 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:27:52.322 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:27:52.322 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:27:52.326 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:27:52.326 +04:00 DBG Disposing transaction.
2025-03-31 16:27:52.326 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.327 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:27:52.431 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:27:52.731 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:27:52.785 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.785 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.785 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:27:52.785 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:27:52.785 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:27:52.786 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:27:52.792 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:27:52.796 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.796 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:27:52.796 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.796 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:27:52.798 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:27:52.800 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:27:52.802 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:27:54.240 +04:00 DBG Hosting starting
2025-03-31 16:27:54.270 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:28:04.827 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:28:04.843 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:28:04.854 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:28:04.865 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:28:04.867 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:28:04.869 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:28:04.871 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:28:04.873 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:28:04.876 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:28:04.878 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:28:11.465 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:28:11.900 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:28:11.969 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:28:12.007 +04:00 DBG Creating DbConnection.
2025-03-31 16:28:12.008 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 16:28:12.011 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:28:12.014 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:28:12.015 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:28:12.015 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:28:12.015 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:28:12.016 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:28:12.042 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:28:12.083 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:28:12.084 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 41ms reading results.
2025-03-31 16:28:12.086 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:28:12.087 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:28:12.565 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:28:12.565 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:28:12.565 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:28:13.278 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:28:13.286 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:28:35.210 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71

2025-03-31 16:28:35.238 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:30:14.752 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:30:15.704 +04:00 INF starting web host
2025-03-31 16:30:16.213 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:30:17.067 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:30:17.068 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:30:17.141 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:30:17.311 +04:00 DBG Creating DbConnection.
2025-03-31 16:30:17.353 +04:00 DBG Created DbConnection. (39ms).
2025-03-31 16:30:17.355 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.370 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.694 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.698 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:30:17.704 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 16:30:17.706 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-03-31 16:30:17.713 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:30:17.737 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:30:17.739 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.748 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 16:30:17.748 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.749 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.750 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:30:17.753 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:30:17.753 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:30:17.753 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:30:17.754 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:30:17.776 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:30:17.862 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:30:17.871 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:30:17.873 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:30:17.874 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:30:17.875 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:30:17.875 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:30:17.884 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:30:17.886 +04:00 DBG Committing transaction.
2025-03-31 16:30:17.889 +04:00 DBG Committed transaction.
2025-03-31 16:30:17.891 +04:00 DBG Disposing transaction.
2025-03-31 16:30:17.894 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:30:17.894 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:30:17.896 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:30:17.897 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:30:17.897 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:30:17.897 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:30:17.899 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:30:17.899 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:30:17.900 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:30:17.900 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:30:17.900 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:30:17.901 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:30:17.903 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:30:17.903 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:30:17.903 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:30:17.904 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:30:17.908 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:30:17.912 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.913 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:30:17.920 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:30:17.920 +04:00 DBG Committing transaction.
2025-03-31 16:30:17.921 +04:00 DBG Committed transaction.
2025-03-31 16:30:17.921 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:30:17.922 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:30:17.922 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:30:17.922 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:30:17.926 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:30:17.927 +04:00 DBG Disposing transaction.
2025-03-31 16:30:17.927 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:17.928 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:30:18.001 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:30:18.376 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:30:18.413 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:18.414 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:18.415 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:30:18.415 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:30:18.415 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:30:18.415 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:30:18.421 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:30:18.424 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:18.424 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:30:18.424 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:18.425 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:30:18.426 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:30:18.429 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:18.430 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:30:20.839 +04:00 DBG Hosting starting
2025-03-31 16:30:20.860 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:30:20.876 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:30:20.883 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:30:20.894 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:30:20.899 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:30:20.900 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:30:20.903 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:30:20.905 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:30:20.906 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:30:20.908 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:30:20.909 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:30:20.937 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:30:20.956 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:30:21.029 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:30:21.049 +04:00 DBG Creating DbConnection.
2025-03-31 16:30:21.049 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 16:30:21.051 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:21.053 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:21.054 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:30:21.054 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:30:21.054 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:30:21.055 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:30:21.087 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:30:21.101 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:21.102 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-03-31 16:30:21.103 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:21.104 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:30:21.110 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:30:21.111 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:30:21.111 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:30:21.120 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:30:21.127 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:30:21.169 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:30:31.693 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71

2025-03-31 16:30:31.698 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:31:15.879 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:31:16.612 +04:00 INF starting web host
2025-03-31 16:31:17.180 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:31:18.053 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:31:18.055 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:31:18.202 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:31:18.390 +04:00 DBG Creating DbConnection.
2025-03-31 16:31:18.431 +04:00 DBG Created DbConnection. (39ms).
2025-03-31 16:31:18.433 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:18.445 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:18.757 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:18.765 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:31:18.776 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 16:31:18.780 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-03-31 16:31:18.794 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:31:18.823 +04:00 INF Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:31:18.826 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:18.837 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (7ms).
2025-03-31 16:31:18.837 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:18.838 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:18.839 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:31:18.843 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:31:18.844 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:31:18.844 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:31:18.845 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:31:18.871 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:31:19.004 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:31:19.017 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:31:19.019 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:31:19.020 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:31:19.021 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:31:19.021 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:31:19.040 +04:00 INF Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:31:19.043 +04:00 DBG Committing transaction.
2025-03-31 16:31:19.048 +04:00 DBG Committed transaction.
2025-03-31 16:31:19.050 +04:00 DBG Disposing transaction.
2025-03-31 16:31:19.053 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:31:19.053 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:31:19.055 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:31:19.055 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:31:19.055 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:31:19.055 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:31:19.056 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:31:19.057 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:31:19.057 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:31:19.057 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:31:19.057 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:31:19.058 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:31:19.061 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:31:19.061 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:31:19.061 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:31:19.061 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:31:19.066 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:31:19.069 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:19.071 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:31:19.080 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:31:19.080 +04:00 DBG Committing transaction.
2025-03-31 16:31:19.081 +04:00 DBG Committed transaction.
2025-03-31 16:31:19.081 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:31:19.081 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:31:19.081 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:31:19.081 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:31:19.084 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:31:19.084 +04:00 DBG Disposing transaction.
2025-03-31 16:31:19.084 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:19.085 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:31:19.232 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:31:19.680 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:31:19.743 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:19.743 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:19.743 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:31:19.743 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:31:19.744 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:31:19.744 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:31:19.748 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:31:19.751 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:19.751 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:31:19.751 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:19.751 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:31:19.753 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:31:19.755 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:19.756 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:31:27.277 +04:00 DBG Hosting starting
2025-03-31 16:31:27.309 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:31:27.335 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:31:27.353 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:31:27.370 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:31:27.378 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:31:27.379 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:31:27.382 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:31:27.383 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:31:27.385 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:31:27.388 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:31:27.389 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:31:27.431 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:31:27.445 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:31:27.514 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:31:27.538 +04:00 DBG Creating DbConnection.
2025-03-31 16:31:27.538 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 16:31:27.541 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:27.545 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:27.546 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:31:27.546 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:31:27.546 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:31:27.546 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:31:27.578 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:31:27.598 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:27.599 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 20ms reading results.
2025-03-31 16:31:27.602 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:27.603 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 16:31:27.604 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:31:27.605 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:31:27.605 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:31:27.697 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:31:27.714 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:37:35.317 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:37:36.390 +04:00 INF starting web host
2025-03-31 16:37:36.943 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:37:37.827 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:37:37.828 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:37:37.924 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:37:38.070 +04:00 DBG Creating DbConnection.
2025-03-31 16:37:38.145 +04:00 DBG Created DbConnection. (73ms).
2025-03-31 16:37:38.147 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.162 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.560 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.569 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:37:38.578 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 16:37:38.580 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-03-31 16:37:38.587 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:37:38.618 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:37:38.621 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.631 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 16:37:38.631 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.633 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.635 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:37:38.640 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:37:38.640 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:37:38.640 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:37:38.641 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:37:38.668 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:37:38.779 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:37:38.786 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:37:38.787 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:37:38.788 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:37:38.791 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 16:37:38.791 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:37:38.796 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:37:38.798 +04:00 DBG Committing transaction.
2025-03-31 16:37:38.802 +04:00 DBG Committed transaction.
2025-03-31 16:37:38.803 +04:00 DBG Disposing transaction.
2025-03-31 16:37:38.807 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:37:38.807 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:37:38.809 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:37:38.809 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:37:38.809 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:37:38.810 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:37:38.810 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:37:38.811 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:37:38.811 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:37:38.811 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:37:38.812 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:37:38.812 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:37:38.815 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:37:38.815 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:37:38.815 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:37:38.816 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:37:38.820 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:37:38.825 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.827 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 16:37:38.833 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:37:38.834 +04:00 DBG Committing transaction.
2025-03-31 16:37:38.834 +04:00 DBG Committed transaction.
2025-03-31 16:37:38.835 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:37:38.835 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:37:38.835 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:37:38.835 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:37:38.840 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:37:38.840 +04:00 DBG Disposing transaction.
2025-03-31 16:37:38.840 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:38.841 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:37:38.914 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:37:39.223 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:37:39.257 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:39.258 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:39.258 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:37:39.258 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:37:39.258 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:37:39.258 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:37:39.262 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:37:39.264 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:39.264 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:37:39.265 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:39.265 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:37:39.266 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:37:39.268 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:39.269 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:37:39.735 +04:00 DBG Hosting starting
2025-03-31 16:37:39.768 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:37:39.789 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:37:39.803 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:37:39.822 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:37:39.827 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:37:39.828 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:37:39.830 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:37:39.832 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:37:39.833 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:37:39.835 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:37:39.836 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:37:39.863 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:37:39.887 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:37:40.001 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:37:40.046 +04:00 DBG Creating DbConnection.
2025-03-31 16:37:40.047 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 16:37:40.049 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:40.052 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:40.053 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:37:40.053 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:37:40.054 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:37:40.055 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:37:40.094 +04:00 INF Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:37:40.111 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:40.113 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 18ms reading results.
2025-03-31 16:37:40.115 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:40.119 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:37:40.124 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:37:40.124 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:37:40.124 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:37:40.193 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:37:40.203 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:37:40.271 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:37:50.545 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 72

2025-03-31 16:37:51.381 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:40:57.053 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:40:57.837 +04:00 INF starting web host
2025-03-31 16:40:58.384 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:40:59.235 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:40:59.238 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:40:59.333 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:40:59.480 +04:00 DBG Creating DbConnection.
2025-03-31 16:40:59.569 +04:00 DBG Created DbConnection. (85ms).
2025-03-31 16:40:59.572 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:40:59.593 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:40:59.983 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:40:59.993 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:41:00.005 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (8ms).
2025-03-31 16:41:00.009 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (17ms).
2025-03-31 16:41:00.030 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:41:00.075 +04:00 INF Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:41:00.077 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.085 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 16:41:00.086 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.087 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.088 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:41:00.091 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:41:00.091 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:41:00.091 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:41:00.092 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:41:00.109 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:41:00.216 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:41:00.222 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:41:00.224 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:41:00.224 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:41:00.225 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:41:00.225 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:41:00.227 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:41:00.229 +04:00 DBG Committing transaction.
2025-03-31 16:41:00.232 +04:00 DBG Committed transaction.
2025-03-31 16:41:00.233 +04:00 DBG Disposing transaction.
2025-03-31 16:41:00.235 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:41:00.236 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:41:00.238 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:41:00.239 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:41:00.239 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:41:00.239 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:41:00.239 +04:00 INF Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:41:00.240 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:41:00.240 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:41:00.240 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:41:00.240 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:41:00.241 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:41:00.243 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:41:00.243 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:41:00.243 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:41:00.243 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:41:00.246 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:41:00.249 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.250 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:41:00.260 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:41:00.260 +04:00 DBG Committing transaction.
2025-03-31 16:41:00.261 +04:00 DBG Committed transaction.
2025-03-31 16:41:00.261 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:41:00.261 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:41:00.262 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:41:00.262 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:41:00.266 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:41:00.266 +04:00 DBG Disposing transaction.
2025-03-31 16:41:00.266 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.267 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 16:41:00.365 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:41:00.734 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:41:00.792 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.792 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.793 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:41:00.793 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:41:00.793 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:41:00.793 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:41:00.797 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:41:00.801 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.801 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 16:41:00.801 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.801 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:41:00.804 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:41:00.807 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:00.809 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:41:01.600 +04:00 DBG Hosting starting
2025-03-31 16:41:01.628 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:41:07.015 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:41:07.030 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:41:07.046 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:41:07.051 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:41:07.052 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:41:07.054 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:41:07.055 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:41:07.057 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:41:07.059 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:41:07.060 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:41:07.147 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:41:07.166 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:41:07.247 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:41:07.264 +04:00 DBG Creating DbConnection.
2025-03-31 16:41:07.264 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 16:41:07.266 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:07.268 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:07.269 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:41:07.269 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:41:07.269 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:41:07.270 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:41:07.285 +04:00 INF Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:41:07.296 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:07.297 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-03-31 16:41:07.299 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:07.300 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:41:07.301 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:41:07.301 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:41:07.301 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:41:07.376 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:41:07.390 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:49:31.001 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:49:31.280 +04:00 INF starting web host
2025-03-31 16:49:31.709 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:49:33.105 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:49:33.107 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:49:33.277 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:49:33.526 +04:00 DBG Creating DbConnection.
2025-03-31 16:49:33.598 +04:00 DBG Created DbConnection. (71ms).
2025-03-31 16:49:33.600 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:33.623 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:34.805 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:34.816 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:49:34.828 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 16:49:34.831 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (17ms).
2025-03-31 16:49:34.846 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:34.893 +04:00 INF Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:34.896 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:34.918 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 16:49:34.919 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:34.920 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:34.928 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:49:34.932 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:49:34.932 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:34.932 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:34.933 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:49:35.029 +04:00 INF Executed DbCommand (96ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:49:35.155 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:49:35.166 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:49:35.168 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:49:35.168 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:49:35.169 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 16:49:35.170 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:49:35.184 +04:00 INF Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:49:35.187 +04:00 DBG Committing transaction.
2025-03-31 16:49:35.197 +04:00 DBG Committed transaction.
2025-03-31 16:49:35.200 +04:00 DBG Disposing transaction.
2025-03-31 16:49:35.205 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:49:35.223 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:49:35.228 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:49:35.228 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:49:35.229 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:49:35.229 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:35.230 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:35.231 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:49:35.231 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:35.231 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:35.231 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:49:35.233 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:49:35.236 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:49:35.236 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:49:35.236 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:49:35.237 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:49:35.250 +04:00 INF Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:49:35.255 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:35.259 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-03-31 16:49:35.270 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:49:35.270 +04:00 DBG Committing transaction.
2025-03-31 16:49:35.275 +04:00 DBG Committed transaction.
2025-03-31 16:49:35.277 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:49:35.278 +04:00 DBG Created DbCommand for 'ExecuteScalar' (1ms).
2025-03-31 16:49:35.278 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-03-31 16:49:35.278 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:49:35.303 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:49:35.303 +04:00 DBG Disposing transaction.
2025-03-31 16:49:35.303 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:35.304 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 16:49:35.494 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:49:36.113 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:49:36.235 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:36.236 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:36.237 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:49:36.238 +04:00 DBG Created DbCommand for 'ExecuteReader' (1ms).
2025-03-31 16:49:36.239 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-03-31 16:49:36.239 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:49:36.255 +04:00 INF Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:49:36.259 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:36.259 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:49:36.259 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:36.260 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:49:36.262 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:49:36.266 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:36.267 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:49:36.277 +04:00 DBG Hosting starting
2025-03-31 16:49:36.314 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:49:36.397 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:49:36.420 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:49:36.453 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:49:36.461 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:49:36.462 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:49:36.464 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:49:36.465 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:49:36.467 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:49:36.469 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:49:36.470 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:49:36.604 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:49:36.619 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:49:53.434 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:49:53.616 +04:00 INF starting web host
2025-03-31 16:49:53.831 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:49:54.749 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:49:54.751 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:49:54.848 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:49:55.007 +04:00 DBG Creating DbConnection.
2025-03-31 16:49:55.085 +04:00 DBG Created DbConnection. (75ms).
2025-03-31 16:49:55.089 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.110 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.512 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.516 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:49:55.526 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 16:49:55.527 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (11ms).
2025-03-31 16:49:55.533 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:55.564 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:55.566 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.576 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 16:49:55.576 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.577 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.578 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:49:55.580 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:49:55.580 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:55.581 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:55.581 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:49:55.607 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:49:55.693 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:49:55.701 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:49:55.702 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:49:55.703 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:49:55.706 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 16:49:55.706 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:49:55.711 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:49:55.713 +04:00 DBG Committing transaction.
2025-03-31 16:49:55.717 +04:00 DBG Committed transaction.
2025-03-31 16:49:55.722 +04:00 DBG Disposing transaction.
2025-03-31 16:49:55.726 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:49:55.726 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:49:55.727 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:49:55.728 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:49:55.728 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:49:55.728 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:55.729 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:49:55.729 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:49:55.729 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:55.729 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:55.730 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:49:55.730 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:49:55.732 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:49:55.733 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:49:55.733 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:49:55.733 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:49:55.740 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:49:55.744 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.745 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 16:49:55.752 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:49:55.753 +04:00 DBG Committing transaction.
2025-03-31 16:49:55.753 +04:00 DBG Committed transaction.
2025-03-31 16:49:55.754 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:49:55.754 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:55.754 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:49:55.754 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:49:55.757 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:49:55.758 +04:00 DBG Disposing transaction.
2025-03-31 16:49:55.758 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:55.758 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:49:55.860 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:49:56.163 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:49:56.205 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:56.206 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:56.206 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:49:56.206 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:49:56.206 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:49:56.206 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:49:56.209 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:49:56.212 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:56.212 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:49:56.212 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:56.212 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:49:56.214 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:49:56.216 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:49:56.217 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:49:56.223 +04:00 DBG Hosting starting
2025-03-31 16:49:56.265 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:49:56.299 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:49:56.326 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:49:56.347 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:49:56.354 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:49:56.355 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:49:56.358 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:49:56.360 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:49:56.362 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:49:56.366 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:49:56.367 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:49:56.491 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:49:56.506 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 16:49:56.570 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 40
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:49:56.614 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 71

2025-03-31 16:49:56.629 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 40
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 16:51:43.939 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 16:51:44.156 +04:00 INF starting web host
2025-03-31 16:51:44.317 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 16:51:45.134 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:51:45.135 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 16:51:45.249 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:51:45.414 +04:00 DBG Creating DbConnection.
2025-03-31 16:51:45.454 +04:00 DBG Created DbConnection. (38ms).
2025-03-31 16:51:45.456 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:45.468 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:45.805 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:45.814 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:51:45.822 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 16:51:45.825 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-03-31 16:51:45.834 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:51:45.869 +04:00 INF Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:51:45.871 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:45.880 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 16:51:45.880 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:45.881 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:45.882 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 16:51:45.884 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:51:45.885 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:51:45.885 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:51:45.885 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:51:45.915 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 16:51:46.016 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:51:46.029 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:51:46.031 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:51:46.031 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:51:46.033 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 16:51:46.033 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:51:46.040 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 16:51:46.043 +04:00 DBG Committing transaction.
2025-03-31 16:51:46.046 +04:00 DBG Committed transaction.
2025-03-31 16:51:46.047 +04:00 DBG Disposing transaction.
2025-03-31 16:51:46.049 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 16:51:46.049 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 16:51:46.051 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 16:51:46.051 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:51:46.051 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 16:51:46.051 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:51:46.052 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 16:51:46.053 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:51:46.053 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:51:46.053 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:51:46.053 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:51:46.054 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 16:51:46.055 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:51:46.055 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:51:46.055 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:51:46.056 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:51:46.060 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 16:51:46.062 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:46.063 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 16:51:46.070 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 16:51:46.071 +04:00 DBG Committing transaction.
2025-03-31 16:51:46.071 +04:00 DBG Committed transaction.
2025-03-31 16:51:46.071 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 16:51:46.071 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:51:46.071 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 16:51:46.072 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:51:46.074 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 16:51:46.074 +04:00 DBG Disposing transaction.
2025-03-31 16:51:46.074 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:46.075 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:51:46.129 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 16:51:46.438 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 16:51:46.508 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:46.508 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:46.509 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:51:46.509 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:51:46.509 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:51:46.509 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:51:46.513 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 16:51:46.517 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:46.517 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 16:51:46.517 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:46.517 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:51:46.519 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:51:46.522 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:46.523 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 16:51:50.262 +04:00 DBG Hosting starting
2025-03-31 16:51:50.283 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 16:51:50.300 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 16:51:50.309 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 16:51:50.319 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 16:51:50.322 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:51:50.323 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 16:51:50.325 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 16:51:50.327 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 16:51:50.328 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 16:51:50.330 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 16:51:50.331 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 16:51:50.359 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 16:51:50.382 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 16:51:50.461 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 16:51:50.490 +04:00 DBG Creating DbConnection.
2025-03-31 16:51:50.492 +04:00 DBG Created DbConnection. (1ms).
2025-03-31 16:51:50.494 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:50.498 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:50.499 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 16:51:50.499 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:51:50.499 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 16:51:50.500 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:51:50.532 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 16:51:50.556 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:50.558 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 24ms reading results.
2025-03-31 16:51:50.560 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:50.561 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 16:51:50.562 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 16:51:50.562 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 16:51:50.562 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 16:51:50.593 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 16:51:50.600 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:15:12.400 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:15:12.575 +04:00 INF starting web host
2025-03-31 17:15:12.821 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:15:13.761 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:15:13.763 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:15:13.874 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:15:14.037 +04:00 DBG Creating DbConnection.
2025-03-31 17:15:14.118 +04:00 DBG Created DbConnection. (80ms).
2025-03-31 17:15:14.120 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.137 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.567 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.572 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:15:14.587 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 17:15:14.592 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (18ms).
2025-03-31 17:15:14.607 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:15:14.647 +04:00 INF Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:15:14.651 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.662 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 17:15:14.662 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.663 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.664 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:15:14.667 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:15:14.667 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:15:14.667 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:15:14.668 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:15:14.689 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:15:14.793 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:15:14.805 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:15:14.808 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:15:14.808 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:15:14.816 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-03-31 17:15:14.817 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:15:14.823 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:15:14.826 +04:00 DBG Committing transaction.
2025-03-31 17:15:14.831 +04:00 DBG Committed transaction.
2025-03-31 17:15:14.833 +04:00 DBG Disposing transaction.
2025-03-31 17:15:14.836 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:15:14.837 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:15:14.839 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:15:14.839 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:15:14.839 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:15:14.839 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:15:14.840 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:15:14.841 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:15:14.841 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:15:14.842 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:15:14.842 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:15:14.846 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:15:14.850 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:15:14.850 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:15:14.850 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:15:14.851 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:15:14.866 +04:00 INF Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:15:14.870 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.872 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:15:14.883 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:15:14.884 +04:00 DBG Committing transaction.
2025-03-31 17:15:14.884 +04:00 DBG Committed transaction.
2025-03-31 17:15:14.885 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:15:14.885 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:15:14.885 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:15:14.885 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:15:14.891 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:15:14.891 +04:00 DBG Disposing transaction.
2025-03-31 17:15:14.891 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:14.892 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:15:14.964 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:15:15.338 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:15:15.404 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:15.404 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:15.404 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:15:15.404 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:15:15.404 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:15:15.405 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:15:15.439 +04:00 INF Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:15:15.444 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:15.445 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-03-31 17:15:15.445 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:15.445 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:15:15.447 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:15:15.450 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:15.451 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:15:15.459 +04:00 DBG Hosting starting
2025-03-31 17:15:15.515 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:15:15.568 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:15:15.589 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:15:15.621 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:15:15.632 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:15:15.633 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:15:15.638 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:15:15.640 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:15:15.642 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:15:15.652 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:15:15.654 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:15:15.721 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:15:15.777 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:15:15.899 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:15:15.921 +04:00 DBG Creating DbConnection.
2025-03-31 17:15:15.921 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:15:15.923 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:15.928 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:15.929 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:15:15.929 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:15:15.929 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:15:15.930 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:15:15.990 +04:00 INF Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:15:16.007 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:16.021 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 30ms reading results.
2025-03-31 17:15:16.024 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:16.025 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:15:16.027 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:15:16.027 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:15:16.027 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:15:16.152 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:15:16.176 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:15:16.479 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 76

2025-03-31 17:15:16.521 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:18:26.050 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:18:26.278 +04:00 INF starting web host
2025-03-31 17:18:26.532 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:18:27.578 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:18:27.580 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:18:27.701 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:18:27.961 +04:00 DBG Creating DbConnection.
2025-03-31 17:18:28.068 +04:00 DBG Created DbConnection. (111ms).
2025-03-31 17:18:28.070 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:28.099 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:28.766 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:28.771 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:18:28.781 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 17:18:28.784 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-03-31 17:18:28.795 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:18:28.843 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:18:28.847 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:28.877 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (18ms).
2025-03-31 17:18:28.877 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:28.879 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:28.880 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:18:28.885 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:18:28.885 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:18:28.886 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:18:28.886 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:18:28.913 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:18:28.987 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:18:29.004 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:18:29.005 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:18:29.005 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:18:29.009 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 17:18:29.009 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:18:29.014 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:18:29.017 +04:00 DBG Committing transaction.
2025-03-31 17:18:29.021 +04:00 DBG Committed transaction.
2025-03-31 17:18:29.024 +04:00 DBG Disposing transaction.
2025-03-31 17:18:29.027 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:18:29.027 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:18:29.030 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:18:29.030 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:18:29.030 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:18:29.030 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:18:29.031 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:18:29.032 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:18:29.032 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:18:29.032 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:18:29.032 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:18:29.033 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:18:29.036 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:18:29.036 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:18:29.036 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:18:29.037 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:18:29.044 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:18:29.048 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:29.050 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 17:18:29.063 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:18:29.064 +04:00 DBG Committing transaction.
2025-03-31 17:18:29.064 +04:00 DBG Committed transaction.
2025-03-31 17:18:29.065 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:18:29.065 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:18:29.065 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:18:29.065 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:18:29.077 +04:00 INF Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:18:29.077 +04:00 DBG Disposing transaction.
2025-03-31 17:18:29.077 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:29.078 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:18:29.173 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:18:29.692 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:18:29.778 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:29.778 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:29.779 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:18:29.779 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:18:29.779 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:18:29.779 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:18:29.787 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:18:29.791 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:29.792 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 17:18:29.792 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:29.792 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:18:29.795 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:18:29.797 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:29.799 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:18:29.806 +04:00 DBG Hosting starting
2025-03-31 17:18:29.945 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:18:29.993 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:18:30.016 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:18:30.039 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:18:30.046 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:18:30.047 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:18:30.050 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:18:30.052 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:18:30.054 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:18:30.057 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:18:30.059 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:18:30.115 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:18:30.162 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:18:30.339 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:18:30.365 +04:00 DBG Creating DbConnection.
2025-03-31 17:18:30.366 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:18:30.369 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:30.374 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:30.374 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:18:30.375 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:18:30.375 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:18:30.375 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:18:30.410 +04:00 INF Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:18:30.436 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:30.437 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 22ms reading results.
2025-03-31 17:18:30.441 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:30.450 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (9ms).
2025-03-31 17:18:30.465 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:18:30.466 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:18:30.466 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:18:30.604 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:18:30.625 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:18:30.836 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 76

2025-03-31 17:18:30.903 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:23:51.969 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:23:52.486 +04:00 INF starting web host
2025-03-31 17:23:53.014 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:23:53.966 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:23:53.967 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:23:54.042 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:23:54.230 +04:00 DBG Creating DbConnection.
2025-03-31 17:23:54.302 +04:00 DBG Created DbConnection. (73ms).
2025-03-31 17:23:54.303 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.317 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.686 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.691 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:23:54.698 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-03-31 17:23:54.701 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-03-31 17:23:54.707 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:23:54.739 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:23:54.741 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.749 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 17:23:54.750 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.751 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.752 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:23:54.754 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:23:54.754 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:23:54.754 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:23:54.755 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:23:54.774 +04:00 INF Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:23:54.881 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:23:54.888 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:23:54.889 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:23:54.890 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:23:54.891 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 17:23:54.891 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:23:54.896 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:23:54.898 +04:00 DBG Committing transaction.
2025-03-31 17:23:54.903 +04:00 DBG Committed transaction.
2025-03-31 17:23:54.905 +04:00 DBG Disposing transaction.
2025-03-31 17:23:54.907 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:23:54.908 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:23:54.910 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:23:54.910 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:23:54.910 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:23:54.910 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:23:54.911 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:23:54.911 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:23:54.912 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:23:54.912 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:23:54.912 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:23:54.913 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:23:54.916 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:23:54.916 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:23:54.916 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:23:54.917 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:23:54.921 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:23:54.924 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.925 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 17:23:54.932 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:23:54.933 +04:00 DBG Committing transaction.
2025-03-31 17:23:54.933 +04:00 DBG Committed transaction.
2025-03-31 17:23:54.933 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:23:54.933 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:23:54.934 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:23:54.934 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:23:54.938 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:23:54.938 +04:00 DBG Disposing transaction.
2025-03-31 17:23:54.938 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:54.939 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:23:55.018 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:23:55.320 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:23:55.373 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:55.373 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:55.373 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:23:55.373 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:23:55.374 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:23:55.374 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:23:55.378 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:23:55.382 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:55.382 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:23:55.382 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:55.382 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:23:55.384 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:23:55.388 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:55.390 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:23:56.416 +04:00 DBG Hosting starting
2025-03-31 17:23:56.447 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:23:56.463 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:23:56.480 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:23:56.496 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:23:56.503 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:23:56.503 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:23:56.505 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:23:56.507 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:23:56.508 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:23:56.511 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:23:56.512 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:23:56.535 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:23:56.549 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:23:56.615 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:23:56.652 +04:00 DBG Creating DbConnection.
2025-03-31 17:23:56.653 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:23:56.655 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:56.658 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:56.660 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:23:56.660 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:23:56.660 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:23:56.661 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:23:56.685 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:23:56.700 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:56.701 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 15ms reading results.
2025-03-31 17:23:56.704 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:56.705 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:23:56.738 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:23:56.739 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:23:56.739 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:23:56.793 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:23:56.802 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:26:47.126 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:26:47.315 +04:00 INF starting web host
2025-03-31 17:26:47.557 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:26:48.674 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:26:48.678 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:26:48.785 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:26:49.013 +04:00 DBG Creating DbConnection.
2025-03-31 17:26:49.086 +04:00 DBG Created DbConnection. (71ms).
2025-03-31 17:26:49.087 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.105 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.585 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.594 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:26:49.608 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (10ms).
2025-03-31 17:26:49.613 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (20ms).
2025-03-31 17:26:49.625 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:26:49.680 +04:00 INF Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:26:49.684 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.701 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (10ms).
2025-03-31 17:26:49.702 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.706 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.708 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:26:49.713 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:26:49.713 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:26:49.714 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:26:49.715 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:26:49.740 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:26:49.874 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:26:49.884 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:26:49.886 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:26:49.886 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:26:49.887 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 17:26:49.888 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:26:49.890 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:26:49.892 +04:00 DBG Committing transaction.
2025-03-31 17:26:49.896 +04:00 DBG Committed transaction.
2025-03-31 17:26:49.899 +04:00 DBG Disposing transaction.
2025-03-31 17:26:49.901 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:26:49.901 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:26:49.904 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:26:49.904 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:26:49.904 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:26:49.904 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:26:49.906 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:26:49.906 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:26:49.906 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:26:49.906 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:26:49.907 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:26:49.907 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:26:49.910 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:26:49.910 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:26:49.910 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:26:49.911 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:26:49.914 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:26:49.917 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.919 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:26:49.926 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:26:49.927 +04:00 DBG Committing transaction.
2025-03-31 17:26:49.929 +04:00 DBG Committed transaction.
2025-03-31 17:26:49.930 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:26:49.930 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:26:49.930 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:26:49.930 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:26:49.932 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:26:49.932 +04:00 DBG Disposing transaction.
2025-03-31 17:26:49.932 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:49.933 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:26:50.008 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:26:50.338 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:26:50.411 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.412 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.413 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:26:50.413 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:26:50.413 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:26:50.413 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:26:50.418 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:26:50.422 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.422 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:26:50.422 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.422 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:26:50.424 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:26:50.428 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.429 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:26:50.434 +04:00 DBG Hosting starting
2025-03-31 17:26:50.463 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:26:50.486 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:26:50.501 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:26:50.519 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:26:50.532 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:26:50.533 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:26:50.536 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:26:50.538 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:26:50.540 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:26:50.543 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:26:50.546 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:26:50.594 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:26:50.627 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:26:50.736 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:26:50.755 +04:00 DBG Creating DbConnection.
2025-03-31 17:26:50.756 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:26:50.758 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.763 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.763 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:26:50.764 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:26:50.764 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:26:50.764 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:26:50.839 +04:00 INF Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:26:50.873 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.874 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 35ms reading results.
2025-03-31 17:26:50.877 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.879 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 17:26:50.880 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:26:50.881 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:26:50.881 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:26:50.970 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:26:50.980 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:26:51.049 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:26:51.077 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 75

2025-03-31 17:29:27.152 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:29:27.323 +04:00 INF starting web host
2025-03-31 17:29:27.553 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:29:28.473 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:29:28.475 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:29:28.634 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:29:28.825 +04:00 DBG Creating DbConnection.
2025-03-31 17:29:28.896 +04:00 DBG Created DbConnection. (67ms).
2025-03-31 17:29:28.898 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:28.917 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:29.735 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:29.739 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:29:29.750 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-03-31 17:29:29.752 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-03-31 17:29:29.759 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:29:29.791 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:29:29.793 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:29.805 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (8ms).
2025-03-31 17:29:29.805 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:29.806 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:29.807 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:29:29.815 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:29:29.815 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:29:29.816 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-03-31 17:29:29.817 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:29:29.848 +04:00 INF Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:29:29.939 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:29:29.948 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:29:29.949 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:29:29.950 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:29:29.951 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 17:29:29.951 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:29:29.956 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:29:29.958 +04:00 DBG Committing transaction.
2025-03-31 17:29:29.963 +04:00 DBG Committed transaction.
2025-03-31 17:29:29.966 +04:00 DBG Disposing transaction.
2025-03-31 17:29:29.968 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:29:29.969 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:29:29.970 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:29:29.970 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:29:29.970 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:29:29.970 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:29:29.971 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:29:29.972 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:29:29.972 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:29:29.972 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:29:29.972 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:29:29.973 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:29:29.975 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:29:29.975 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:29:29.975 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:29:29.976 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:29:29.980 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:29:29.983 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:29.985 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 17:29:29.991 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:29:29.992 +04:00 DBG Committing transaction.
2025-03-31 17:29:29.992 +04:00 DBG Committed transaction.
2025-03-31 17:29:29.992 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:29:29.993 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:29:29.993 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:29:29.993 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:29:29.996 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:29:29.996 +04:00 DBG Disposing transaction.
2025-03-31 17:29:29.996 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:29.997 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:29:30.069 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:29:30.389 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:29:30.437 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.437 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.437 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:29:30.437 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:29:30.438 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:29:30.438 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:29:30.443 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:29:30.448 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.449 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-03-31 17:29:30.449 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.449 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:29:30.452 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:29:30.454 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.456 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:29:30.463 +04:00 DBG Hosting starting
2025-03-31 17:29:30.496 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:29:30.521 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:29:30.537 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:29:30.574 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:29:30.583 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:29:30.584 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:29:30.587 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:29:30.590 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:29:30.593 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:29:30.596 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:29:30.597 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:29:30.632 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:29:30.651 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:29:30.730 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:29:30.753 +04:00 DBG Creating DbConnection.
2025-03-31 17:29:30.754 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:29:30.756 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.766 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.767 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:29:30.767 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:29:30.767 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:29:30.768 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:29:30.797 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:29:30.812 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.815 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 17ms reading results.
2025-03-31 17:29:30.817 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.818 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:29:30.819 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:29:30.820 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:29:30.820 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:29:30.907 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:29:30.918 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:29:30.982 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:29:31.094 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 74

2025-03-31 17:33:57.200 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:33:57.343 +04:00 INF starting web host
2025-03-31 17:33:57.548 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:33:58.448 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:33:58.449 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:33:58.531 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:33:58.692 +04:00 DBG Creating DbConnection.
2025-03-31 17:33:58.736 +04:00 DBG Created DbConnection. (41ms).
2025-03-31 17:33:58.739 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:58.751 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.077 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.081 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:33:59.089 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 17:33:59.091 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-03-31 17:33:59.097 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:33:59.122 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:33:59.124 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.132 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 17:33:59.132 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.133 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.135 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:33:59.138 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:33:59.138 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:33:59.138 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:33:59.139 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:33:59.156 +04:00 INF Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:33:59.225 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:33:59.230 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:33:59.231 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:33:59.231 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:33:59.232 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 17:33:59.233 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:33:59.234 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:33:59.239 +04:00 DBG Committing transaction.
2025-03-31 17:33:59.243 +04:00 DBG Committed transaction.
2025-03-31 17:33:59.245 +04:00 DBG Disposing transaction.
2025-03-31 17:33:59.247 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:33:59.247 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:33:59.250 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:33:59.250 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:33:59.251 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:33:59.251 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:33:59.252 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:33:59.253 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:33:59.253 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:33:59.253 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:33:59.253 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:33:59.254 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:33:59.256 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:33:59.257 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:33:59.257 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:33:59.258 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:33:59.262 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:33:59.266 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.267 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:33:59.277 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:33:59.277 +04:00 DBG Committing transaction.
2025-03-31 17:33:59.278 +04:00 DBG Committed transaction.
2025-03-31 17:33:59.278 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:33:59.279 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:33:59.279 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:33:59.279 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:33:59.281 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:33:59.281 +04:00 DBG Disposing transaction.
2025-03-31 17:33:59.282 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.282 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:33:59.358 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:33:59.701 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:33:59.746 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.747 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.747 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:33:59.747 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:33:59.747 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:33:59.747 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:33:59.751 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:33:59.757 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.757 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-03-31 17:33:59.758 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.758 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:33:59.760 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:33:59.762 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:33:59.764 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:33:59.774 +04:00 DBG Hosting starting
2025-03-31 17:33:59.796 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:33:59.814 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:33:59.823 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:33:59.832 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:33:59.838 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:33:59.839 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:33:59.841 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:33:59.843 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:33:59.845 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:33:59.847 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:33:59.848 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:33:59.890 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:33:59.924 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:34:00.019 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:34:00.044 +04:00 DBG Creating DbConnection.
2025-03-31 17:34:00.045 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:34:00.046 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:34:00.049 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:34:00.049 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:34:00.049 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:34:00.049 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:34:00.050 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:34:00.070 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:34:00.090 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:34:00.091 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 20ms reading results.
2025-03-31 17:34:00.094 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:34:00.095 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:34:00.096 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:34:00.096 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:34:00.096 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:34:00.188 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:34:00.201 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:34:00.268 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:34:00.298 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:34:00.292 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 74

2025-03-31 17:41:55.699 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:41:55.855 +04:00 INF starting web host
2025-03-31 17:41:56.197 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:41:57.291 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:41:57.293 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:41:57.813 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:41:58.064 +04:00 DBG Creating DbConnection.
2025-03-31 17:41:58.146 +04:00 DBG Created DbConnection. (80ms).
2025-03-31 17:41:58.148 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.163 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.669 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.677 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:41:58.686 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 17:41:58.690 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-03-31 17:41:58.699 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:41:58.730 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:41:58.733 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.743 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 17:41:58.743 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.745 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.747 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:41:58.752 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:41:58.752 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:41:58.753 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:41:58.754 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:41:58.780 +04:00 INF Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:41:58.905 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:41:58.916 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:41:58.918 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:41:58.918 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:41:58.920 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 17:41:58.921 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:41:58.932 +04:00 INF Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:41:58.935 +04:00 DBG Committing transaction.
2025-03-31 17:41:58.941 +04:00 DBG Committed transaction.
2025-03-31 17:41:58.943 +04:00 DBG Disposing transaction.
2025-03-31 17:41:58.948 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:41:58.948 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:41:58.950 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:41:58.951 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:41:58.951 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:41:58.951 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:41:58.952 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:41:58.952 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:41:58.953 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:41:58.953 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:41:58.953 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:41:58.954 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:41:58.957 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:41:58.958 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:41:58.958 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:41:58.959 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:41:58.964 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:41:58.967 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.969 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:41:58.983 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:41:58.983 +04:00 DBG Committing transaction.
2025-03-31 17:41:58.984 +04:00 DBG Committed transaction.
2025-03-31 17:41:58.984 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:41:58.985 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:41:58.985 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:41:58.985 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:41:58.995 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:41:58.995 +04:00 DBG Disposing transaction.
2025-03-31 17:41:58.995 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:58.996 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:41:59.068 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:41:59.449 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:41:59.487 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.488 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.488 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:41:59.488 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:41:59.489 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:41:59.489 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:41:59.495 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:41:59.499 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.499 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:41:59.499 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.499 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:41:59.501 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:41:59.503 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.505 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:41:59.511 +04:00 DBG Hosting starting
2025-03-31 17:41:59.548 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:41:59.570 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:41:59.583 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:41:59.595 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:41:59.599 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:41:59.600 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:41:59.601 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:41:59.603 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:41:59.605 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:41:59.607 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:41:59.610 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:41:59.657 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:41:59.679 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:41:59.789 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:41:59.806 +04:00 DBG Creating DbConnection.
2025-03-31 17:41:59.807 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:41:59.810 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.814 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.814 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:41:59.815 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:41:59.815 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:41:59.815 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:41:59.926 +04:00 INF Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:41:59.953 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.955 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 28ms reading results.
2025-03-31 17:41:59.958 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.960 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 17:41:59.962 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:41:59.962 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:41:59.962 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:42:00.109 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:42:00.171 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:42:00.348 +04:00 ERR BackgroundService failedSystem.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:42:00.352 +04:00 FTL The HostOptions.BackgroundServiceExceptionBehavior is configured to StopHost. A BackgroundService has thrown an unhandled exception, and the IHost instance is stopping. To avoid this behavior, configure this to Ignore; however the BackgroundService will not be restarted.System.Exception: an error occured in the Background worker
   at offers.Application.BackgroundServices.OfferArchivingService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.Application\BackgroundServices\OfferArchivingService.cs:line 39
   at Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService backgroundService)

2025-03-31 17:42:00.347 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 78

2025-03-31 17:43:20.882 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:43:25.988 +04:00 INF starting web host
2025-03-31 17:43:26.401 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:43:27.080 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:43:27.081 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:43:27.224 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:43:27.528 +04:00 DBG Creating DbConnection.
2025-03-31 17:43:27.665 +04:00 DBG Created DbConnection. (132ms).
2025-03-31 17:43:27.668 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:27.692 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:27.976 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:27.985 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:43:27.991 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 17:43:27.993 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-03-31 17:43:28.005 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:43:28.029 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:43:28.031 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.038 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 17:43:28.038 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.040 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.041 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:43:28.043 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:43:28.043 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:43:28.044 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:43:28.044 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:43:28.061 +04:00 INF Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:43:28.122 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:43:28.129 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:43:28.131 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:43:28.131 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:43:28.133 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 17:43:28.133 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:43:28.135 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:43:28.138 +04:00 DBG Committing transaction.
2025-03-31 17:43:28.141 +04:00 DBG Committed transaction.
2025-03-31 17:43:28.143 +04:00 DBG Disposing transaction.
2025-03-31 17:43:28.144 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:43:28.145 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:43:28.146 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:43:28.147 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:43:28.147 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:43:28.147 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:43:28.148 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:43:28.149 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:43:28.150 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:43:28.150 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:43:28.150 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:43:28.151 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:43:28.153 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:43:28.153 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:43:28.153 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:43:28.154 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:43:28.163 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:43:28.169 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.171 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-03-31 17:43:28.181 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:43:28.182 +04:00 DBG Committing transaction.
2025-03-31 17:43:28.182 +04:00 DBG Committed transaction.
2025-03-31 17:43:28.183 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:43:28.183 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:43:28.184 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:43:28.184 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:43:28.187 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:43:28.187 +04:00 DBG Disposing transaction.
2025-03-31 17:43:28.188 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.189 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 17:43:28.273 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:43:28.786 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:43:28.826 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.827 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.827 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:43:28.827 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:43:28.827 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:43:28.827 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:43:28.830 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:43:28.834 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.834 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:43:28.834 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.834 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:43:28.836 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:43:28.838 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:43:28.839 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:50:23.958 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:50:36.152 +04:00 INF Found perpetrator: 0
2025-03-31 17:50:39.956 +04:00 INF starting web host
2025-03-31 17:50:43.815 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:50:44.659 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:50:44.660 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:50:44.760 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:50:44.938 +04:00 DBG Creating DbConnection.
2025-03-31 17:50:45.008 +04:00 DBG Created DbConnection. (66ms).
2025-03-31 17:50:45.010 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.030 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.413 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.418 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:50:45.427 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 17:50:45.430 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-03-31 17:50:45.438 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:50:45.475 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:50:45.478 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.496 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (9ms).
2025-03-31 17:50:45.496 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.498 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.500 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:50:45.504 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:50:45.505 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:50:45.505 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:50:45.506 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:50:45.534 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:50:45.644 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:50:45.649 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:50:45.650 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:50:45.651 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:50:45.652 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 17:50:45.652 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:50:45.657 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:50:45.659 +04:00 DBG Committing transaction.
2025-03-31 17:50:45.664 +04:00 DBG Committed transaction.
2025-03-31 17:50:45.666 +04:00 DBG Disposing transaction.
2025-03-31 17:50:45.671 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:50:45.671 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:50:45.674 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:50:45.674 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:50:45.674 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:50:45.675 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:50:45.676 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:50:45.677 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:50:45.677 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:50:45.677 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:50:45.677 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:50:45.678 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:50:45.681 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:50:45.681 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:50:45.682 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:50:45.682 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:50:45.695 +04:00 INF Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:50:45.699 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.703 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 17:50:45.714 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:50:45.715 +04:00 DBG Committing transaction.
2025-03-31 17:50:45.715 +04:00 DBG Committed transaction.
2025-03-31 17:50:45.716 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:50:45.716 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:50:45.716 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:50:45.716 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:50:45.724 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:50:45.724 +04:00 DBG Disposing transaction.
2025-03-31 17:50:45.724 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:45.726 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 17:50:45.808 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:50:46.119 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:50:46.168 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:46.169 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:46.169 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:50:46.169 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:50:46.169 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:50:46.169 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:50:46.173 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:50:46.181 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:46.181 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 8ms reading results.
2025-03-31 17:50:46.181 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:46.182 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:50:46.185 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:50:46.192 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:46.195 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-03-31 17:50:49.794 +04:00 DBG Hosting starting
2025-03-31 17:50:49.831 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:50:49.855 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:50:49.867 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:50:49.883 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:50:49.886 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:50:49.887 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:50:49.889 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:50:49.891 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:50:49.892 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:50:49.894 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:50:49.895 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:50:49.916 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:50:49.929 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:50:49.984 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:50:50.002 +04:00 DBG Creating DbConnection.
2025-03-31 17:50:50.003 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:50:50.005 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:50.008 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:50.009 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:50:50.009 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:50:50.009 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:50:50.010 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:50:50.037 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:50:50.048 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:50.049 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-03-31 17:50:50.051 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:50.052 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:50:50.053 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:50:50.053 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:50:50.053 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:50:50.107 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:50:50.117 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 17:55:21.890 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 17:55:22.223 +04:00 INF Found perpetrator: 0
2025-03-31 17:55:25.717 +04:00 INF starting web host
2025-03-31 17:55:31.140 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 17:55:31.884 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:55:31.886 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 17:55:32.046 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:55:32.275 +04:00 DBG Creating DbConnection.
2025-03-31 17:55:32.318 +04:00 DBG Created DbConnection. (40ms).
2025-03-31 17:55:32.319 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.331 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.628 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.634 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:55:32.646 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 17:55:32.649 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-03-31 17:55:32.663 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:55:32.703 +04:00 INF Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:55:32.705 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.713 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 17:55:32.713 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.714 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.716 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 17:55:32.718 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:55:32.718 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:55:32.718 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:55:32.719 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:55:32.745 +04:00 INF Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 17:55:32.855 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:55:32.864 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:55:32.865 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:55:32.866 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:55:32.867 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 17:55:32.867 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:55:32.872 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 17:55:32.875 +04:00 DBG Committing transaction.
2025-03-31 17:55:32.881 +04:00 DBG Committed transaction.
2025-03-31 17:55:32.883 +04:00 DBG Disposing transaction.
2025-03-31 17:55:32.886 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 17:55:32.887 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 17:55:32.889 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 17:55:32.889 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:55:32.889 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 17:55:32.890 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:55:32.891 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 17:55:32.892 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:55:32.892 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:55:32.892 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:55:32.893 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:55:32.894 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 17:55:32.896 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:55:32.896 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:55:32.896 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:55:32.897 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:55:32.901 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 17:55:32.904 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.905 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 17:55:32.915 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 17:55:32.916 +04:00 DBG Committing transaction.
2025-03-31 17:55:32.916 +04:00 DBG Committed transaction.
2025-03-31 17:55:32.916 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 17:55:32.917 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:55:32.917 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 17:55:32.917 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:55:32.921 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 17:55:32.921 +04:00 DBG Disposing transaction.
2025-03-31 17:55:32.921 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:32.922 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:55:32.994 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 17:55:33.327 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 17:55:33.384 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:33.384 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:33.385 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:55:33.385 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:55:33.385 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:55:33.385 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:55:33.398 +04:00 INF Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 17:55:33.402 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:33.402 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 17:55:33.403 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:33.403 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:55:33.405 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:55:33.408 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:33.410 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 17:55:43.692 +04:00 DBG Hosting starting
2025-03-31 17:55:43.716 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 17:55:43.734 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 17:55:43.743 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 17:55:43.753 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 17:55:43.759 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:55:43.760 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 17:55:43.764 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 17:55:43.766 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 17:55:43.768 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 17:55:43.770 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 17:55:43.772 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 17:55:43.793 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 17:55:43.818 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 17:55:43.866 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 17:55:43.887 +04:00 DBG Creating DbConnection.
2025-03-31 17:55:43.887 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 17:55:43.890 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:43.893 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:43.894 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 17:55:43.894 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:55:43.894 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 17:55:43.896 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:55:43.921 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 17:55:43.933 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:43.934 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 12ms reading results.
2025-03-31 17:55:43.936 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:43.936 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 17:55:43.937 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 17:55:43.937 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 17:55:43.937 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 17:55:43.981 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 17:55:43.987 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 18:39:49.271 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 18:39:49.438 +04:00 INF starting web host
2025-03-31 18:39:49.676 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 18:39:50.693 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:39:50.694 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:39:50.807 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 18:39:51.004 +04:00 DBG Creating DbConnection.
2025-03-31 18:39:51.067 +04:00 DBG Created DbConnection. (61ms).
2025-03-31 18:39:51.069 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.086 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.500 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.504 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:39:51.511 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-03-31 18:39:51.513 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-03-31 18:39:51.519 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:39:51.552 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:39:51.555 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.565 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 18:39:51.565 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.566 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.568 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 18:39:51.570 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:39:51.570 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:39:51.570 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:39:51.571 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:39:51.591 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:39:51.688 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:39:51.693 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:39:51.695 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:39:51.695 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:39:51.697 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 18:39:51.698 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:39:51.700 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:39:51.702 +04:00 DBG Committing transaction.
2025-03-31 18:39:51.705 +04:00 DBG Committed transaction.
2025-03-31 18:39:51.706 +04:00 DBG Disposing transaction.
2025-03-31 18:39:51.708 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:39:51.708 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:39:51.710 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:39:51.710 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:39:51.710 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:39:51.710 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:39:51.711 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:39:51.712 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:39:51.712 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:39:51.712 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:39:51.712 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:39:51.713 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:39:51.715 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:39:51.715 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:39:51.715 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:39:51.715 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:39:51.722 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:39:51.725 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.726 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 18:39:51.734 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 18:39:51.735 +04:00 DBG Committing transaction.
2025-03-31 18:39:51.735 +04:00 DBG Committed transaction.
2025-03-31 18:39:51.736 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:39:51.736 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:39:51.736 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:39:51.736 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:39:51.739 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:39:51.739 +04:00 DBG Disposing transaction.
2025-03-31 18:39:51.739 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:51.740 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:39:51.826 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 18:39:52.235 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 18:39:52.290 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:52.291 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:52.291 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:39:52.292 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:39:52.292 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:39:52.292 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:39:52.297 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:39:52.300 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:52.300 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 18:39:52.300 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:52.301 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:39:52.302 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 18:39:52.304 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:39:52.305 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 18:39:52.309 +04:00 DBG Hosting starting
2025-03-31 18:39:52.340 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 18:39:52.361 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 18:39:52.374 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 18:39:52.390 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 18:39:52.394 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:39:52.397 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 18:39:52.399 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:39:52.401 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 18:39:52.402 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 18:39:52.404 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 18:39:52.405 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 18:39:52.481 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 18:39:52.495 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 18:39:52.571 +04:00 FTL Host terminated unexpectedlySystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Program.cs:line 68

2025-03-31 18:40:23.674 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 18:40:23.785 +04:00 INF starting web host
2025-03-31 18:40:23.950 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 18:40:24.598 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:40:24.599 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:40:24.692 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 18:40:24.917 +04:00 DBG Creating DbConnection.
2025-03-31 18:40:24.960 +04:00 DBG Created DbConnection. (40ms).
2025-03-31 18:40:24.962 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:24.978 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.250 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.253 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:40:25.259 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 18:40:25.261 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-03-31 18:40:25.267 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:25.290 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:25.292 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.300 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 18:40:25.300 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.301 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.303 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 18:40:25.305 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:40:25.305 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:25.305 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:25.306 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:40:25.320 +04:00 INF Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:40:25.382 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:40:25.387 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:40:25.388 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:40:25.389 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:40:25.390 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 18:40:25.390 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:40:25.391 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:40:25.393 +04:00 DBG Committing transaction.
2025-03-31 18:40:25.397 +04:00 DBG Committed transaction.
2025-03-31 18:40:25.399 +04:00 DBG Disposing transaction.
2025-03-31 18:40:25.402 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:40:25.403 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:40:25.405 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:40:25.405 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:40:25.405 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:40:25.406 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:25.406 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:25.407 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:40:25.407 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:25.407 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:25.408 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:40:25.409 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:40:25.412 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:40:25.412 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:25.413 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:25.414 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:40:25.417 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:40:25.421 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.423 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 18:40:25.433 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 18:40:25.433 +04:00 DBG Committing transaction.
2025-03-31 18:40:25.434 +04:00 DBG Committed transaction.
2025-03-31 18:40:25.434 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:40:25.435 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:25.435 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:25.435 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:40:25.436 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:40:25.436 +04:00 DBG Disposing transaction.
2025-03-31 18:40:25.437 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.438 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:40:25.496 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 18:40:25.714 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 18:40:25.748 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.749 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.749 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:40:25.749 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:25.749 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:25.749 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:40:25.750 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:40:25.752 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.752 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 18:40:25.752 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.752 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:40:25.754 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 18:40:25.756 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:25.757 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 18:40:28.806 +04:00 DBG Hosting starting
2025-03-31 18:40:28.836 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 18:40:28.851 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 18:40:28.858 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 18:40:28.868 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 18:40:28.872 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:40:28.873 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 18:40:28.875 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:40:28.876 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 18:40:28.878 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 18:40:28.879 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 18:40:28.880 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 18:40:28.938 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 18:40:28.947 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 18:40:46.903 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 18:40:47.010 +04:00 INF starting web host
2025-03-31 18:40:47.229 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 18:40:47.868 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:40:47.870 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:40:48.033 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 18:40:48.184 +04:00 DBG Creating DbConnection.
2025-03-31 18:40:48.224 +04:00 DBG Created DbConnection. (37ms).
2025-03-31 18:40:48.227 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.243 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.537 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.542 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:40:48.547 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 18:40:48.549 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 18:40:48.555 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:48.577 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:48.579 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.586 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 18:40:48.586 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.587 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.588 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 18:40:48.590 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:40:48.591 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:48.591 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:48.591 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:40:48.614 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:40:48.678 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:40:48.683 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:40:48.684 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:40:48.684 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:40:48.686 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 18:40:48.686 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:40:48.687 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:40:48.689 +04:00 DBG Committing transaction.
2025-03-31 18:40:48.692 +04:00 DBG Committed transaction.
2025-03-31 18:40:48.693 +04:00 DBG Disposing transaction.
2025-03-31 18:40:48.695 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:40:48.695 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:40:48.697 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:40:48.697 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:40:48.697 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:40:48.697 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:48.698 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:40:48.698 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:40:48.698 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:48.698 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:48.698 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:40:48.699 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:40:48.701 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:40:48.701 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:48.701 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:48.701 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:40:48.704 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:40:48.706 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.707 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 18:40:48.712 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 18:40:48.712 +04:00 DBG Committing transaction.
2025-03-31 18:40:48.713 +04:00 DBG Committed transaction.
2025-03-31 18:40:48.713 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:40:48.713 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:48.713 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:40:48.713 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:40:48.715 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:40:48.715 +04:00 DBG Disposing transaction.
2025-03-31 18:40:48.715 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:48.716 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:40:48.775 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 18:40:49.026 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 18:40:49.070 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:49.070 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:49.070 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:40:49.070 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:49.070 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:40:49.071 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:40:49.073 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:40:49.076 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:49.076 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 18:40:49.076 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:49.076 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:40:49.078 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 18:40:49.080 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:40:49.081 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 18:40:54.264 +04:00 DBG Hosting starting
2025-03-31 18:40:54.294 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 18:40:54.308 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 18:40:54.314 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 18:40:54.323 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 18:40:54.327 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:40:54.327 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 18:40:54.329 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:40:54.331 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 18:40:54.332 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 18:40:54.334 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 18:40:54.335 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 18:40:54.395 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 18:40:54.403 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 18:51:24.339 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 18:51:24.504 +04:00 INF starting web host
2025-03-31 18:51:24.736 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 18:51:25.589 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:51:25.590 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:51:25.672 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 18:51:25.805 +04:00 DBG Creating DbConnection.
2025-03-31 18:51:25.868 +04:00 DBG Created DbConnection. (60ms).
2025-03-31 18:51:25.870 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:25.893 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:26.288 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:26.297 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:51:26.314 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (9ms).
2025-03-31 18:51:26.317 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (22ms).
2025-03-31 18:51:26.325 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:26.361 +04:00 INF Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:26.365 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:26.376 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (6ms).
2025-03-31 18:51:26.376 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:26.378 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:26.380 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 18:51:26.384 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:51:26.384 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:26.384 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:26.385 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:51:26.418 +04:00 INF Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:51:26.544 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:51:26.553 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:51:26.555 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:51:26.555 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:51:26.557 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 18:51:26.558 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:51:26.567 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:51:26.569 +04:00 DBG Committing transaction.
2025-03-31 18:51:26.573 +04:00 DBG Committed transaction.
2025-03-31 18:51:26.576 +04:00 DBG Disposing transaction.
2025-03-31 18:51:26.578 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:51:26.579 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:51:26.582 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:51:26.582 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:51:26.582 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:51:26.582 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:26.583 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:26.584 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:51:26.584 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:26.584 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:26.584 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:51:26.585 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:51:26.589 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:51:26.589 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:26.589 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:26.590 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:51:26.600 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:51:26.603 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:26.606 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 18:51:26.616 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 18:51:26.616 +04:00 DBG Committing transaction.
2025-03-31 18:51:26.617 +04:00 DBG Committed transaction.
2025-03-31 18:51:26.617 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:51:26.618 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:26.618 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:26.618 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:51:26.640 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:51:26.640 +04:00 DBG Disposing transaction.
2025-03-31 18:51:26.640 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:26.641 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:51:26.728 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 18:51:27.018 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 18:51:27.065 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:27.066 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:27.066 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:51:27.066 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:27.067 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:27.067 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:51:27.077 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:51:27.082 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:27.082 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 18:51:27.082 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:27.082 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:51:27.084 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 18:51:27.087 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:27.088 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 18:51:28.728 +04:00 DBG Hosting starting
2025-03-31 18:51:28.761 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 18:51:28.803 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 18:51:28.831 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 18:51:28.847 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 18:51:28.852 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:51:28.854 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 18:51:28.856 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:51:28.858 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 18:51:28.860 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 18:51:28.863 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 18:51:28.864 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 18:51:28.989 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 18:51:29.005 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 18:51:46.440 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 18:51:46.557 +04:00 INF starting web host
2025-03-31 18:51:46.710 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 18:51:47.580 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:51:47.582 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:51:47.661 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 18:51:47.819 +04:00 DBG Creating DbConnection.
2025-03-31 18:51:47.874 +04:00 DBG Created DbConnection. (48ms).
2025-03-31 18:51:47.878 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:47.892 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.170 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.175 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:51:48.185 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 18:51:48.187 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-03-31 18:51:48.196 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:48.227 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:48.229 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.237 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 18:51:48.237 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.238 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.239 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 18:51:48.241 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:51:48.241 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:48.242 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:48.242 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:51:48.263 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:51:48.321 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:51:48.326 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:51:48.328 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:51:48.329 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:51:48.330 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 18:51:48.330 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:51:48.339 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:51:48.341 +04:00 DBG Committing transaction.
2025-03-31 18:51:48.346 +04:00 DBG Committed transaction.
2025-03-31 18:51:48.349 +04:00 DBG Disposing transaction.
2025-03-31 18:51:48.351 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:51:48.351 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:51:48.353 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:51:48.353 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:51:48.354 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:51:48.354 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:48.355 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:51:48.355 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:51:48.355 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:48.356 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:48.356 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:51:48.357 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:51:48.359 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:51:48.359 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:48.359 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:48.360 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:51:48.367 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:51:48.371 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.373 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 18:51:48.383 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 18:51:48.383 +04:00 DBG Committing transaction.
2025-03-31 18:51:48.384 +04:00 DBG Committed transaction.
2025-03-31 18:51:48.384 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:51:48.384 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:48.384 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:51:48.384 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:51:48.389 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:51:48.389 +04:00 DBG Disposing transaction.
2025-03-31 18:51:48.389 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.390 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:51:48.450 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 18:51:48.723 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 18:51:48.786 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.787 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.787 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:51:48.787 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:48.787 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:51:48.787 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:51:48.795 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:51:48.799 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.799 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 18:51:48.799 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.799 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:51:48.803 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 18:51:48.806 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:51:48.808 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 18:52:21.523 +04:00 DBG Hosting starting
2025-03-31 18:52:21.555 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 18:52:21.580 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 18:52:21.595 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 18:52:21.606 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 18:52:21.612 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:52:21.613 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 18:52:21.616 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:52:21.618 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 18:52:21.620 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 18:52:21.624 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 18:52:21.626 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 18:52:21.692 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 18:52:21.702 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 18:55:48.202 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 18:55:48.434 +04:00 INF starting web host
2025-03-31 18:55:48.647 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 18:55:49.556 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:55:49.558 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 18:55:49.698 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 18:55:49.894 +04:00 DBG Creating DbConnection.
2025-03-31 18:55:49.951 +04:00 DBG Created DbConnection. (56ms).
2025-03-31 18:55:49.953 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:49.970 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:50.397 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:50.401 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:55:50.408 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-03-31 18:55:50.410 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (9ms).
2025-03-31 18:55:50.417 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:55:50.443 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:55:50.446 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:50.463 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (10ms).
2025-03-31 18:55:50.463 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:50.464 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:50.466 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 18:55:50.468 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:55:50.468 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:55:50.468 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:55:50.469 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:55:50.489 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 18:55:50.603 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:55:50.610 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:55:50.612 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:55:50.612 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:55:50.614 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 18:55:50.614 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:55:50.617 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 18:55:50.620 +04:00 DBG Committing transaction.
2025-03-31 18:55:50.625 +04:00 DBG Committed transaction.
2025-03-31 18:55:50.627 +04:00 DBG Disposing transaction.
2025-03-31 18:55:50.631 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 18:55:50.631 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 18:55:50.634 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 18:55:50.634 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:55:50.634 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 18:55:50.635 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:55:50.636 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 18:55:50.636 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:55:50.637 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:55:50.637 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:55:50.637 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:55:50.638 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 18:55:50.641 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:55:50.641 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:55:50.641 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:55:50.642 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:55:50.646 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 18:55:50.650 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:50.652 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 18:55:50.662 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 18:55:50.662 +04:00 DBG Committing transaction.
2025-03-31 18:55:50.664 +04:00 DBG Committed transaction.
2025-03-31 18:55:50.664 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 18:55:50.665 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:55:50.665 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 18:55:50.665 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:55:50.671 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 18:55:50.671 +04:00 DBG Disposing transaction.
2025-03-31 18:55:50.672 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:50.673 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:55:50.750 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 18:55:51.031 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 18:55:51.099 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:51.101 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:51.101 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 18:55:51.101 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:55:51.102 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 18:55:51.102 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:55:51.110 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 18:55:51.116 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:51.117 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-03-31 18:55:51.117 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:51.117 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 18:55:51.119 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 18:55:51.124 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 18:55:51.125 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 18:55:54.866 +04:00 DBG Hosting starting
2025-03-31 18:55:54.904 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 18:55:54.925 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 18:55:54.940 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 18:55:54.957 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 18:55:54.961 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:55:54.962 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 18:55:54.963 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 18:55:54.965 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 18:55:54.966 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 18:55:54.968 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 18:55:54.969 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 18:55:58.316 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 18:55:58.337 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 19:01:50.526 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 19:01:50.664 +04:00 INF starting web host
2025-03-31 19:01:50.950 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 19:01:51.780 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:01:51.781 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:01:51.862 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:01:52.019 +04:00 DBG Creating DbConnection.
2025-03-31 19:01:52.081 +04:00 DBG Created DbConnection. (60ms).
2025-03-31 19:01:52.082 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.098 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.533 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.541 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:01:52.549 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 19:01:52.552 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (12ms).
2025-03-31 19:01:52.562 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:01:52.590 +04:00 INF Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:01:52.592 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.600 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 19:01:52.600 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.601 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.603 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 19:01:52.605 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:01:52.605 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:01:52.606 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:01:52.606 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:01:52.641 +04:00 INF Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:01:52.763 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:01:52.771 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:01:52.775 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:01:52.775 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:01:52.777 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-03-31 19:01:52.778 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:01:52.783 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:01:52.785 +04:00 DBG Committing transaction.
2025-03-31 19:01:52.790 +04:00 DBG Committed transaction.
2025-03-31 19:01:52.792 +04:00 DBG Disposing transaction.
2025-03-31 19:01:52.796 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:01:52.796 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:01:52.799 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:01:52.799 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:01:52.799 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:01:52.799 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:01:52.800 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:01:52.801 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:01:52.801 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:01:52.801 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:01:52.801 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:01:52.802 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:01:52.805 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:01:52.805 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:01:52.806 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:01:52.806 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:01:52.815 +04:00 INF Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:01:52.818 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.819 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 19:01:52.826 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 19:01:52.826 +04:00 DBG Committing transaction.
2025-03-31 19:01:52.827 +04:00 DBG Committed transaction.
2025-03-31 19:01:52.827 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:01:52.827 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:01:52.827 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:01:52.827 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:01:52.830 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:01:52.831 +04:00 DBG Disposing transaction.
2025-03-31 19:01:52.831 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:52.831 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:01:52.913 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 19:01:53.224 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 19:01:53.315 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:53.316 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:53.316 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:01:53.316 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:01:53.316 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:01:53.316 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:01:53.334 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:01:53.339 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:53.339 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 19:01:53.339 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:53.339 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:01:53.342 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:01:53.345 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:01:53.347 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 19:01:57.131 +04:00 DBG Hosting starting
2025-03-31 19:01:57.171 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 19:01:57.204 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 19:01:57.220 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 19:01:57.237 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 19:01:57.243 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:01:57.244 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 19:01:57.246 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:01:57.247 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 19:01:57.249 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 19:01:57.251 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 19:01:57.252 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 19:01:57.356 +04:00 FTL Application startup exceptionSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-31 19:01:57.374 +04:00 ERR Hosting failed to startSystem.InvalidOperationException: An error occurred when configuring the exception handler middleware. Either the 'ExceptionHandlingPath' or the 'ExceptionHandler' property must be set in 'UseExceptionHandler()'. Alternatively, set one of the aforementioned properties in 'Startup.ConfigureServices' as follows: 'services.AddExceptionHandler(options => { ... });' or configure to generate a 'ProblemDetails' response in 'service.AddProblemDetails()'.
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener, IEnumerable`1 exceptionHandlers, IMeterFactory meterFactory, IProblemDetailsService problemDetailsService)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware..ctor(RequestDelegate next, ILoggerFactory loggerFactory, IOptions`1 options, DiagnosticListener diagnosticListener)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-31 19:11:20.864 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 19:11:21.020 +04:00 INF starting web host
2025-03-31 19:11:21.252 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 19:11:22.052 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:11:22.054 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:11:22.161 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:11:22.318 +04:00 DBG Creating DbConnection.
2025-03-31 19:11:22.380 +04:00 DBG Created DbConnection. (60ms).
2025-03-31 19:11:22.382 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:22.398 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:22.879 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:22.887 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:11:22.894 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (5ms).
2025-03-31 19:11:22.897 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-03-31 19:11:22.904 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:11:22.952 +04:00 INF Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:11:22.957 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:22.978 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (8ms).
2025-03-31 19:11:22.979 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:22.983 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:22.986 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 19:11:22.990 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:11:22.991 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:11:22.991 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:11:22.993 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:11:23.043 +04:00 INF Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:11:23.173 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:11:23.180 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:11:23.182 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:11:23.182 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:11:23.184 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 19:11:23.184 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:11:23.189 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:11:23.191 +04:00 DBG Committing transaction.
2025-03-31 19:11:23.194 +04:00 DBG Committed transaction.
2025-03-31 19:11:23.195 +04:00 DBG Disposing transaction.
2025-03-31 19:11:23.197 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:11:23.197 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:11:23.198 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:11:23.199 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:11:23.199 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:11:23.200 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:11:23.201 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:11:23.201 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:11:23.201 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:11:23.201 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:11:23.201 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:11:23.202 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:11:23.204 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:11:23.204 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:11:23.204 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:11:23.205 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:11:23.209 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:11:23.212 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.213 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 19:11:23.222 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 19:11:23.223 +04:00 DBG Committing transaction.
2025-03-31 19:11:23.223 +04:00 DBG Committed transaction.
2025-03-31 19:11:23.224 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:11:23.224 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:11:23.224 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:11:23.225 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:11:23.229 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:11:23.229 +04:00 DBG Disposing transaction.
2025-03-31 19:11:23.230 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.231 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 19:11:23.326 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 19:11:23.626 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 19:11:23.693 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.693 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.693 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:11:23.693 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:11:23.694 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:11:23.694 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:11:23.708 +04:00 INF Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:11:23.711 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.711 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 19:11:23.712 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.712 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:11:23.714 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:11:23.717 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.718 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 19:11:23.724 +04:00 DBG Hosting starting
2025-03-31 19:11:23.752 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 19:11:23.769 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 19:11:23.787 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 19:11:23.804 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 19:11:23.812 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:11:23.813 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 19:11:23.819 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:11:23.822 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 19:11:23.825 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 19:11:23.829 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 19:11:23.831 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 19:11:23.864 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:11:23.899 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 19:11:23.975 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 19:11:23.993 +04:00 DBG Creating DbConnection.
2025-03-31 19:11:23.993 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:11:23.995 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.998 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:23.998 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:11:23.998 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:11:23.998 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:11:23.999 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:11:24.036 +04:00 INF Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:11:24.065 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:24.069 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 32ms reading results.
2025-03-31 19:11:24.072 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:24.073 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 19:11:24.075 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:11:24.076 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:11:24.076 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:11:24.298 +04:00 DBG Loaded hosting startup assembly offers.API
2025-03-31 19:11:24.298 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-03-31 19:11:24.298 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-03-31 19:11:24.298 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-03-31 19:11:24.500 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger - null null
2025-03-31 19:11:24.720 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-03-31 19:11:24.720 +04:00 INF Hosting environment: Development
2025-03-31 19:11:24.720 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-03-31 19:11:24.720 +04:00 DBG Hosting started
2025-03-31 19:11:25.373 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-03-31 19:11:25.469 +04:00 DBG No candidates found for the request path '/swagger'
2025-03-31 19:11:25.469 +04:00 DBG Request did not match any endpoints
2025-03-31 19:11:25.535 +04:00 DBG Connection ID "17870283331606675457" disconnecting.
2025-03-31 19:11:25.536 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-03-31 19:11:25.542 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-03-31 19:11:25.542 +04:00 DBG Request did not match any endpoints
2025-03-31 19:11:25.558 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger - 301 null null 1084.1323ms
2025-03-31 19:11:25.686 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-03-31 19:11:25.689 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-03-31 19:11:25.727 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-03-31 19:11:25.727 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-03-31 19:11:25.728 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 192.98ms
2025-03-31 19:11:25.729 +04:00 DBG Connection ID "18302628891539275806" disconnecting.
2025-03-31 19:11:25.876 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/swagger-ui.css - null null
2025-03-31 19:11:25.877 +04:00 DBG No candidates found for the request path '/swagger/swagger-ui.css'
2025-03-31 19:11:25.877 +04:00 DBG Request did not match any endpoints
2025-03-31 19:11:25.894 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/swagger-ui-bundle.js - null null
2025-03-31 19:11:25.894 +04:00 DBG No candidates found for the request path '/swagger/swagger-ui-bundle.js'
2025-03-31 19:11:25.894 +04:00 DBG Request did not match any endpoints
2025-03-31 19:11:25.900 +04:00 INF Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-03-31 19:11:25.903 +04:00 DBG Connection ID "18374686494167138363" disconnecting.
2025-03-31 19:11:25.907 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/swagger-ui.css - 200 152034 text/css 31.0352ms
2025-03-31 19:11:25.917 +04:00 INF Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-03-31 19:11:25.955 +04:00 DBG Connection ID "18302628887244308528" disconnecting.
2025-03-31 19:11:25.958 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 64.418ms
2025-03-31 19:11:25.971 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/swagger-ui-standalone-preset.js - null null
2025-03-31 19:11:25.972 +04:00 DBG No candidates found for the request path '/swagger/swagger-ui-standalone-preset.js'
2025-03-31 19:11:25.972 +04:00 DBG Request did not match any endpoints
2025-03-31 19:11:25.977 +04:00 INF Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-03-31 19:11:25.981 +04:00 DBG Connection ID "18374686494167138365" disconnecting.
2025-03-31 19:11:25.981 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 10.1286ms
2025-03-31 19:11:26.054 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-03-31 19:11:26.058 +04:00 DBG Connection ID "18302628891539275808" disconnecting.
2025-03-31 19:11:26.059 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 3.7214ms
2025-03-31 19:11:26.063 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-03-31 19:11:26.274 +04:00 DBG Connection ID "18374686494167138367" disconnecting.
2025-03-31 19:11:26.275 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 212.2692ms
2025-03-31 19:11:27.680 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-03-31 19:11:27.681 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-03-31 19:11:27.681 +04:00 DBG Request did not match any endpoints
2025-03-31 19:11:27.719 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/favicon-32x32.png - null null
2025-03-31 19:11:27.720 +04:00 DBG No candidates found for the request path '/swagger/favicon-32x32.png'
2025-03-31 19:11:27.721 +04:00 DBG Request did not match any endpoints
2025-03-31 19:11:27.726 +04:00 DBG Connection ID "18230571297501347859" disconnecting.
2025-03-31 19:11:27.726 +04:00 INF Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-03-31 19:11:27.727 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/favicon-32x32.png - 200 628 image/png 8.4101ms
2025-03-31 19:11:27.750 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 68.7914ms
2025-03-31 19:16:06.031 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/user/register - application/json 139
2025-03-31 19:16:06.053 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/user/register'
2025-03-31 19:16:06.060 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.Register (offers.API)' with route pattern 'api/Auth/user/register' is valid for the request path '/api/Auth/user/register'
2025-03-31 19:16:06.061 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-03-31 19:16:06.063 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:16:06.369 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:16:06.370 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-03-31 19:16:06.410 +04:00 INF Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(offers.API.Models.UserRegisterDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-03-31 19:16:06.412 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-03-31 19:16:06.412 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-03-31 19:16:06.413 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-03-31 19:16:06.413 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-03-31 19:16:06.414 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-03-31 19:16:06.416 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:16:06.483 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:16:06.485 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:16:06.497 +04:00 DBG Attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO' ...
2025-03-31 19:16:06.500 +04:00 DBG Attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO' using the name '' in request data ...
2025-03-31 19:16:06.507 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-03-31 19:16:06.535 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.UserRegisterDTO'
2025-03-31 19:16:06.535 +04:00 DBG Done attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO'.
2025-03-31 19:16:06.536 +04:00 DBG Done attempting to bind parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO'.
2025-03-31 19:16:06.536 +04:00 DBG Attempting to validate the bound parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO' ...
2025-03-31 19:16:06.549 +04:00 DBG Done attempting to validate the bound parameter 'userDTO' of type 'offers.API.Models.UserRegisterDTO'.
2025-03-31 19:16:06.550 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:16:06.551 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:16:06.551 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:16:06.552 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:16:06.561 +04:00 INF Register attempt for kirvalidzedachi@gmail.com
2025-03-31 19:16:06.699 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(acc => acc.Email == __Email_0)'
2025-03-31 19:16:06.706 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Accounts AS a
                WHERE a.Email == @__Email_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Accounts AS a
                WHERE a.Email == @__Email_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-03-31 19:16:06.719 +04:00 DBG Creating DbConnection.
2025-03-31 19:16:06.719 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:16:06.719 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:06.720 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:06.720 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:16:06.720 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:16:06.726 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (6ms).
2025-03-31 19:16:06.729 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:16:06.808 +04:00 INF Executed DbCommand (81ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Email] = @__Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:16:06.811 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:06.811 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 19:16:06.811 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:06.811 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:16:06.851 +04:00 DBG 'ApplicationDbContext' generated a temporary value for the property 'Account.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:16:06.914 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:16:06.937 +04:00 DBG The navigation 'UserDetail.Account' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:16:06.946 +04:00 DBG Context 'ApplicationDbContext' started tracking 'UserDetail' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:16:06.950 +04:00 DBG SaveChanges starting for 'ApplicationDbContext'.
2025-03-31 19:16:06.952 +04:00 DBG DetectChanges starting for 'ApplicationDbContext'.
2025-03-31 19:16:06.970 +04:00 DBG DetectChanges completed for 'ApplicationDbContext'.
2025-03-31 19:16:07.062 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:07.062 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:07.063 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:16:07.064 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:16:07.067 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:16:07.067 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:16:07.067 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:16:07.067 +04:00 DBG Executing DbCommand [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-31 19:16:07.094 +04:00 INF Executed DbCommand (27ms) [Parameters=[@p0='?' (Size = 255) (DbType = AnsiString), @p1='?' (Size = 512) (DbType = AnsiString), @p2='?' (Size = 50) (DbType = AnsiString), @p3='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Accounts] ([Email], [PasswordHash], [Phone], [Role])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-31 19:16:07.108 +04:00 DBG The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-03-31 19:16:07.113 +04:00 DBG The foreign key property 'UserDetail.AccountId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-03-31 19:16:07.117 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:07.118 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 23ms reading results.
2025-03-31 19:16:07.119 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:16:07.120 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:16:07.121 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-03-31 19:16:07.124 +04:00 DBG Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (Size = 100) (DbType = AnsiString), @p7='?' (Size = 100) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserDetails] ([AccountId], [Balance], [FirstName], [LastName])
VALUES (@p4, @p5, @p6, @p7);
2025-03-31 19:16:07.143 +04:00 INF Executed DbCommand (21ms) [Parameters=[@p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (Size = 100) (DbType = AnsiString), @p7='?' (Size = 100) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserDetails] ([AccountId], [Balance], [FirstName], [LastName])
VALUES (@p4, @p5, @p6, @p7);
2025-03-31 19:16:07.143 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:07.143 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-03-31 19:16:07.145 +04:00 DBG Committing transaction.
2025-03-31 19:16:07.146 +04:00 DBG Committed transaction.
2025-03-31 19:16:07.148 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:07.148 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:16:07.149 +04:00 DBG Disposing transaction.
2025-03-31 19:16:07.160 +04:00 DBG An entity of type 'Account' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:16:07.161 +04:00 DBG An entity of type 'UserDetail' tracked by 'ApplicationDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:16:07.163 +04:00 DBG SaveChanges completed for 'ApplicationDbContext' with 2 entities written to the database.
2025-03-31 19:16:07.170 +04:00 DBG List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-03-31 19:16:07.173 +04:00 DBG No information found on request to perform content negotiation.
2025-03-31 19:16:07.173 +04:00 DBG Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-03-31 19:16:07.174 +04:00 DBG Attempting to select the first formatter in the output formatters list which can write the result.
2025-03-31 19:16:07.175 +04:00 DBG Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-03-31 19:16:07.175 +04:00 INF Executing CreatedAtActionResult, writing value of type 'offers.Application.Models.AccountResponseModel'.
2025-03-31 19:16:07.196 +04:00 DBG Found the endpoints ["offers.API.Controllers.UserController.GetCurrentUser (offers.API)"] for address (action=[GetCurrentUser],controller=[User])
2025-03-31 19:16:07.202 +04:00 DBG Successfully processed template api/User for offers.API.Controllers.UserController.GetCurrentUser (offers.API) resulting in /api/User and 
2025-03-31 19:16:07.204 +04:00 DBG Link generation succeeded for endpoints ["offers.API.Controllers.UserController.GetCurrentUser (offers.API)"] with result /api/User
2025-03-31 19:16:07.226 +04:00 INF Executed action offers.API.Controllers.AuthController.Register (offers.API) in 809.1647ms
2025-03-31 19:16:07.227 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.Register (offers.API)'
2025-03-31 19:16:07.229 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:16:07.229 +04:00 DBG Connection ID "18014398519682531339" disconnecting.
2025-03-31 19:16:07.229 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:07.230 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:16:07.232 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/user/register - 201 null application/json; charset=utf-8 1200.3507ms
2025-03-31 19:16:19.106 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/users - null null
2025-03-31 19:16:19.110 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/users'
2025-03-31 19:16:19.110 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllUsers (offers.API)' with route pattern 'api/Admin/users' is valid for the request path '/api/Admin/users'
2025-03-31 19:16:19.110 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllUsers (offers.API)'
2025-03-31 19:16:19.111 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:16:19.117 +04:00 DBG Policy authentication schemes  did not succeed
2025-03-31 19:16:19.128 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-31 19:16:19.132 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-03-31 19:16:19.134 +04:00 DBG Connection ID "18302628887244308533" disconnecting.
2025-03-31 19:16:19.134 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/users - 401 null null 27.7448ms
2025-03-31 19:16:24.071 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:16:24.081 +04:00 DBG Creating DbConnection.
2025-03-31 19:16:24.082 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:16:24.082 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:24.082 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:24.082 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:16:24.082 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:16:24.082 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:16:24.083 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:16:24.093 +04:00 INF Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:16:24.093 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:24.093 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-03-31 19:16:24.094 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:24.094 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:16:24.094 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:16:24.094 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:16:24.094 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:16:40.041 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/companies - null null
2025-03-31 19:16:40.042 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/companies'
2025-03-31 19:16:40.042 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)' with route pattern 'api/Admin/companies' is valid for the request path '/api/Admin/companies'
2025-03-31 19:16:40.043 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)'
2025-03-31 19:16:40.043 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:16:40.046 +04:00 DBG Policy authentication schemes  did not succeed
2025-03-31 19:16:40.048 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-31 19:16:40.051 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-03-31 19:16:40.055 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/companies - 401 null null 14.1507ms
2025-03-31 19:17:03.137 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/companies - null null
2025-03-31 19:17:03.203 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/companies'
2025-03-31 19:17:03.203 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)' with route pattern 'api/Admin/companies' is valid for the request path '/api/Admin/companies'
2025-03-31 19:17:03.204 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)'
2025-03-31 19:17:03.205 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:17:03.209 +04:00 DBG Policy authentication schemes  did not succeed
2025-03-31 19:17:03.210 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-31 19:17:03.211 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-03-31 19:17:03.213 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/companies - 401 null null 75.4013ms
2025-03-31 19:17:05.238 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/companies - null null
2025-03-31 19:17:05.243 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/companies'
2025-03-31 19:17:05.243 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)' with route pattern 'api/Admin/companies' is valid for the request path '/api/Admin/companies'
2025-03-31 19:17:05.243 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)'
2025-03-31 19:17:05.244 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:17:05.244 +04:00 DBG Policy authentication schemes  did not succeed
2025-03-31 19:17:05.244 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-31 19:17:05.244 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-03-31 19:17:05.245 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/companies - 401 null null 8.0246ms
2025-03-31 19:18:59.045 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/companies - null null
2025-03-31 19:18:59.045 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/companies'
2025-03-31 19:18:59.046 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)' with route pattern 'api/Admin/companies' is valid for the request path '/api/Admin/companies'
2025-03-31 19:18:59.046 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllCompanies (offers.API)'
2025-03-31 19:18:59.047 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:18:59.048 +04:00 DBG Policy authentication schemes  did not succeed
2025-03-31 19:18:59.048 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-31 19:18:59.049 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-03-31 19:18:59.051 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/companies - 401 null null 6.0084ms
2025-03-31 19:19:06.523 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-03-31 19:19:06.550 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-03-31 19:19:06.550 +04:00 DBG Request did not match any endpoints
2025-03-31 19:19:06.554 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-03-31 19:19:06.554 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-03-31 19:19:06.560 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-03-31 19:19:06.560 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-03-31 19:19:06.560 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 37.4537ms
2025-03-31 19:19:06.616 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-03-31 19:19:06.616 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-03-31 19:19:06.619 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 3.1542ms
2025-03-31 19:19:06.623 +04:00 DBG Connection ID "17870283331606675461" disconnecting.
2025-03-31 19:19:06.648 +04:00 DBG Connection ID "17798225737568747525" disconnecting.
2025-03-31 19:19:06.651 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 34.8775ms
2025-03-31 19:19:06.967 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-03-31 19:19:06.968 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-03-31 19:19:06.968 +04:00 DBG Request did not match any endpoints
2025-03-31 19:19:07.004 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 36.812ms
2025-03-31 19:19:15.836 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/users - null null
2025-03-31 19:19:15.836 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/users'
2025-03-31 19:19:15.837 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllUsers (offers.API)' with route pattern 'api/Admin/users' is valid for the request path '/api/Admin/users'
2025-03-31 19:19:15.837 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllUsers (offers.API)'
2025-03-31 19:19:15.838 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:19:15.838 +04:00 DBG Policy authentication schemes  did not succeed
2025-03-31 19:19:15.838 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-31 19:19:15.838 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-03-31 19:19:15.839 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/users - 401 null null 3.0344ms
2025-03-31 19:19:32.052 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/users - null null
2025-03-31 19:19:32.065 +04:00 DBG 1 candidate(s) found for the request path '/api/Admin/users'
2025-03-31 19:19:32.065 +04:00 DBG Endpoint 'offers.API.Controllers.AdminController.GetAllUsers (offers.API)' with route pattern 'api/Admin/users' is valid for the request path '/api/Admin/users'
2025-03-31 19:19:32.066 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AdminController.GetAllUsers (offers.API)'
2025-03-31 19:19:32.066 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:19:32.066 +04:00 DBG Policy authentication schemes  did not succeed
2025-03-31 19:19:32.067 +04:00 INF Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-31 19:19:32.067 +04:00 INF AuthenticationScheme: Bearer was challenged.
2025-03-31 19:19:32.075 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/users - 401 null null 22.9408ms
2025-03-31 19:19:37.331 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/api/Admin/user - null null
2025-03-31 19:19:37.350 +04:00 DBG No candidates found for the request path '/api/Admin/user'
2025-03-31 19:19:37.350 +04:00 DBG Request did not match any endpoints
2025-03-31 19:19:37.350 +04:00 DBG The request path  does not match the path filter
2025-03-31 19:19:37.351 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:19:37.355 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/api/Admin/user - 404 null null 22.8632ms
2025-03-31 19:19:37.357 +04:00 INF Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:44346/api/Admin/user, Response status code: 404
2025-03-31 19:20:45.799 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 19:20:46.086 +04:00 INF starting web host
2025-03-31 19:20:46.430 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 19:20:47.663 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:20:47.666 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:20:47.887 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:20:48.102 +04:00 DBG Creating DbConnection.
2025-03-31 19:20:48.166 +04:00 DBG Created DbConnection. (58ms).
2025-03-31 19:20:48.169 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.183 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.607 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.615 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:20:48.626 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 19:20:48.629 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-03-31 19:20:48.638 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:20:48.675 +04:00 INF Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:20:48.680 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.697 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (10ms).
2025-03-31 19:20:48.697 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.698 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.700 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 19:20:48.703 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:20:48.703 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:20:48.704 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:20:48.704 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:20:48.728 +04:00 INF Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:20:48.817 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:20:48.824 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:20:48.825 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:20:48.825 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:20:48.827 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 19:20:48.827 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:20:48.832 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:20:48.835 +04:00 DBG Committing transaction.
2025-03-31 19:20:48.838 +04:00 DBG Committed transaction.
2025-03-31 19:20:48.840 +04:00 DBG Disposing transaction.
2025-03-31 19:20:48.842 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:20:48.843 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:20:48.845 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:20:48.845 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:20:48.845 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:20:48.845 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:20:48.846 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:20:48.847 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:20:48.847 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:20:48.847 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:20:48.847 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:20:48.849 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:20:48.852 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:20:48.852 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:20:48.852 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:20:48.853 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:20:48.857 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:20:48.861 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.863 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 19:20:48.870 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 19:20:48.870 +04:00 DBG Committing transaction.
2025-03-31 19:20:48.871 +04:00 DBG Committed transaction.
2025-03-31 19:20:48.871 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:20:48.871 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:20:48.871 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:20:48.871 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:20:48.874 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:20:48.875 +04:00 DBG Disposing transaction.
2025-03-31 19:20:48.875 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:48.875 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:20:49.039 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 19:20:49.477 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 19:20:49.513 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.513 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.514 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:20:49.514 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:20:49.514 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:20:49.514 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:20:49.517 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:20:49.520 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.520 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 19:20:49.520 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.520 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:20:49.522 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:20:49.524 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.525 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:20:49.531 +04:00 DBG Hosting starting
2025-03-31 19:20:49.551 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 19:20:49.567 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 19:20:49.574 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 19:20:49.587 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 19:20:49.590 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:20:49.591 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 19:20:49.593 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:20:49.594 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 19:20:49.596 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 19:20:49.597 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 19:20:49.598 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 19:20:49.620 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:20:49.633 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 19:20:49.697 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 19:20:49.713 +04:00 DBG Creating DbConnection.
2025-03-31 19:20:49.714 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:20:49.715 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.718 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.718 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:20:49.718 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:20:49.718 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:20:49.719 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:20:49.734 +04:00 INF Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:20:49.745 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.747 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-03-31 19:20:49.749 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.750 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:20:49.751 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:20:49.751 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:20:49.751 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:20:49.837 +04:00 DBG Loaded hosting startup assembly offers.API
2025-03-31 19:20:49.837 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-03-31 19:20:49.837 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-03-31 19:20:49.837 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-03-31 19:20:49.891 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-03-31 19:20:50.019 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-03-31 19:20:50.038 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-03-31 19:20:50.039 +04:00 INF Hosting environment: Development
2025-03-31 19:20:50.039 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-03-31 19:20:50.039 +04:00 DBG Hosting started
2025-03-31 19:20:50.052 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-03-31 19:20:50.053 +04:00 DBG Request did not match any endpoints
2025-03-31 19:20:50.163 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-03-31 19:20:50.166 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-03-31 19:20:50.239 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-03-31 19:20:50.240 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-03-31 19:20:50.256 +04:00 DBG Connection ID "18230571297501347863" disconnecting.
2025-03-31 19:20:50.259 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 380.8361ms
2025-03-31 19:20:50.379 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-03-31 19:20:50.442 +04:00 DBG Connection ID "18374686494167138373" disconnecting.
2025-03-31 19:20:50.443 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 63.9341ms
2025-03-31 19:20:50.477 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-03-31 19:20:50.586 +04:00 DBG Connection ID "18374686494167138375" disconnecting.
2025-03-31 19:20:50.589 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 111.9665ms
2025-03-31 19:20:51.055 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-03-31 19:20:51.056 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-03-31 19:20:51.057 +04:00 DBG Request did not match any endpoints
2025-03-31 19:20:51.081 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.8299ms
2025-03-31 19:26:09.486 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 19:26:09.626 +04:00 INF starting web host
2025-03-31 19:26:09.873 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 19:26:10.740 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:26:10.741 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:26:10.817 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:26:10.976 +04:00 DBG Creating DbConnection.
2025-03-31 19:26:11.023 +04:00 DBG Created DbConnection. (44ms).
2025-03-31 19:26:11.024 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.039 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.371 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.375 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:26:11.381 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 19:26:11.386 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-03-31 19:26:11.391 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:26:11.417 +04:00 INF Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:26:11.419 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.426 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 19:26:11.426 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.427 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.429 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 19:26:11.432 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:26:11.432 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:26:11.433 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:26:11.435 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:26:11.452 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:26:11.540 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:26:11.545 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:26:11.546 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:26:11.546 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:26:11.548 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 19:26:11.548 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:26:11.550 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:26:11.552 +04:00 DBG Committing transaction.
2025-03-31 19:26:11.555 +04:00 DBG Committed transaction.
2025-03-31 19:26:11.557 +04:00 DBG Disposing transaction.
2025-03-31 19:26:11.559 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:26:11.560 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:26:11.561 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:26:11.561 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:26:11.561 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:26:11.561 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:26:11.562 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:26:11.563 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:26:11.563 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:26:11.563 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:26:11.563 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:26:11.564 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:26:11.565 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:26:11.566 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:26:11.566 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:26:11.566 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:26:11.569 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:26:11.571 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.573 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 19:26:11.577 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 19:26:11.578 +04:00 DBG Committing transaction.
2025-03-31 19:26:11.578 +04:00 DBG Committed transaction.
2025-03-31 19:26:11.579 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:26:11.579 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:26:11.579 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:26:11.579 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:26:11.581 +04:00 INF Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:26:11.581 +04:00 DBG Disposing transaction.
2025-03-31 19:26:11.581 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.582 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:26:11.652 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 19:26:11.894 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 19:26:11.946 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.946 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.946 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:26:11.946 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:26:11.947 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:26:11.947 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:26:11.955 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:26:11.958 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.958 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 19:26:11.958 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.959 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:26:11.961 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:26:11.964 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:11.968 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:26:11.975 +04:00 DBG Hosting starting
2025-03-31 19:26:11.999 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 19:26:12.013 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 19:26:12.022 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 19:26:12.030 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 19:26:12.037 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:26:12.037 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 19:26:12.039 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:26:12.041 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 19:26:12.042 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 19:26:12.043 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 19:26:12.044 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 19:26:12.071 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:26:12.087 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 19:26:12.143 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 19:26:12.165 +04:00 DBG Creating DbConnection.
2025-03-31 19:26:12.168 +04:00 DBG Created DbConnection. (3ms).
2025-03-31 19:26:12.171 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:12.175 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:12.176 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:26:12.176 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:26:12.176 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:26:12.177 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:26:12.198 +04:00 INF Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:26:12.209 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:12.210 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-03-31 19:26:12.212 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:12.212 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:26:12.213 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:26:12.213 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:26:12.214 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:26:12.310 +04:00 DBG Loaded hosting startup assembly offers.API
2025-03-31 19:26:12.310 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-03-31 19:26:12.310 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-03-31 19:26:12.310 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-03-31 19:26:12.364 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-03-31 19:26:12.520 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-03-31 19:26:12.540 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-03-31 19:26:12.540 +04:00 INF Hosting environment: Development
2025-03-31 19:26:12.540 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-03-31 19:26:12.540 +04:00 DBG Hosting started
2025-03-31 19:26:12.562 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-03-31 19:26:12.563 +04:00 DBG Request did not match any endpoints
2025-03-31 19:26:12.691 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-03-31 19:26:12.693 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-03-31 19:26:12.761 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-03-31 19:26:12.761 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-03-31 19:26:12.779 +04:00 DBG Connection ID "18230571297501347865" disconnecting.
2025-03-31 19:26:12.782 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-03-31 19:26:12.782 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 428.902ms
2025-03-31 19:26:12.788 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 5.8343ms
2025-03-31 19:26:12.801 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-03-31 19:26:12.891 +04:00 DBG Connection ID "18230571306091282452" disconnecting.
2025-03-31 19:26:12.892 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 91.148ms
2025-03-31 19:26:12.975 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-03-31 19:26:12.978 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-03-31 19:26:12.978 +04:00 DBG Request did not match any endpoints
2025-03-31 19:26:13.021 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 45.6846ms
2025-03-31 19:27:13.901 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-03-31 19:27:13.953 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-03-31 19:27:13.957 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-03-31 19:27:13.958 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:27:13.963 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:27:14.041 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:27:14.043 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:27:14.071 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-03-31 19:27:14.073 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-03-31 19:27:14.073 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-03-31 19:27:14.073 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-03-31 19:27:14.074 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-03-31 19:27:14.074 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-03-31 19:27:14.077 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:27:14.133 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:27:14.134 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:27:14.139 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:27:14.146 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-03-31 19:27:14.149 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-03-31 19:27:14.172 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-03-31 19:27:14.173 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:27:14.173 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:27:14.173 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:27:14.185 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:27:14.187 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:27:14.187 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:27:14.187 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:27:14.188 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:27:14.191 +04:00 INF Login attempt for randomuser@example.com
2025-03-31 19:27:14.199 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-03-31 19:27:14.216 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-03-31 19:27:14.233 +04:00 DBG Creating DbConnection.
2025-03-31 19:27:14.235 +04:00 DBG Created DbConnection. (1ms).
2025-03-31 19:27:14.235 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:27:14.236 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:27:14.236 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:27:14.237 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:27:14.245 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (8ms).
2025-03-31 19:27:14.254 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:27:14.290 +04:00 INF Executed DbCommand (45ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:27:14.339 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:27:14.370 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:27:14.370 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 79ms reading results.
2025-03-31 19:27:14.370 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:27:14.370 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:27:14.600 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 523.4537ms
2025-03-31 19:27:14.602 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:27:14.607 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-03-31 19:27:14.641 +04:00 DBG 1 candidate(s) found for the request path '/...'
2025-03-31 19:27:14.641 +04:00 DBG Request matched endpoint '/...'
2025-03-31 19:27:14.641 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:27:14.642 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:27:14.642 +04:00 INF Executing endpoint '/...'
2025-03-31 19:27:14.670 +04:00 INF Setting HTTP status code 500.
2025-03-31 19:27:14.687 +04:00 INF Writing value of type 'ProblemDetails' as Json.
2025-03-31 19:27:14.693 +04:00 INF Executed endpoint '/...'
2025-03-31 19:27:14.695 +04:00 DBG Connection ID "18158513712053354503" disconnecting.
2025-03-31 19:27:14.695 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:27:14.695 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:27:14.696 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:27:14.697 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null application/problem+json 796.7011ms
2025-03-31 19:31:12.289 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:31:12.296 +04:00 DBG Creating DbConnection.
2025-03-31 19:31:12.296 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:31:12.296 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:31:12.297 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:31:12.297 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:31:12.297 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:31:12.297 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:31:12.297 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:31:12.310 +04:00 INF Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:31:12.310 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:31:12.310 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-03-31 19:31:12.310 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:31:12.310 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:31:12.310 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:31:12.311 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:31:12.311 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:36:12.328 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:36:12.332 +04:00 DBG Creating DbConnection.
2025-03-31 19:36:12.332 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:36:12.333 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:36:12.355 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:36:12.356 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:36:12.356 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:36:12.357 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:36:12.357 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:36:12.365 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:36:12.366 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:36:12.366 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-03-31 19:36:12.366 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:36:12.367 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:36:12.367 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:36:12.367 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:36:12.367 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:42:00.123 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 19:42:00.299 +04:00 INF starting web host
2025-03-31 19:42:00.543 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 19:42:01.647 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:42:01.649 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:42:01.788 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:42:02.011 +04:00 DBG Creating DbConnection.
2025-03-31 19:42:02.075 +04:00 DBG Created DbConnection. (63ms).
2025-03-31 19:42:02.077 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.091 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.541 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.547 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:42:02.555 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (6ms).
2025-03-31 19:42:02.559 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (13ms).
2025-03-31 19:42:02.567 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:42:02.613 +04:00 INF Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:42:02.616 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.637 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (9ms).
2025-03-31 19:42:02.638 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.639 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.642 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 19:42:02.645 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:42:02.645 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:42:02.645 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:42:02.646 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:42:02.686 +04:00 INF Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:42:02.760 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:42:02.765 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:42:02.766 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:42:02.767 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:42:02.768 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 19:42:02.768 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:42:02.775 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:42:02.777 +04:00 DBG Committing transaction.
2025-03-31 19:42:02.780 +04:00 DBG Committed transaction.
2025-03-31 19:42:02.782 +04:00 DBG Disposing transaction.
2025-03-31 19:42:02.783 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:42:02.784 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:42:02.785 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:42:02.785 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:42:02.785 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:42:02.786 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:42:02.787 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:42:02.787 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:42:02.787 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:42:02.787 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:42:02.788 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:42:02.788 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:42:02.790 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:42:02.790 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:42:02.791 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:42:02.791 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:42:02.802 +04:00 INF Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:42:02.805 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.807 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-03-31 19:42:02.819 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 19:42:02.819 +04:00 DBG Committing transaction.
2025-03-31 19:42:02.820 +04:00 DBG Committed transaction.
2025-03-31 19:42:02.820 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:42:02.820 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:42:02.820 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:42:02.820 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:42:02.843 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:42:02.843 +04:00 DBG Disposing transaction.
2025-03-31 19:42:02.844 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:02.845 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 19:42:02.943 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 19:42:03.282 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 19:42:03.357 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:03.358 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:03.358 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:42:03.358 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:42:03.359 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:42:03.359 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:42:03.393 +04:00 INF Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:42:03.397 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:03.397 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 19:42:03.397 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:03.397 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:42:03.400 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:42:03.403 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:03.405 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 19:42:03.415 +04:00 DBG Hosting starting
2025-03-31 19:42:03.505 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 19:42:03.551 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 19:42:03.572 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 19:42:03.595 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 19:42:03.600 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:42:03.601 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 19:42:03.604 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:42:03.606 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 19:42:03.612 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 19:42:03.617 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 19:42:03.620 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 19:42:03.688 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:42:03.736 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 19:42:03.873 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 19:42:03.937 +04:00 DBG Creating DbConnection.
2025-03-31 19:42:03.938 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:42:03.940 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:03.962 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:03.965 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:42:03.966 +04:00 DBG Created DbCommand for 'ExecuteReader' (1ms).
2025-03-31 19:42:03.967 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (2ms).
2025-03-31 19:42:03.968 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:42:04.115 +04:00 INF Executed DbCommand (148ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:42:04.133 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:04.135 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 18ms reading results.
2025-03-31 19:42:04.137 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:04.138 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:42:04.139 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:42:04.140 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:04.140 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:42:04.309 +04:00 DBG Loaded hosting startup assembly offers.API
2025-03-31 19:42:04.309 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-03-31 19:42:04.310 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-03-31 19:42:04.310 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-03-31 19:42:04.497 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-03-31 19:42:05.038 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-03-31 19:42:05.038 +04:00 INF Hosting environment: Development
2025-03-31 19:42:05.038 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-03-31 19:42:05.038 +04:00 DBG Hosting started
2025-03-31 19:42:05.312 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-03-31 19:42:05.370 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-03-31 19:42:05.371 +04:00 DBG Request did not match any endpoints
2025-03-31 19:42:05.521 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-03-31 19:42:05.524 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-03-31 19:42:05.636 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-03-31 19:42:05.637 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-03-31 19:42:05.680 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 1176.8032ms
2025-03-31 19:42:05.924 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-03-31 19:42:05.930 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-03-31 19:42:05.939 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 8.3764ms
2025-03-31 19:42:06.130 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 207.0925ms
2025-03-31 19:42:06.189 +04:00 DBG Connection ID "18374686485577203780" disconnecting.
2025-03-31 19:42:06.234 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-03-31 19:42:06.235 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-03-31 19:42:06.236 +04:00 DBG Request did not match any endpoints
2025-03-31 19:42:06.280 +04:00 DBG Connection ID "18374686485577203782" disconnecting.
2025-03-31 19:42:06.282 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 46.8385ms
2025-03-31 19:42:44.362 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-03-31 19:42:44.395 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-03-31 19:42:44.399 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-03-31 19:42:44.400 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:42:44.403 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:42:44.494 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:42:44.495 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:42:44.527 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-03-31 19:42:44.529 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-03-31 19:42:44.530 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-03-31 19:42:44.530 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-03-31 19:42:44.531 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-03-31 19:42:44.531 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-03-31 19:42:44.533 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:42:44.613 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:42:44.615 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:42:44.622 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:42:44.628 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-03-31 19:42:44.632 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-03-31 19:42:44.657 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-03-31 19:42:44.658 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:42:44.659 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:42:44.659 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:42:44.669 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:42:44.670 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:42:44.671 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:42:44.672 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:42:44.673 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:42:44.679 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-03-31 19:42:44.685 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-03-31 19:42:44.707 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-03-31 19:42:44.718 +04:00 DBG Creating DbConnection.
2025-03-31 19:42:44.718 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:42:44.719 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:44.719 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:44.719 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:42:44.719 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:42:44.725 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-03-31 19:42:44.729 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:42:44.768 +04:00 INF Executed DbCommand (43ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:42:44.874 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:42:44.919 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:44.920 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 151ms reading results.
2025-03-31 19:42:44.920 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:44.920 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:42:45.194 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 660.3399ms
2025-03-31 19:42:45.196 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:42:45.201 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-03-31 19:42:45.251 +04:00 DBG 1 candidate(s) found for the request path '/...'
2025-03-31 19:42:45.252 +04:00 DBG Request matched endpoint '/...'
2025-03-31 19:42:45.252 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:42:45.252 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:42:45.253 +04:00 INF Executing endpoint '/...'
2025-03-31 19:42:45.268 +04:00 INF Setting HTTP status code 500.
2025-03-31 19:42:45.284 +04:00 INF Writing value of type 'ProblemDetails' as Json.
2025-03-31 19:42:45.296 +04:00 INF Executed endpoint '/...'
2025-03-31 19:42:45.297 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:42:45.298 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:42:45.298 +04:00 DBG Connection ID "17870283323016740867" disconnecting.
2025-03-31 19:42:45.298 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:42:45.300 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null application/problem+json 938.575ms
2025-03-31 19:48:36.847 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 19:48:36.999 +04:00 INF starting web host
2025-03-31 19:48:37.268 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 19:48:38.265 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:48:38.274 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:48:38.374 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:48:38.548 +04:00 DBG Creating DbConnection.
2025-03-31 19:48:38.641 +04:00 DBG Created DbConnection. (87ms).
2025-03-31 19:48:38.644 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:38.663 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:39.156 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:39.165 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:48:39.176 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-03-31 19:48:39.179 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-03-31 19:48:39.193 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:48:39.234 +04:00 INF Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:48:39.236 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:39.246 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (5ms).
2025-03-31 19:48:39.246 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:39.247 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:39.248 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 19:48:39.250 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:48:39.251 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:48:39.251 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:48:39.252 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:48:39.279 +04:00 INF Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:48:39.381 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:48:39.392 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:48:39.394 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:48:39.394 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:48:39.395 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 19:48:39.396 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:48:39.400 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:48:39.403 +04:00 DBG Committing transaction.
2025-03-31 19:48:39.410 +04:00 DBG Committed transaction.
2025-03-31 19:48:39.412 +04:00 DBG Disposing transaction.
2025-03-31 19:48:39.416 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:48:39.416 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:48:39.419 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:48:39.419 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:48:39.420 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:48:39.420 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:48:39.421 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:48:39.423 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:48:39.423 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:48:39.423 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:48:39.423 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:48:39.424 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:48:39.427 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:48:39.427 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:48:39.427 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:48:39.428 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:48:39.434 +04:00 INF Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:48:39.438 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:39.439 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-03-31 19:48:39.451 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 19:48:39.451 +04:00 DBG Committing transaction.
2025-03-31 19:48:39.452 +04:00 DBG Committed transaction.
2025-03-31 19:48:39.452 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:48:39.452 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:48:39.452 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:48:39.452 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:48:39.458 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:48:39.458 +04:00 DBG Disposing transaction.
2025-03-31 19:48:39.458 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:39.459 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:48:39.532 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 19:48:39.925 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 19:48:40.018 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.018 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.018 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:48:40.018 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:48:40.018 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:48:40.019 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:48:40.026 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:48:40.029 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.029 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 19:48:40.029 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.030 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:48:40.032 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:48:40.034 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.035 +04:00 DBG Disposed connection to database '' on server '' (1ms).
2025-03-31 19:48:40.041 +04:00 DBG Hosting starting
2025-03-31 19:48:40.070 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 19:48:40.098 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 19:48:40.113 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 19:48:40.134 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 19:48:40.144 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:48:40.145 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 19:48:40.147 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:48:40.149 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 19:48:40.150 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 19:48:40.152 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 19:48:40.154 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 19:48:40.200 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:48:40.259 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 19:48:40.352 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 19:48:40.369 +04:00 DBG Creating DbConnection.
2025-03-31 19:48:40.369 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:48:40.371 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.374 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.374 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:48:40.375 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:48:40.375 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:48:40.375 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:48:40.393 +04:00 INF Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:48:40.404 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.407 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 13ms reading results.
2025-03-31 19:48:40.411 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.412 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:48:40.413 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:48:40.413 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:48:40.413 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:48:40.580 +04:00 DBG Loaded hosting startup assembly offers.API
2025-03-31 19:48:40.580 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-03-31 19:48:40.580 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-03-31 19:48:40.580 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-03-31 19:48:40.666 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-03-31 19:48:40.859 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-03-31 19:48:40.859 +04:00 INF Hosting environment: Development
2025-03-31 19:48:40.859 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-03-31 19:48:40.859 +04:00 DBG Hosting started
2025-03-31 19:48:40.884 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-03-31 19:48:40.919 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-03-31 19:48:40.920 +04:00 DBG Request did not match any endpoints
2025-03-31 19:48:41.033 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-03-31 19:48:41.039 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-03-31 19:48:41.183 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-03-31 19:48:41.184 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-03-31 19:48:41.195 +04:00 DBG Connection ID "18086456113720459293" disconnecting.
2025-03-31 19:48:41.200 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 548.6874ms
2025-03-31 19:48:41.210 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-03-31 19:48:41.258 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 35.4239ms
2025-03-31 19:48:41.258 +04:00 DBG Connection ID "18374686494167138383" disconnecting.
2025-03-31 19:48:41.258 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-03-31 19:48:41.377 +04:00 DBG Connection ID "18158513703463419909" disconnecting.
2025-03-31 19:48:41.381 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 122.9672ms
2025-03-31 19:48:41.497 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-03-31 19:48:41.499 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-03-31 19:48:41.499 +04:00 DBG Request did not match any endpoints
2025-03-31 19:48:41.552 +04:00 DBG Connection ID "17870283323016740869" disconnecting.
2025-03-31 19:48:41.553 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 55.2324ms
2025-03-31 19:49:22.612 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 63
2025-03-31 19:49:22.639 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-03-31 19:49:22.642 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-03-31 19:49:22.643 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:49:22.649 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:49:22.779 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:49:22.782 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:49:22.832 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-03-31 19:49:22.836 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-03-31 19:49:22.836 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-03-31 19:49:22.837 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-03-31 19:49:22.837 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-03-31 19:49:22.837 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-03-31 19:49:22.840 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:49:22.901 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:49:22.905 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:49:22.913 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:49:22.916 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-03-31 19:49:22.921 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-03-31 19:49:22.943 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-03-31 19:49:22.944 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:49:22.945 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:49:22.945 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:49:22.956 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:49:22.957 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:49:22.958 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:49:22.958 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:49:22.959 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:49:22.961 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-03-31 19:49:22.970 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-03-31 19:49:23.002 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-03-31 19:49:23.014 +04:00 DBG Creating DbConnection.
2025-03-31 19:49:23.014 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:49:23.014 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:23.014 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:23.015 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:49:23.015 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:49:23.020 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-03-31 19:49:23.025 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:49:23.064 +04:00 INF Executed DbCommand (44ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:49:23.133 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:49:23.172 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:23.173 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 108ms reading results.
2025-03-31 19:49:23.174 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:23.174 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:49:23.484 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 639.5247ms
2025-03-31 19:49:23.487 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:49:23.493 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-03-31 19:49:23.538 +04:00 DBG 1 candidate(s) found for the request path '/...'
2025-03-31 19:49:23.538 +04:00 DBG Request matched endpoint '/...'
2025-03-31 19:49:23.539 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:49:23.539 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:49:23.540 +04:00 INF Executing endpoint '/...'
2025-03-31 19:49:23.557 +04:00 INF Setting HTTP status code 500.
2025-03-31 19:49:23.565 +04:00 INF Writing value of type 'ProblemDetails' as Json.
2025-03-31 19:49:23.573 +04:00 INF Executed endpoint '/...'
2025-03-31 19:49:23.574 +04:00 DBG Connection ID "18086456109425491971" disconnecting.
2025-03-31 19:49:23.574 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:49:23.574 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:23.575 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:49:23.576 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null application/problem+json 964.8762ms
2025-03-31 19:49:58.328 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 67
2025-03-31 19:49:58.333 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-03-31 19:49:58.333 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-03-31 19:49:58.334 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:49:58.334 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:49:58.339 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:49:58.339 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:49:58.339 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-03-31 19:49:58.339 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-03-31 19:49:58.339 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-03-31 19:49:58.340 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-03-31 19:49:58.340 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-03-31 19:49:58.340 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-03-31 19:49:58.340 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:49:58.342 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:49:58.343 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:49:58.356 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:49:58.356 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-03-31 19:49:58.356 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-03-31 19:49:58.357 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-03-31 19:49:58.357 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:49:58.357 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:49:58.357 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:49:58.358 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:49:58.358 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:49:58.358 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:49:58.358 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:49:58.358 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:49:58.359 +04:00 INF Login attempt for randomuser@example.com
2025-03-31 19:49:58.362 +04:00 DBG Creating DbConnection.
2025-03-31 19:49:58.363 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:49:58.363 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:58.364 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:58.364 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:49:58.365 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:49:58.365 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (1ms).
2025-03-31 19:49:58.366 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:49:58.375 +04:00 INF Executed DbCommand (9ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:49:58.376 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:49:58.376 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:58.377 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-03-31 19:49:58.377 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:58.377 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:49:58.437 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 97.3497ms
2025-03-31 19:49:58.438 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:49:58.439 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-03-31 19:49:58.443 +04:00 DBG 1 candidate(s) found for the request path '/...'
2025-03-31 19:49:58.443 +04:00 DBG Request matched endpoint '/...'
2025-03-31 19:49:58.443 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:49:58.443 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:49:58.443 +04:00 INF Executing endpoint '/...'
2025-03-31 19:49:58.443 +04:00 INF Setting HTTP status code 500.
2025-03-31 19:49:58.445 +04:00 INF Writing value of type 'ProblemDetails' as Json.
2025-03-31 19:49:58.448 +04:00 INF Executed endpoint '/...'
2025-03-31 19:49:58.448 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:49:58.449 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:49:58.449 +04:00 DBG Connection ID "17942340925644603414" disconnecting.
2025-03-31 19:49:58.449 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:49:58.449 +04:00 INF Request finished HTTP/2 POST https://localhost:44346/api/Auth/login - 500 null application/problem+json 121.2177ms
2025-03-31 19:53:40.410 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:53:40.416 +04:00 DBG Creating DbConnection.
2025-03-31 19:53:40.416 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:53:40.416 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:53:40.416 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:53:40.416 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:53:40.416 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:53:40.416 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:53:40.416 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:53:40.423 +04:00 INF Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:53:40.423 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:53:40.423 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-03-31 19:53:40.424 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:53:40.424 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:53:40.424 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:53:40.424 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:53:40.424 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:56:23.899 +04:00 DBG Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-03-31 19:56:24.019 +04:00 INF starting web host
2025-03-31 19:56:24.281 +04:00 DBG An 'IServiceProvider' was created for internal use by Entity Framework.
2025-03-31 19:56:25.693 +04:00 WRN No store type was specified for the decimal property 'Price' on entity type 'Offer'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:56:25.696 +04:00 WRN No store type was specified for the decimal property 'Balance' on entity type 'UserDetail'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-31 19:56:25.772 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:56:25.931 +04:00 DBG Creating DbConnection.
2025-03-31 19:56:25.975 +04:00 DBG Created DbConnection. (41ms).
2025-03-31 19:56:25.980 +04:00 DBG Migrating using database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:25.992 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.302 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.306 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:56:26.316 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-03-31 19:56:26.317 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (11ms).
2025-03-31 19:56:26.323 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:56:26.348 +04:00 INF Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:56:26.350 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.358 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (4ms).
2025-03-31 19:56:26.358 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.359 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.362 +04:00 INF Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-31 19:56:26.365 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:56:26.365 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:56:26.365 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:56:26.365 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:56:26.385 +04:00 INF Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-31 19:56:26.458 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:56:26.466 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:56:26.467 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:56:26.468 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:56:26.469 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-03-31 19:56:26.469 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:56:26.472 +04:00 INF Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-31 19:56:26.474 +04:00 DBG Committing transaction.
2025-03-31 19:56:26.479 +04:00 DBG Committed transaction.
2025-03-31 19:56:26.481 +04:00 DBG Disposing transaction.
2025-03-31 19:56:26.483 +04:00 DBG Beginning transaction with isolation level 'Unspecified'.
2025-03-31 19:56:26.484 +04:00 DBG Began transaction with isolation level 'ReadCommitted'.
2025-03-31 19:56:26.485 +04:00 DBG Creating DbCommand for 'ExecuteNonQuery'.
2025-03-31 19:56:26.485 +04:00 DBG Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:56:26.485 +04:00 DBG Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-03-31 19:56:26.485 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:56:26.486 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-31 19:56:26.487 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:56:26.487 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:56:26.487 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:56:26.487 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:56:26.488 +04:00 INF Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-31 19:56:26.489 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:56:26.490 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:56:26.490 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:56:26.490 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:56:26.496 +04:00 INF Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-31 19:56:26.499 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.501 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-03-31 19:56:26.507 +04:00 INF No migrations were applied. The database is already up to date.
2025-03-31 19:56:26.507 +04:00 DBG Committing transaction.
2025-03-31 19:56:26.508 +04:00 DBG Committed transaction.
2025-03-31 19:56:26.508 +04:00 DBG Creating DbCommand for 'ExecuteScalar'.
2025-03-31 19:56:26.508 +04:00 DBG Created DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:56:26.509 +04:00 DBG Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-03-31 19:56:26.509 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:56:26.517 +04:00 INF Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-31 19:56:26.517 +04:00 DBG Disposing transaction.
2025-03-31 19:56:26.517 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.518 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:56:26.603 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .Any(x => (int)x.Role == 2)'
2025-03-31 19:56:26.883 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<bool>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin')) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM Accounts AS a
            WHERE a.Role == 'Admin'), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        bool? value1;
        value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
        return (bool)value1;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)
    .Single()'
2025-03-31 19:56:26.923 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.923 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.923 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:56:26.923 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:56:26.923 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:56:26.924 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:56:26.928 +04:00 INF Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Accounts] AS [a]
        WHERE [a].[Role] = 'Admin') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-31 19:56:26.933 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.934 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-03-31 19:56:26.935 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.936 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:56:26.939 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:56:26.942 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:26.947 +04:00 DBG Disposed connection to database '' on server '' (2ms).
2025-03-31 19:56:26.954 +04:00 DBG Hosting starting
2025-03-31 19:56:26.976 +04:00 INF User profile is available. Using 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-31 19:56:26.991 +04:00 DBG Reading data from file 'C:\Users\misho\AppData\Local\ASP.NET\DataProtection-Keys\key-557b37cc-37f6-47ec-b065-df0e1794c732.xml'.
2025-03-31 19:56:27.001 +04:00 DBG Found key {557b37cc-37f6-47ec-b065-df0e1794c732}.
2025-03-31 19:56:27.013 +04:00 DBG Considering key {557b37cc-37f6-47ec-b065-df0e1794c732} with expiration date 2025-06-29 10:17:47Z as default key.
2025-03-31 19:56:27.016 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:56:27.017 +04:00 DBG Decrypting secret element using Windows DPAPI.
2025-03-31 19:56:27.019 +04:00 DBG Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-03-31 19:56:27.021 +04:00 DBG Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-03-31 19:56:27.022 +04:00 DBG Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-03-31 19:56:27.024 +04:00 DBG Using key {557b37cc-37f6-47ec-b065-df0e1794c732} as the default key.
2025-03-31 19:56:27.025 +04:00 DBG Key ring with default key {557b37cc-37f6-47ec-b065-df0e1794c732} was loaded during application startup.
2025-03-31 19:56:27.049 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:56:27.065 +04:00 DBG Compiling query expression: 
'DbSet<Offer>()
    .Where(off => off.ArchiveAt <= DateTime.Now)'
2025-03-31 19:56:27.132 +04:00 DBG Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Offer>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Offer.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Offer.AccountId (int) Required FK Index, 1], [Property: Offer.ArchiveAt (DateTime) Required, 2], [Property: Offer.CategoryId (int) Required FK Index, 3], [Property: Offer.Count (int) Required, 4], [Property: Offer.CreatedAt (DateTime) Required, 5], [Property: Offer.Description (string) Required MaxLength(1000) ANSI, 6], [Property: Offer.IsArchived (bool) Required, 7], [Property: Offer.Name (string) Required MaxLength(255) ANSI, 8], [Property: Offer.Price (decimal) Required, 9] }
        SELECT o.Id, o.AccountId, o.ArchiveAt, o.CategoryId, o.Count, o.CreatedAt, o.Description, o.IsArchived, o.Name, o.Price
        FROM Offers AS o
        WHERE o.ArchiveAt <= GETDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Offer entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Offer instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Offer);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Offer.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Offer)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]: 
                        {
                            return 
                            {
                                Offer instance;
                                instance = new Offer();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AccountId>k__BackingField = dataReader.GetInt32(1);
                                instance.<ArchiveAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(3);
                                instance.<Count>k__BackingField = dataReader.GetInt32(4);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(5);
                                instance.<Description>k__BackingField = dataReader.GetString(6);
                                instance.<IsArchived>k__BackingField = dataReader.GetBoolean(7);
                                instance.<Name>k__BackingField = dataReader.GetString(8);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(9);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Offer | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Offer")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Offer)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: offers.Persistance.Context.ApplicationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-03-31 19:56:27.154 +04:00 DBG Creating DbConnection.
2025-03-31 19:56:27.154 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:56:27.157 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:27.161 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:27.162 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:56:27.162 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:56:27.162 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:56:27.163 +04:00 DBG Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:56:27.189 +04:00 INF Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[AccountId], [o].[ArchiveAt], [o].[CategoryId], [o].[Count], [o].[CreatedAt], [o].[Description], [o].[IsArchived], [o].[Name], [o].[Price]
FROM [Offers] AS [o]
WHERE [o].[ArchiveAt] <= GETDATE()
2025-03-31 19:56:27.205 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:27.206 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-03-31 19:56:27.209 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:27.210 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (1ms).
2025-03-31 19:56:27.213 +04:00 DBG 'ApplicationDbContext' disposed.
2025-03-31 19:56:27.214 +04:00 DBG Disposing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:56:27.214 +04:00 DBG Disposed connection to database '' on server '' (0ms).
2025-03-31 19:56:27.314 +04:00 DBG Loaded hosting startup assembly offers.API
2025-03-31 19:56:27.314 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-03-31 19:56:27.314 +04:00 DBG Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-03-31 19:56:27.314 +04:00 DBG Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-03-31 19:56:27.379 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/index.html - null null
2025-03-31 19:56:27.536 +04:00 DBG Wildcard detected, all requests with hosts will be allowed.
2025-03-31 19:56:27.548 +04:00 INF Application started. Press Ctrl+C to shut down.
2025-03-31 19:56:27.549 +04:00 INF Hosting environment: Development
2025-03-31 19:56:27.549 +04:00 INF Content root path: C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API
2025-03-31 19:56:27.549 +04:00 DBG Hosting started
2025-03-31 19:56:27.569 +04:00 DBG No candidates found for the request path '/swagger/index.html'
2025-03-31 19:56:27.570 +04:00 DBG Request did not match any endpoints
2025-03-31 19:56:27.675 +04:00 DBG Response markup is scheduled to include Browser Link script injection.
2025-03-31 19:56:27.680 +04:00 DBG Response markup is scheduled to include browser refresh script injection.
2025-03-31 19:56:27.753 +04:00 DBG Response markup was updated to include Browser Link script injection.
2025-03-31 19:56:27.754 +04:00 DBG Response markup was updated to include browser refresh script injection.
2025-03-31 19:56:27.783 +04:00 DBG Connection ID "17798225737568747531" disconnecting.
2025-03-31 19:56:27.786 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/index.html - 200 null text/html;charset=utf-8 426.4287ms
2025-03-31 19:56:27.825 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_vs/browserLink - null null
2025-03-31 19:56:27.830 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - null null
2025-03-31 19:56:27.840 +04:00 DBG Connection ID "18374686494167138385" disconnecting.
2025-03-31 19:56:27.840 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_framework/aspnetcore-browser-refresh.js - 200 13772 application/javascript; charset=utf-8 6.2919ms
2025-03-31 19:56:27.941 +04:00 DBG Connection ID "17798225728978812931" disconnecting.
2025-03-31 19:56:27.944 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.3927ms
2025-03-31 19:56:28.024 +04:00 INF Request starting HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - null null
2025-03-31 19:56:28.026 +04:00 DBG No candidates found for the request path '/swagger/v1/swagger.json'
2025-03-31 19:56:28.027 +04:00 DBG Request did not match any endpoints
2025-03-31 19:56:28.066 +04:00 INF Request finished HTTP/2 GET https://localhost:44346/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 41.2915ms
2025-03-31 19:56:58.673 +04:00 INF Request starting HTTP/2 POST https://localhost:44346/api/Auth/login - application/json 70
2025-03-31 19:56:58.704 +04:00 DBG 1 candidate(s) found for the request path '/api/Auth/login'
2025-03-31 19:56:58.716 +04:00 DBG Endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-03-31 19:56:58.717 +04:00 DBG Request matched endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:56:58.719 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:56:58.793 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:56:58.795 +04:00 INF Executing endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:56:58.819 +04:00 INF Route matched with {action = "LogIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LogIn(offers.API.Models.AccountLoginDTO, System.Threading.CancellationToken) on controller offers.API.Controllers.AuthController (offers.API).
2025-03-31 19:56:58.821 +04:00 DBG Execution plan of authorization filters (in the following order): ["None"]
2025-03-31 19:56:58.822 +04:00 DBG Execution plan of resource filters (in the following order): ["None"]
2025-03-31 19:56:58.822 +04:00 DBG Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-03-31 19:56:58.822 +04:00 DBG Execution plan of exception filters (in the following order): ["None"]
2025-03-31 19:56:58.823 +04:00 DBG Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-03-31 19:56:58.827 +04:00 DBG Executing controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:56:58.886 +04:00 DBG Entity Framework Core 9.0.3 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.3' with options: EngineType=SqlServer 
2025-03-31 19:56:58.887 +04:00 DBG Executed controller factory for controller offers.API.Controllers.AuthController (offers.API)
2025-03-31 19:56:58.897 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:56:58.902 +04:00 DBG Attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' using the name '' in request data ...
2025-03-31 19:56:58.910 +04:00 DBG Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-03-31 19:56:58.938 +04:00 DBG JSON input formatter succeeded, deserializing to type 'offers.API.Models.AccountLoginDTO'
2025-03-31 19:56:58.939 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:56:58.939 +04:00 DBG Done attempting to bind parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:56:58.939 +04:00 DBG Attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO' ...
2025-03-31 19:56:58.949 +04:00 DBG Done attempting to validate the bound parameter 'accountLoginDTO' of type 'offers.API.Models.AccountLoginDTO'.
2025-03-31 19:56:58.950 +04:00 DBG Attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:56:58.951 +04:00 DBG Done attempting to bind parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:56:58.951 +04:00 DBG Attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken' ...
2025-03-31 19:56:58.952 +04:00 DBG Done attempting to validate the bound parameter 'cancellation' of type 'System.Threading.CancellationToken'.
2025-03-31 19:57:09.850 +04:00 INF Login attempt for kirvalidzedachi@gmail.com
2025-03-31 19:58:56.404 +04:00 DBG Compiling query expression: 
'DbSet<Account>()
    .SingleOrDefault(acc => acc.Email == __Email_0)'
2025-03-31 19:58:56.427 +04:00 DBG Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Account>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Account>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Email (string) Required MaxLength(255) ANSI, 1], [Property: Account.PasswordHash (string) Required MaxLength(512) ANSI, 2], [Property: Account.Phone (string) Required MaxLength(50) ANSI, 3], [Property: Account.Role (AccountRole) Required MaxLength(50) ANSI, 4] }
            SELECT TOP(2) a.Id, a.Email, a.PasswordHash, a.Phone, a.Role
            FROM Accounts AS a
            WHERE a.Email == @__Email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Account entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Account instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Account);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Account.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Account)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]: 
                            {
                                return 
                                {
                                    Account instance;
                                    instance = new Account();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Email>k__BackingField = dataReader.GetString(1);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(2);
                                    instance.<Phone>k__BackingField = dataReader.GetString(3);
                                    instance.<Role>k__BackingField = Invoke(((EnumToStringConverter<AccountRole>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Account.Role (AccountRole) Required MaxLength(50) ANSI | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account").FindProperty("Role")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetString(4));
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Account | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("offers.Domain.Models.Account")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Account)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: offers.Persistance.Context.ApplicationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-03-31 19:58:56.442 +04:00 DBG Creating DbConnection.
2025-03-31 19:58:56.443 +04:00 DBG Created DbConnection. (0ms).
2025-03-31 19:58:56.443 +04:00 DBG Opening connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:58:56.444 +04:00 DBG Opened connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:58:56.444 +04:00 DBG Creating DbCommand for 'ExecuteReader'.
2025-03-31 19:58:56.444 +04:00 DBG Created DbCommand for 'ExecuteReader' (0ms).
2025-03-31 19:58:56.450 +04:00 DBG Initialized DbCommand for 'ExecuteReader' (5ms).
2025-03-31 19:58:56.452 +04:00 DBG Executing DbCommand [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:58:56.508 +04:00 INF Executed DbCommand (57ms) [Parameters=[@__Email_0='?' (Size = 255) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[Email], [a].[PasswordHash], [a].[Phone], [a].[Role]
FROM [Accounts] AS [a]
WHERE [a].[Email] = @__Email_0
2025-03-31 19:58:56.554 +04:00 DBG Context 'ApplicationDbContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-03-31 19:58:56.576 +04:00 DBG Closing data reader to 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:58:56.577 +04:00 DBG A data reader for 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' is being disposed after spending 65ms reading results.
2025-03-31 19:58:56.577 +04:00 DBG Closing connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS'.
2025-03-31 19:58:56.577 +04:00 DBG Closed connection to database 'OffersDb' on server 'DESKTOP-T9J7KFM\SQLEXPRESS' (0ms).
2025-03-31 19:59:21.264 +04:00 INF Executed action offers.API.Controllers.AuthController.LogIn (offers.API) in 142434.9347ms
2025-03-31 19:59:21.266 +04:00 INF Executed endpoint 'offers.API.Controllers.AuthController.LogIn (offers.API)'
2025-03-31 19:59:21.270 +04:00 ERR An unhandled exception has occurred while executing the request.System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '152' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateJwtSecurityTokenPrivate(String issuer, String audience, ClaimsIdentity subject, Nullable`1 notBefore, Nullable`1 expires, Nullable`1 issuedAt, SigningCredentials signingCredentials, EncryptingCredentials encryptingCredentials, IDictionary`2 claimCollection, String tokenType, IDictionary`2 additionalHeaderClaims, IDictionary`2 additionalInnerHeaderClaims)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.CreateToken(SecurityTokenDescriptor tokenDescriptor)
   at offers.API.Infrastructure.Auth.JWT.JWTHelper.GenerateSecurityToken(String Email, Int32 Id, AccountRole Role, IOptions`1 options) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Infrastructure\Auth\JWT\JWTHelper.cs:line 34
   at offers.API.Controllers.AuthController.LogIn(AccountLoginDTO accountLoginDTO, CancellationToken cancellation) in C:\Users\misho\Desktop\Project\offers.itacademy.ge\offers.API\Controllers\AuthController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)

2025-03-31 19:59:21.303 +04:00 DBG 1 candidate(s) found for the request path '/...'
2025-03-31 19:59:21.303 +04:00 DBG Request matched endpoint '/...'
2025-03-31 19:59:21.304 +04:00 DBG Static files was skipped as the request already matched an endpoint.
2025-03-31 19:59:21.305 +04:00 DBG AuthenticationScheme: Bearer was not authenticated.
2025-03-31 19:59:21.305 +04:00 INF Executing endpoint '/...'
2025-03-31 19:59:30.030 +04:00 INF Setting HTTP status code 500.
2025-03-31 19:59:30.041 +04:00 INF Writing value of type 'ProblemDetails' as Json.
2025-03-31 19:59:30.048 +04:00 INF Executed endpoint '/...'
2025-03-31 19:59:30.050 +04:00 DBG Connection ID "17870283331606675465" disconnecting.
